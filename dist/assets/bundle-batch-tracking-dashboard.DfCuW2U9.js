const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.B3OoR7j1.js","assets/query-vendor.DpsghfSz.js","assets/react-vendor.CfKEcsXX.js","assets/ui-vendor.D5U9TC-3.js","assets/firebase-vendor.D8xw0AXf.js","assets/utils-vendor.B0NEtgzl.js","assets/index.CZ3Rcx0c.css"])))=>i.map(i=>d[i]);
import{_ as V,B as q,C as c,m as X,F as Q,i as L,p as Y,a as Z,n as ee}from"./index.B3OoR7j1.js";import{j as e}from"./query-vendor.DpsghfSz.js";import{r as m}from"./react-vendor.CfKEcsXX.js";import{L as te}from"./LoadingSpinner.rP8tyFue.js";import{F as se}from"./DocumentChartBarIcon.DSPE-w7K.js";import{F as W}from"./ChartBarIcon.CTULyxD7.js";import{F as ae}from"./CalendarIcon.sECmwVM6.js";import{F as _}from"./ArrowTrendingUpIcon.DCVA9ozU.js";import{F as H}from"./LightBulbIcon.CK1_Ki40.js";import{F as re}from"./ClockIcon.B0z2Gpg3.js";import{F as U}from"./CurrencyDollarIcon.n5hpspjn.js";import{F as ie}from"./ShieldCheckIcon.7Wn9Ltzi.js";import"./ui-vendor.D5U9TC-3.js";import"./firebase-vendor.D8xw0AXf.js";import"./utils-vendor.B0NEtgzl.js";function ne({title:d,titleId:u,...p},w){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:w,"aria-labelledby":u},p),d?m.createElement("title",{id:u},d):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const le=m.forwardRef(ne),G=d=>{const u=[{number:"3233",style:"Adult T-shirt",sizes:["XS","S","M","L","XL"]},{number:"3265",style:"Ladies Blouse",sizes:["XS","S","M","L","XL"]},{number:"3401",style:"Kids T-shirt",sizes:["2T","3T","4T","5T"]},{number:"3502",style:"Polo Shirt",sizes:["S","M","L","XL","XXL"]},{number:"3678",style:"Tank Top",sizes:["XS","S","M","L"]}],p=["created","cutting","sewing","quality","finished","shipped"],w=["low","normal","high","urgent"],k=[];for(let h=1;h<=d;h++){const b=u[Math.floor(Math.random()*u.length)],I=b.sizes[Math.floor(Math.random()*b.sizes.length)],x=Math.floor(h/50)+1,S=Math.floor(h/500)+1,r=p[Math.floor(Math.random()*p.length)],y=w[Math.floor(Math.random()*w.length)],N=new Date(Date.now()-Math.random()*7*24*60*60*1e3),j=4+Math.random()*8,l=r!=="created"?j*(.8+Math.random()*.6):void 0,v=l?Math.min(100,j/l*100):85+Math.random()*15;k.push({id:`bundle_${h}`,bundleNumber:`BND-${b.number}-${I}-${String(h).padStart(4,"0")}`,batchId:`batch_${x}`,batchNumber:`BATCH-${String(x).padStart(3,"0")}`,lotId:`lot_${S}`,lotNumber:`LOT-${String(S).padStart(2,"0")}`,articleNumber:b.number,articleStyle:b.style,size:I,quantity:1,createdAt:N,startedAt:r!=="created"?new Date(N.getTime()+Math.random()*2*60*60*1e3):void 0,completedAt:r==="finished"||r==="shipped"?new Date(N.getTime()+l*60*60*1e3):void 0,status:r,currentOperation:r==="sewing"?["Shoulder Join","Side Seam","Sleeve Attach"][Math.floor(Math.random()*3)]:void 0,plannedDuration:j,actualDuration:l,efficiency:v,defectRate:Math.random()*5,reworkCount:Math.floor(Math.random()*3),assignedOperators:[`op_${Math.floor(Math.random()*8)+1}`],supervisorId:`supervisor_${Math.floor(Math.random()*3)+1}`,priority:y,totalCost:50+Math.random()*100,totalEarnings:80+Math.random()*150,materialCost:30+Math.random()*50,qualityScore:6+Math.random()*4,qualityIssues:Math.random()>.8?["Minor stitch issue"]:[],milestones:[{stage:"cutting",completedAt:new Date(N.getTime()+7200*1e3),plannedAt:new Date(N.getTime()+1.5*60*60*1e3),variance:.5}]})}return k},we=()=>{const[d,u]=m.useState([]),[p,w]=m.useState([]),[k,h]=m.useState(!0),[b,I]=m.useState("week"),[x,S]=m.useState("overview"),[r,y]=m.useState({status:"all",priority:"all",article:"all",batch:"all",lot:"all"});m.useEffect(()=>{N()},[]);const N=async()=>{h(!0);try{const{collection:t,getDocs:i,query:A,orderBy:C,limit:R}=await V(async()=>{const{collection:o,getDocs:g,query:s,orderBy:T,limit:F}=await import("./firebase-vendor.D8xw0AXf.js").then(a=>a.al);return{collection:o,getDocs:g,query:s,orderBy:T,limit:F}},[]),{db:$}=await V(async()=>{const{db:o}=await import("./index.B3OoR7j1.js").then(g=>g.O);return{db:o}},__vite__mapDeps([0,1,2,3,4,5,6])),M=t($,"production_bundles"),B=A(M,C("createdAt","desc"),R(500)),D=await i(B);if(D.empty){console.log("No bundle data found, creating sample data...");const o=G(100);u(o),j(o)}else{const o=D.docs.map(g=>{const s=g.data();return{id:g.id,bundleNumber:s.bundleNumber||`BND-${g.id.slice(-8)}`,batchId:s.batchId||`batch_${Math.floor(Math.random()*50)+1}`,batchNumber:s.batchNumber||`BATCH-${String(Math.floor(Math.random()*50)+1).padStart(3,"0")}`,lotId:s.lotId||`lot_${Math.floor(Math.random()*10)+1}`,lotNumber:s.lotNumber||`LOT-${String(Math.floor(Math.random()*10)+1).padStart(2,"0")}`,articleNumber:s.articleNumber||"3233",articleStyle:s.articleStyle||"Adult T-shirt",size:s.size||"M",quantity:s.quantity||s.targetPieces||25,createdAt:s.createdAt?.toDate()||new Date,startedAt:s.startedAt?.toDate(),completedAt:s.completedAt?.toDate(),status:s.status||"created",currentOperation:s.currentOperation,plannedDuration:s.plannedDuration||8,actualDuration:s.actualDuration,efficiency:s.efficiency||Math.floor(Math.random()*20)+80,defectRate:s.defectRate||Math.random()*3,reworkCount:s.reworkCount||0,assignedOperators:s.assignedOperators||[],supervisorId:s.supervisorId||"supervisor_1",priority:s.priority||"normal",totalCost:s.totalCost||Math.floor(Math.random()*100)+50,totalEarnings:s.totalEarnings||Math.floor(Math.random()*150)+80,materialCost:s.materialCost||Math.floor(Math.random()*50)+30,qualityScore:s.qualityScore||Math.floor(Math.random()*4)+6,qualityIssues:s.qualityIssues||[],milestones:s.milestones||[]}});u(o),j(o)}h(!1)}catch(t){console.error("Error loading bundle data:",t);const i=G(100);u(i),j(i),h(!1)}},j=t=>{const i=[],A=t.reduce((a,n)=>a+n.efficiency,0)/t.length;A<80&&i.push({id:"efficiency_low",type:"efficiency",severity:"warning",title:"Below Target Efficiency",description:`Average efficiency is ${A.toFixed(1)}%, below the 85% target`,impact:"Reduced productivity and increased costs",recommendation:"Review operator training and workload distribution",data:{avgEfficiency:A,target:85},priority:8});const C=t.filter(a=>a.status==="sewing").length,R=t.filter(a=>a.status==="quality").length;C>R*3&&i.push({id:"bottleneck_quality",type:"bottleneck",severity:"critical",title:"Quality Check Bottleneck",description:`${C} bundles waiting for quality vs ${R} in quality`,impact:"Delayed shipments and increased WIP",recommendation:"Add more quality inspectors or streamline QC process",data:{sewingQueue:C,qualityQueue:R},priority:9});const $=t.reduce((a,n)=>a+n.defectRate,0)/t.length;$>3&&i.push({id:"quality_issues",type:"quality",severity:"warning",title:"High Defect Rate",description:`Average defect rate is ${$.toFixed(1)}%, above 3% threshold`,impact:"Increased rework costs and customer complaints",recommendation:"Implement additional quality training and process improvements",data:{defectRate:$,threshold:3},priority:7});const M=t.filter(a=>a.createdAt>new Date(Date.now()-720*60*60*1e3)),B=M.reduce((a,n)=>a+n.totalCost,0)/M.length,D=M.reduce((a,n)=>a+n.totalEarnings,0)/M.length,o=(D-B)/D*100;o<30&&i.push({id:"profit_margin",type:"cost",severity:"warning",title:"Low Profit Margin",description:`Profit margin is ${o.toFixed(1)}%, below 30% target`,impact:"Reduced profitability and business sustainability",recommendation:"Review pricing strategy and cost optimization",data:{margin:o,target:30},priority:6});const g=t.reduce((a,n)=>(n.assignedOperators.forEach(f=>{a[f]||(a[f]={bundles:0,totalEfficiency:0,defects:0}),a[f].bundles+=1,a[f].totalEfficiency+=n.efficiency,a[f].defects+=n.defectRate}),a),{}),s=Object.entries(g).filter(([a,n])=>n.totalEfficiency/n.bundles<75).length;s>0&&i.push({id:"operator_performance",type:"operator",severity:"warning",title:"Underperforming Operators",description:`${s} operators performing below 75% efficiency`,impact:"Reduced overall productivity",recommendation:"Provide additional training and performance coaching",data:{underperforming:s},priority:5});const T=t.filter(a=>a.createdAt>new Date(Date.now()-10080*60*1e3)),F=t.filter(a=>a.createdAt<=new Date(Date.now()-10080*60*1e3)&&a.createdAt>new Date(Date.now()-336*60*60*1e3));if(T.length>0&&F.length>0){const a=T.reduce((f,E)=>f+E.efficiency,0)/T.length,n=F.reduce((f,E)=>f+E.efficiency,0)/F.length;a<n-5&&i.push({id:"efficiency_declining",type:"trend",severity:"warning",title:"Declining Efficiency Trend",description:`Efficiency dropped from ${n.toFixed(1)}% to ${a.toFixed(1)}%`,impact:"Worsening productivity trends",recommendation:"Investigate causes and implement corrective actions",data:{recent:a,previous:n},priority:7})}w(i.sort((a,n)=>n.priority-a.priority))},l=d.filter(t=>(r.status==="all"||t.status===r.status)&&(r.priority==="all"||t.priority===r.priority)&&(r.article==="all"||t.articleNumber===r.article)&&(r.batch==="all"||t.batchNumber===r.batch)&&(r.lot==="all"||t.lotNumber===r.lot)),v={total:l.length,completed:l.filter(t=>t.status==="finished"||t.status==="shipped").length,inProgress:l.filter(t=>["cutting","sewing","quality"].includes(t.status)).length,delayed:l.filter(t=>t.actualDuration&&t.actualDuration>t.plannedDuration*1.1).length,avgEfficiency:l.length>0?l.reduce((t,i)=>t+i.efficiency,0)/l.length:0,avgDefectRate:l.length>0?l.reduce((t,i)=>t+i.defectRate,0)/l.length:0,totalValue:l.reduce((t,i)=>t+i.totalEarnings,0),totalCost:l.reduce((t,i)=>t+i.totalCost,0)},J=[...new Set(d.map(t=>t.articleNumber))],O=[...new Set(d.map(t=>t.batchNumber))],P=[...new Set(d.map(t=>t.lotNumber))],z=t=>{switch(t){case"critical":return"bg-red-100 text-red-800 border-red-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"info":return"bg-blue-100 text-blue-800 border-blue-200"}},K=t=>{switch(t){case"efficiency":return _;case"quality":return ie;case"bottleneck":return L;case"cost":return U;case"operator":return ee;case"trend":return W;default:return H}};return k?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx(te,{size:"lg"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading bundle tracking data..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(se,{className:"h-8 w-8 text-blue-600"}),e.jsx("span",{children:"Bundle & Batch Tracking Analytics"})]}),e.jsxs("p",{className:"text-gray-600",children:["Track and analyze production performance across ",d.length," bundles"]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("select",{value:b,onChange:t=>I(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"}),e.jsx("option",{value:"quarter",children:"This Quarter"})]}),e.jsxs(q,{onClick:()=>j(d),variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(le,{className:"h-4 w-4"}),e.jsx("span",{children:"Refresh"})]})]})]}),e.jsx(c,{className:"p-1",children:e.jsx("div",{className:"flex space-x-1",children:[{id:"overview",label:"Overview",icon:W},{id:"batches",label:"Batch Tracking",icon:X},{id:"lots",label:"Lot Management",icon:ae},{id:"analytics",label:"Performance Analytics",icon:_},{id:"insights",label:"AI Insights",icon:H}].map(t=>{const i=t.icon;return e.jsxs(q,{onClick:()=>S(t.id),variant:x===t.id?"primary":"ghost",className:"flex items-center space-x-2",children:[e.jsx(i,{className:"h-4 w-4"}),e.jsx("span",{children:t.label})]},t.id)})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(X,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Bundles"}),e.jsx("p",{className:"text-xl font-bold text-blue-600",children:v.total.toLocaleString()})]})]})}),e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Q,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:v.completed})]})]})}),e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(re,{className:"h-5 w-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"In Progress"}),e.jsx("p",{className:"text-xl font-bold text-yellow-600",children:v.inProgress})]})]})}),e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(L,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Delayed"}),e.jsx("p",{className:"text-xl font-bold text-red-600",children:v.delayed})]})]})}),e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(_,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Avg Efficiency"}),e.jsxs("p",{className:"text-xl font-bold text-purple-600",children:[v.avgEfficiency.toFixed(1),"%"]})]})]})}),e.jsx(c,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:e.jsx(U,{className:"h-5 w-5 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Value"}),e.jsxs("p",{className:"text-xl font-bold text-indigo-600",children:["Rs. ",v.totalValue.toFixed(0)]})]})]})})]}),p.filter(t=>t.severity==="critical").length>0&&e.jsx(c,{className:"p-4 border-red-200 bg-red-50",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(L,{className:"h-6 w-6 text-red-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900",children:"Critical Issues Detected"}),e.jsxs("p",{className:"text-red-700",children:[p.filter(t=>t.severity==="critical").length," critical issues require immediate attention"]})]}),e.jsx(q,{onClick:()=>S("insights"),className:"bg-red-600 hover:bg-red-700 ml-auto",children:"View Insights"})]})}),e.jsxs(c,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filters"}),e.jsx(q,{variant:"outline",size:"sm",onClick:()=>y({status:"all",priority:"all",article:"all",batch:"all",lot:"all"}),children:"Clear All"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("select",{value:r.status,onChange:t=>y({...r,status:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"created",children:"Created"}),e.jsx("option",{value:"cutting",children:"Cutting"}),e.jsx("option",{value:"sewing",children:"Sewing"}),e.jsx("option",{value:"quality",children:"Quality Check"}),e.jsx("option",{value:"finished",children:"Finished"}),e.jsx("option",{value:"shipped",children:"Shipped"})]}),e.jsxs("select",{value:r.priority,onChange:t=>y({...r,priority:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Priorities"}),e.jsx("option",{value:"urgent",children:"🔥 Urgent"}),e.jsx("option",{value:"high",children:"⚠️ High"}),e.jsx("option",{value:"normal",children:"📋 Normal"}),e.jsx("option",{value:"low",children:"⏳ Low"})]}),e.jsxs("select",{value:r.article,onChange:t=>y({...r,article:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Articles"}),J.map(t=>e.jsxs("option",{value:t,children:["Article ",t]},t))]}),e.jsxs("select",{value:r.batch,onChange:t=>y({...r,batch:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500",children:[e.jsxs("option",{value:"all",children:["All Batches (",O.length,")"]}),O.slice(0,20).map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:r.lot,onChange:t=>y({...r,lot:t.target.value}),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500",children:[e.jsxs("option",{value:"all",children:["All Lots (",P.length,")"]}),P.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),x==="insights"&&e.jsx("div",{className:"space-y-4",children:e.jsxs(c,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center space-x-2",children:[e.jsx(Y,{className:"h-5 w-5 text-yellow-500"}),e.jsx("span",{children:"AI-Generated Insights & Recommendations"})]}),p.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Q,{className:"h-12 w-12 text-green-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"All Systems Operating Well"}),e.jsx("p",{className:"text-gray-500",children:"No critical issues detected in current data analysis"})]}):e.jsx("div",{className:"space-y-4",children:p.map(t=>{const i=K(t.type);return e.jsx(c,{className:`p-4 border ${z(t.severity)}`,children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"p-2 rounded-lg bg-white",children:e.jsx(i,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:t.title}),e.jsx(Z,{className:`${z(t.severity)} border-0`,children:t.severity.toUpperCase()})]}),e.jsx("p",{className:"text-gray-700 mb-2",children:t.description}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-gray-900",children:"Impact:"}),e.jsx("p",{className:"text-gray-600",children:t.impact})]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-gray-900",children:"Recommendation:"}),e.jsx("p",{className:"text-gray-600",children:t.recommendation})]})]})]})]})},t.id)})})]})}),x!=="insights"&&e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:[x.charAt(0).toUpperCase()+x.slice(1)," View"]}),e.jsxs("p",{className:"text-gray-500",children:["Detailed ",x," tracking and analysis coming soon."]})]})})]})};export{we as BundleBatchTrackingDashboard,we as default};
