const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.B3OoR7j1.js","assets/query-vendor.DpsghfSz.js","assets/react-vendor.CfKEcsXX.js","assets/ui-vendor.D5U9TC-3.js","assets/firebase-vendor.D8xw0AXf.js","assets/utils-vendor.B0NEtgzl.js","assets/index.CZ3Rcx0c.css"])))=>i.map(i=>d[i]);
import{c as Y,j as e}from"./query-vendor.DpsghfSz.js";import{r as T}from"./react-vendor.CfKEcsXX.js";import{_ as S,v as w,I as q,B as _,a as A,C as W}from"./index.B3OoR7j1.js";import{p as K}from"./utils-vendor.B0NEtgzl.js";import{B as X,X as Q,f as V,E as Z,S as ee,c as te,D as se,T as re}from"./ui-vendor.D5U9TC-3.js";import"./firebase-vendor.D8xw0AXf.js";const F={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_BASE_URL:"https://erp-for-tsa.web.app/api",VITE_APP_NAME:"TSA Production ERP",VITE_APP_VERSION:"1.0.0",VITE_AUTO_REFRESH_INTERVAL:"60000",VITE_BUILD_SOURCEMAP:"false",VITE_DEBUG_MODE:"false",VITE_ENABLE_ANALYTICS:"true",VITE_ENABLE_DEV_TOOLS:"false",VITE_ENABLE_ERROR_REPORTING:"true",VITE_ENABLE_MOCK_DATA:"false",VITE_ENABLE_OFFLINE_MODE:"true",VITE_ENABLE_PERFORMANCE_MONITORING:"true",VITE_ENABLE_PUSH_NOTIFICATIONS:"true",VITE_ENABLE_PWA:"true",VITE_ENVIRONMENT:"production",VITE_FIREBASE_API_KEY:"AIzaSyB8Z4GdoLZsBW6bfmAh_BSTftpTRUXPZMw",VITE_FIREBASE_APP_ID:"1:271232983905:web:7d06c8f5ec269824759b20",VITE_FIREBASE_AUTH_DOMAIN:"erp-for-tsa.firebaseapp.com",VITE_FIREBASE_DATABASE_URL:"https://erp-for-tsa-default-rtdb.firebaseio.com",VITE_FIREBASE_MEASUREMENT_ID:"G-6CYWPS4N0G",VITE_FIREBASE_MESSAGING_SENDER_ID:"271232983905",VITE_FIREBASE_PROJECT_ID:"erp-for-tsa",VITE_FIREBASE_STORAGE_BUCKET:"erp-for-tsa.firebasestorage.app",VITE_HOST:"0.0.0.0",VITE_LEGACY_SUPPORT:"true",VITE_LOG_LEVEL:"error",VITE_OPEN:"true",VITE_PORT:"3000",VITE_USER_NODE_ENV:"production",VITE_USE_FIREBASE_EMULATORS:"false"},L=new Map,R=i=>{const c=L.get(i);return c?Object.fromEntries(Object.entries(c.stores).map(([t,n])=>[t,n.getState()])):{}},ae=(i,c,t)=>{if(i===void 0)return{type:"untracked",connection:c.connect(t)};const n=L.get(t.name);if(n)return{type:"tracked",store:i,...n};const s={connection:c.connect(t),stores:{}};return L.set(t.name,s),{type:"tracked",store:i,...s}},ne=(i,c)=>{if(c===void 0)return;const t=L.get(i);t&&(delete t.stores[c],Object.keys(t.stores).length===0&&L.delete(i))},ie=i=>{var c,t;if(!i)return;const n=i.split(`
`),s=n.findIndex(d=>d.includes("api.setState"));if(s<0)return;const a=((c=n[s+1])==null?void 0:c.trim())||"";return(t=/.+ (.+) .+/.exec(a))==null?void 0:t[1]},oe=(i,c={})=>(t,n,s)=>{const{enabled:a,anonymousActionType:d,store:l,...m}=c;let h;try{h=(a??(F?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!h)return i(t,n,s);const{connection:u,...E}=ae(l,h,m);let y=!0;s.setState=((o,p,x)=>{const f=t(o,p);if(!y)return f;const b=x===void 0?{type:d||ie(new Error().stack)||"anonymous"}:typeof x=="string"?{type:x}:x;return l===void 0?(u?.send(b,n()),f):(u?.send({...b,type:`${l}/${b.type}`},{...R(m.name),[l]:s.getState()}),f)}),s.devtools={cleanup:()=>{u&&typeof u.unsubscribe=="function"&&u.unsubscribe(),ne(m.name,l)}};const v=(...o)=>{const p=y;y=!1,t(...o),y=p},j=i(s.setState,n,s);if(E.type==="untracked"?u?.init(j):(E.stores[E.store]=s,u?.init(Object.fromEntries(Object.entries(E.stores).map(([o,p])=>[o,o===E.store?j:p.getState()])))),s.dispatchFromDevtools&&typeof s.dispatch=="function"){let o=!1;const p=s.dispatch;s.dispatch=(...x)=>{(F?"production":void 0)!=="production"&&x[0].type==="__setState"&&!o&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),o=!0),p(...x)}}return u.subscribe(o=>{var p;switch(o.type){case"ACTION":if(typeof o.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return P(o.payload,x=>{if(x.type==="__setState"){if(l===void 0){v(x.state);return}Object.keys(x.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const f=x.state[l];if(f==null)return;JSON.stringify(s.getState())!==JSON.stringify(f)&&v(f);return}s.dispatchFromDevtools&&typeof s.dispatch=="function"&&s.dispatch(x)});case"DISPATCH":switch(o.payload.type){case"RESET":return v(j),l===void 0?u?.init(s.getState()):u?.init(R(m.name));case"COMMIT":if(l===void 0){u?.init(s.getState());return}return u?.init(R(m.name));case"ROLLBACK":return P(o.state,x=>{if(l===void 0){v(x),u?.init(s.getState());return}v(x[l]),u?.init(R(m.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return P(o.state,x=>{if(l===void 0){v(x);return}JSON.stringify(s.getState())!==JSON.stringify(x[l])&&v(x[l])});case"IMPORT_STATE":{const{nextLiftedState:x}=o.payload,f=(p=x.computedStates.slice(-1)[0])==null?void 0:p.state;if(!f)return;v(l===void 0?f:f[l]),u?.send(null,x);return}case"PAUSE_RECORDING":return y=!y}return}}),j},le=oe,P=(i,c)=>{let t;try{t=JSON.parse(i)}catch(n){console.error("[zustand devtools middleware] Could not parse the received json",n)}t!==void 0&&c(t)};function ce(i,c){let t;try{t=i()}catch{return}return{getItem:s=>{var a;const d=m=>m===null?null:JSON.parse(m,void 0),l=(a=t.getItem(s))!=null?a:null;return l instanceof Promise?l.then(d):d(l)},setItem:(s,a)=>t.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>t.removeItem(s)}}const D=i=>c=>{try{const t=i(c);return t instanceof Promise?t:{then(n){return D(n)(t)},catch(n){return this}}}catch(t){return{then(n){return this},catch(n){return D(n)(t)}}}},de=(i,c)=>(t,n,s)=>{let a={storage:ce(()=>localStorage),partialize:o=>o,version:0,merge:(o,p)=>({...p,...o}),...c},d=!1;const l=new Set,m=new Set;let h=a.storage;if(!h)return i((...o)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...o)},n,s);const u=()=>{const o=a.partialize({...n()});return h.setItem(a.name,{state:o,version:a.version})},E=s.setState;s.setState=(o,p)=>(E(o,p),u());const y=i((...o)=>(t(...o),u()),n,s);s.getInitialState=()=>y;let v;const j=()=>{var o,p;if(!h)return;d=!1,l.forEach(f=>{var b;return f((b=n())!=null?b:y)});const x=((p=a.onRehydrateStorage)==null?void 0:p.call(a,(o=n())!=null?o:y))||void 0;return D(h.getItem.bind(h))(a.name).then(f=>{if(f)if(typeof f.version=="number"&&f.version!==a.version){if(a.migrate){const b=a.migrate(f.state,f.version);return b instanceof Promise?b.then(I=>[!0,I]):[!0,b]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,f.state];return[!1,void 0]}).then(f=>{var b;const[I,k]=f;if(v=a.merge(k,(b=n())!=null?b:y),t(v,!0),I)return u()}).then(()=>{x?.(v,void 0),v=n(),d=!0,m.forEach(f=>f(v))}).catch(f=>{x?.(void 0,f)})};return s.persist={setOptions:o=>{a={...a,...o},o.storage&&(h=o.storage)},clearStorage:()=>{h?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>j(),hasHydrated:()=>d,onHydrate:o=>(l.add(o),()=>{l.delete(o)}),onFinishHydration:o=>(m.add(o),()=>{m.delete(o)})},a.skipHydration||j(),v||y},ue=de,me=i=>(c,t,n)=>(n.setState=(s,a,...d)=>{const l=typeof s=="function"?K(s):s;return c(l,a,...d)},i(n.setState,t,n)),xe=me,U=1440*60*1e3,he=720*60*60*1e3,fe=Y()(le(ue(xe((i,c)=>({user:null,isAuthenticated:!1,isLoading:!1,error:null,sessionExpiry:null,login:async t=>{i(n=>{n.isLoading=!0,n.error=null});try{const{AuthService:n}=await S(async()=>{const{AuthService:a}=await import("./index.B3OoR7j1.js").then(d=>d.Q);return{AuthService:a}},__vite__mapDeps([0,1,2,3,4,5,6])),s=await n.login(t);if(s.success&&s.data){const{TokenService:a}=await S(async()=>{const{TokenService:h}=await import("./token-service.DZhubGLP.js");return{TokenService:h}},[]),{accessToken:d,refreshToken:l}=a.initializeTokens(s.data),m=t.rememberMe?he:U;i(h=>{h.user=s.data,h.isAuthenticated=!0,h.isLoading=!1,h.sessionExpiry=Date.now()+m}),console.log("Login successful for:",s.data.name),console.log("JWT tokens initialized")}else i(a=>{a.isLoading=!1,a.error=s.error||"Login failed"})}catch(n){i(s=>{s.isLoading=!1,s.error=n instanceof Error?n.message:"Login failed"})}},logout:async()=>{i(t=>{t.isLoading=!0});try{const{AuthService:t}=await S(async()=>{const{AuthService:a}=await import("./index.B3OoR7j1.js").then(d=>d.Q);return{AuthService:a}},__vite__mapDeps([0,1,2,3,4,5,6])),n=await t.logout(c().user?.id),{TokenService:s}=await S(async()=>{const{TokenService:a}=await import("./token-service.DZhubGLP.js");return{TokenService:a}},[]);s.clearTokens(),n.success?(i(a=>{a.user=null,a.isAuthenticated=!1,a.isLoading=!1,a.error=null,a.sessionExpiry=null}),console.log("Logout successful - JWT tokens cleared")):i(a=>{a.isLoading=!1,a.error=n.error||"Logout failed"})}catch(t){i(n=>{n.isLoading=!1,n.error=t instanceof Error?t.message:"Logout failed"})}},refreshUser:async()=>{const{user:t}=c();if(t){i(n=>{n.isLoading=!0});try{const{AuthService:n}=await S(async()=>{const{AuthService:a}=await import("./index.B3OoR7j1.js").then(d=>d.Q);return{AuthService:a}},__vite__mapDeps([0,1,2,3,4,5,6])),s=await n.getUserById(t.id,t.role);s.success&&s.data?(i(a=>{a.user=s.data,a.isLoading=!1}),console.log("User data refreshed for:",s.data.name)):i(a=>{a.isLoading=!1,a.error=s.error||"Failed to refresh user"})}catch(n){i(s=>{s.isLoading=!1,s.error=n instanceof Error?n.message:"Failed to refresh user"})}}},clearError:()=>{i(t=>{t.error=null})},updateUserProfile:t=>{i(n=>{n.user&&Object.assign(n.user,t)})},checkSession:()=>{const{sessionExpiry:t,user:n}=c();if(!n||!t)return!1;const s=Date.now()<t;return s||c().logout(),s},extendSession:()=>{i(t=>{t.sessionExpiry&&(t.sessionExpiry=Date.now()+U)})},initializeFromTokens:async()=>{try{const{TokenService:t}=await S(async()=>{const{TokenService:a}=await import("./token-service.DZhubGLP.js");return{TokenService:a}},[]),n=t.getUserFromToken(),s=t.getSessionExpiry();if(n&&s&&s>Date.now())i(a=>{a.user=n,a.isAuthenticated=!0,a.sessionExpiry=s,a.isLoading=!1}),console.log("Session restored from tokens");else{if((await t.refreshAccessToken()).success){const l=t.getUserFromToken(),m=t.getSessionExpiry();if(l&&m){i(h=>{h.user=l,h.isAuthenticated=!0,h.sessionExpiry=m,h.isLoading=!1}),console.log("Session refreshed from refresh token");return}}const{TokenService:d}=await S(async()=>{const{TokenService:l}=await import("./token-service.DZhubGLP.js");return{TokenService:l}},[]);d.clearTokens(),i(l=>{l.user=null,l.isAuthenticated=!1,l.sessionExpiry=null,l.isLoading=!1})}}catch(t){console.error("Error initializing from tokens:",t);const{TokenService:n}=await S(async()=>{const{TokenService:s}=await import("./token-service.DZhubGLP.js");return{TokenService:s}},[]);n.clearTokens(),i(s=>{s.user=null,s.isAuthenticated=!1,s.sessionExpiry=null,s.isLoading=!1})}},autoRefreshToken:async()=>{const{TokenService:t}=await S(async()=>{const{TokenService:s}=await import("./token-service.DZhubGLP.js");return{TokenService:s}},[]);await t.autoRefreshToken()||c().logout()}})),{name:"tsa-auth-store",partialize:i=>({user:i.user,isAuthenticated:i.isAuthenticated,sessionExpiry:i.sessionExpiry})}),{name:"AuthStore"})),ge=["Baisakh","Jestha","Asadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Poush","Magh","Falgun","Chaitra"],pe=["Aaitabar","Sombar","Mangalbar","Budhabar","Bihibar","Shukrabar","Shanibar"];function ve(i){const c=i.getFullYear(),t=i.getMonth()+1,n=i.getDate();let s=c+56,a=t,d=n;return t>=4&&n>=14?(s=c+57,a=t-3,a<=0&&(a+=12)):(s=c+56,a=t+9,a>12&&(a-=12)),{year:s,month:a,day:d,monthName:ge[a-1]||"Baisakh",dayName:pe[i.getDay()]||"Aaitabar"}}function B(i,c="short"){try{const t=new Date(i);if(isNaN(t.getTime()))return"Invalid Date";if(c==="relative")return ye(t);const n=ve(t);return c==="long"?`${n.day} ${n.monthName} ${n.year}`:`${n.year}/${n.month.toString().padStart(2,"0")}/${n.day.toString().padStart(2,"0")}`}catch(t){return console.error("Error formatting Nepali date:",t),"Date Error"}}function ye(i){try{const c=new Date,t=new Date(i);if(isNaN(t.getTime()))return"Invalid Date";const n=c.getTime()-t.getTime(),s=Math.floor(n/1e3),a=Math.floor(s/60),d=Math.floor(a/60),l=Math.floor(d/24),m=Math.floor(l/7),h=Math.floor(l/30),u=Math.floor(l/365);return s<60?"Just now":a<60?`${a} minute${a===1?"":"s"} ago`:d<24?`${d} hour${d===1?"":"s"} ago`:l<7?`${l} day${l===1?"":"s"} ago`:m<4?`${m} week${m===1?"":"s"} ago`:h<12?`${h} month${h===1?"":"s"} ago`:`${u} year${u===1?"":"s"} ago`}catch(c){return console.error("Error formatting relative time:",c),"Time Error"}}function Ne(i,c="relative"){if(!i)return"No date";try{return c==="nepali"?B(i,"long"):B(i,c)}catch{return"Date unavailable"}}const we=()=>{const[i,c]=T.useState([]),[t,n]=T.useState([]),[s,a]=T.useState(!0),[d,l]=T.useState(""),[m,h]=T.useState("all"),[u,E]=T.useState("list"),[y,v]=T.useState(null),[j,o]=T.useState(null),{user:p}=fe();T.useEffect(()=>{x()},[]),T.useEffect(()=>{f()},[i,d,m]);const x=async()=>{try{a(!0);const r=await w.getActiveTemplates();r.success&&r.data?c(r.data):o(r.error||"Failed to load templates")}catch(r){o("Failed to load templates"),console.error("Error loading templates:",r)}finally{a(!1)}},f=()=>{let r=[...i];d&&(r=r.filter(g=>g.templateName.toLowerCase().includes(d.toLowerCase())||g.templateCode.toLowerCase().includes(d.toLowerCase())||g.category.toLowerCase().includes(d.toLowerCase()))),m!=="all"&&(r=r.filter(g=>g.category===m)),n(r)},b=()=>{v(null),E("create")},I=r=>{v(r),E("edit")},k=r=>{v(r),E("view")},$=async r=>{if(confirm(`Are you sure you want to delete template "${r.templateName}"?`))try{const g=await w.deleteTemplate(r.id);g.success?await x():o(g.error||"Failed to delete template")}catch(g){o("Failed to delete template"),console.error("Error deleting template:",g)}},G=async r=>{try{const g={templateName:`${r.templateName} (Copy)`,templateCode:`${r.templateCode}_COPY`,articleCode:r.articleCode,articleName:r.articleName,articleNameNepali:r.articleNameNepali,garmentType:r.garmentType,operations:r.operations.map(N=>({name:N.name,nameNepali:N.nameNepali,description:N.description,machineType:N.machineType,estimatedTimeMinutes:N.estimatedTimeMinutes,skillLevelRequired:N.skillLevelRequired,pricePerPiece:N.pricePerPiece,pricePerMinute:N.pricePerMinute,dependencies:[...N.dependencies],canRunParallel:N.canRunParallel,parallelGroup:N.parallelGroup,qualityCheckRequired:N.qualityCheckRequired,defectTolerance:N.defectTolerance,isOptional:N.isOptional,notes:N.notes})),complexityLevel:r.complexityLevel,notes:r.notes,setupInstructions:r.setupInstructions,qualityNotes:r.qualityNotes},C=await w.createTemplate(g,p?.id||"system");C.success?await x():o(C.error||"Failed to duplicate template")}catch(g){o("Failed to duplicate template"),console.error("Error duplicating template:",g)}},J=async r=>{try{const g=await w.exportTemplate(r.id);if(g.success&&g.data){const C=JSON.stringify(g.data,null,2),N=new Blob([C],{type:"application/json"}),M=URL.createObjectURL(N),O=document.createElement("a");O.href=M,O.download=`${r.templateCode}_template.json`,O.click(),URL.revokeObjectURL(M)}}catch(g){o("Failed to export template"),console.error("Error exporting template:",g)}},z=async r=>{try{const g=u==="edit"&&y?await w.updateTemplate(y.id,r,p?.id||"system"):await w.createTemplate(r,p?.id||"system");g.success?(E("list"),x()):o(g.error||"Failed to save template")}catch(g){o("Failed to save template"),console.error("Error saving template:",g)}},H=r=>{switch(r){case"simple":return"success";case"medium":return"warning";case"complex":return"danger";case"expert":return"destructive";default:return"secondary"}};return u==="create"||u==="edit"?e.jsx("div",{className:"p-6",children:e.jsx(SewingTemplateForm,{template:y,onSave:z,onCancel:()=>E("list")})}):u==="view"&&y?e.jsx("div",{className:"p-6",children:e.jsx(SewingTemplateView,{template:y,onEdit:()=>E("edit"),onClose:()=>E("list")})}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto bg-gray-50 min-h-screen",children:[e.jsx("div",{className:"mb-8 bg-gradient-to-br from-blue-600 to-purple-700 text-white rounded-xl p-8 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-3",children:[e.jsx("span",{className:"text-4xl",children:"ðŸ§µ"}),"Sewing Template Manager"]}),e.jsx("p",{className:"text-blue-100 text-lg",children:"Create and manage sewing templates for different garment types"})]}),e.jsxs("div",{className:"hidden md:flex flex-col items-end",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-lg px-4 py-2 mb-2",children:[e.jsx("div",{className:"text-2xl font-bold",children:i.length}),e.jsx("div",{className:"text-sm text-blue-100",children:"Total Templates"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-lg px-4 py-2",children:[e.jsx("div",{className:"text-2xl font-bold",children:i.filter(r=>r.isActive).length}),e.jsx("div",{className:"text-sm text-blue-100",children:"Active"})]})]})]})}),j&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx("div",{className:"text-red-800",children:j}),e.jsx("button",{onClick:()=>o(null),className:"mt-2 text-sm text-red-600 hover:text-red-800 underline",children:"Dismiss"})]}),e.jsxs("div",{className:"mb-8 bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-start lg:items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(X,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(q,{type:"text",placeholder:"Search templates by name, code, or category...",value:d,onChange:r=>l(r.target.value),className:"pl-12 py-3 border-gray-200 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 rounded-lg text-sm"})]}),e.jsx("div",{className:"min-w-[220px]",children:e.jsxs("select",{value:m,onChange:r=>h(r.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-100 focus:border-blue-400 text-sm bg-gray-50",children:[e.jsx("option",{value:"all",children:"ðŸ” All Garment Types"}),e.jsx("option",{value:"tshirt",children:"ðŸ‘• T-Shirt"}),e.jsx("option",{value:"polo",children:"ðŸŒï¸ Polo Shirt"}),e.jsx("option",{value:"dress",children:"ðŸ‘— Dress"}),e.jsx("option",{value:"pants",children:"ðŸ‘– Pants"}),e.jsx("option",{value:"shirt",children:"ðŸ‘” Shirt"}),e.jsx("option",{value:"other",children:"ðŸ“¦ Other"})]})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(_,{variant:"outline",size:"sm",className:"flex items-center gap-2 border-gray-200 hover:bg-gray-50",children:[e.jsx(Q,{className:"w-4 h-4"}),"Import"]}),e.jsxs(_,{onClick:b,className:"flex items-center gap-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-6 py-2 rounded-lg shadow-md hover:shadow-lg transition-all duration-200",children:[e.jsx(V,{className:"w-4 h-4"}),"Create Template"]})]})]}),(d||m!=="all")&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsxs("span",{children:["ðŸ“Š Showing ",t.length," of ",i.length," templates"]}),d&&e.jsxs(A,{variant:"outline",className:"text-xs",children:['Search: "',d,'"']}),m!=="all"&&e.jsxs(A,{variant:"outline",className:"text-xs",children:["Category: ",m]})]})})]}),s?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 bg-white rounded-xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-gray-200"}),e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-600 border-t-transparent absolute top-0 left-0"})]}),e.jsxs("div",{className:"mt-4 text-center",children:[e.jsx("p",{className:"text-lg text-gray-700 font-medium",children:"Loading Templates..."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Please wait while we fetch your sewing templates"})]})]}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:t.map(r=>e.jsxs(W,{className:"group hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 bg-white border-0 shadow-md overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-purple-600 p-4 text-white",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold mb-1 line-clamp-2",children:r.templateName||"Untitled Template"}),e.jsxs("p",{className:"text-blue-100 text-sm flex items-center gap-1",children:[e.jsx("span",{children:"ðŸ·ï¸"})," ",r.templateCode||"No Code"]})]}),e.jsx(A,{className:`${H(r.complexityLevel)} text-xs font-semibold`,children:r.complexityLevel?.toUpperCase()||"UNKNOWN"})]}),e.jsxs("div",{className:"text-blue-100 text-sm",children:["ðŸ“ ",r.category||"No Category"]})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-5",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r.operations?.length||0}),e.jsx("div",{className:"text-xs text-blue-500 font-medium",children:"Operations"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:r.totalSmv||r.totalEstimatedTime||0}),e.jsx("div",{className:"text-xs text-green-500 font-medium",children:"SMV (min)"})]})]}),e.jsxs("div",{className:"space-y-3 mb-5",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 text-sm flex items-center gap-1",children:"ðŸ’° Est. Cost:"}),e.jsxs("span",{className:"font-bold text-purple-600",children:["â‚¹",r.totalPricePerPiece||r.totalEstimatedCost||0]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 text-sm flex items-center gap-1",children:"ðŸ“Š Usage Count:"}),e.jsxs("span",{className:"font-semibold text-orange-600",children:[r.timesUsed||0,"x"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600 text-sm flex items-center gap-1",children:"ðŸ“… Version:"}),e.jsxs(A,{variant:"outline",className:"text-xs",children:["v",r.version||1]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-4",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>k(r),className:"flex items-center justify-center gap-1 hover:bg-blue-50 border-blue-200 text-blue-600",children:[e.jsx(Z,{className:"w-4 h-4"}),"View"]}),e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>I(r),className:"flex items-center justify-center gap-1 hover:bg-green-50 border-green-200 text-green-600",children:[e.jsx(ee,{className:"w-4 h-4"}),"Edit"]})]}),e.jsxs("div",{className:"flex gap-1 justify-center",children:[e.jsx(_,{variant:"outline",size:"sm",onClick:()=>G(r),className:"flex items-center gap-1 text-xs hover:bg-gray-50 px-2 py-1",title:"Duplicate Template",children:e.jsx(te,{className:"w-3 h-3"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>J(r),className:"flex items-center gap-1 text-xs hover:bg-gray-50 px-2 py-1",title:"Export Template",children:e.jsx(se,{className:"w-3 h-3"})}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>$(r),className:"flex items-center gap-1 text-xs hover:bg-red-50 text-red-500 border-red-200 px-2 py-1",title:"Delete Template",children:e.jsx(re,{className:"w-3 h-3"})})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${r.isActive?"bg-green-100 text-green-700 border border-green-200":"bg-gray-100 text-gray-600 border border-gray-200"}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full mr-1 ${r.isActive?"bg-green-400":"bg-gray-400"}`}),r.isActive?"Active":"Inactive"]})}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Updated ",Ne(r.updatedAt||r.createdAt,"relative")]})]})})]})]},r.id))}),!s&&t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:"ðŸ“‹"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No templates found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:d||m!=="all"?"Try adjusting your search or filter criteria.":"Create your first sewing template to get started."}),!d&&m==="all"&&e.jsxs(_,{onClick:b,className:"flex items-center gap-2 mx-auto",children:[e.jsx(V,{className:"w-4 h-4"}),"Create First Template"]})]}),!s&&t.length>0&&e.jsxs("div",{className:"mt-8 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-2xl p-8 border border-indigo-100 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:"ðŸ“Š Template Analytics"}),e.jsx(A,{className:"bg-indigo-100 text-indigo-700 px-3 py-1 text-sm font-medium",children:d||m!=="all"?"Filtered View":"All Templates"})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md border border-blue-100 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-lg",children:e.jsx("span",{className:"text-2xl",children:"ðŸ“‹"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:t.length}),e.jsx("div",{className:"text-sm text-blue-500 font-medium",children:"Total Templates"})]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[(t.length/i.length*100).toFixed(1),"% of all templates"]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md border border-green-100 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-lg",children:e.jsx("span",{className:"text-2xl",children:"âœ…"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:t.filter(r=>r.isActive).length}),e.jsx("div",{className:"text-sm text-green-500 font-medium",children:"Active Templates"})]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[(t.filter(r=>r.isActive).length/t.length*100).toFixed(1),"% active rate"]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md border border-orange-100 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"bg-orange-100 p-3 rounded-lg",children:e.jsx("span",{className:"text-2xl",children:"â±ï¸"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:t.length>0?Math.round(t.reduce((r,g)=>r+(g.totalSmv||0),0)/t.length):0}),e.jsx("div",{className:"text-sm text-orange-500 font-medium",children:"Avg. SMV (min)"})]})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Standard Minute Value"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-md border border-purple-100 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-lg",children:e.jsx("span",{className:"text-2xl",children:"ðŸ’°"})}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:["â‚¹",t.length>0?Math.round(t.reduce((r,g)=>r+(g.totalPricePerPiece||0),0)/t.length):0]}),e.jsx("div",{className:"text-sm text-purple-500 font-medium",children:"Avg. Cost per Piece"})]})]}),e.jsx("div",{className:"text-xs text-gray-500",children:"Production cost estimate"})]})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white/70 backdrop-blur rounded-lg p-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Most Complex"}),e.jsxs("div",{className:"text-lg font-bold text-red-600",children:[t.filter(r=>r.complexityLevel==="expert").length," Expert"]})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur rounded-lg p-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Most Used"}),e.jsxs("div",{className:"text-lg font-bold text-indigo-600",children:[Math.max(...t.map(r=>r.timesUsed||0),0),"x Usage"]})]}),e.jsxs("div",{className:"bg-white/70 backdrop-blur rounded-lg p-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Categories"}),e.jsxs("div",{className:"text-lg font-bold text-teal-600",children:[[...new Set(t.map(r=>r.category))].length," Types"]})]})]})]})]})};export{we as SewingTemplateManager,we as default};
