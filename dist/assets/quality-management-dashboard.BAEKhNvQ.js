import{j as e}from"./query-vendor.DpsghfSz.js";import{r as m}from"./react-vendor.CfKEcsXX.js";import{C as u,c as _,d as M,e as G,b as y,I as O,B as N,a as S,F as ie,i as ne,q as ce}from"./index.CUWf0ERd.js";import{L as b}from"./label.a8PjD9uJ.js";import{S as F,a as D,b as P,c as E,d}from"./select.mP8pEsqY.js";import{c as oe}from"./utils.k9sMftog.js";import{d as k}from"./damage-report-service.CW7byCe-.js";import{t as x}from"./index.LBReXyrD.js";import{b as H,Y as se,_ as J,d as K,$ as de,a0 as Y,C as ae,p as Q,a1 as me,r as xe,j as re,J as he,a2 as ue,c as te,E as pe}from"./ui-vendor.D450QVBF.js";import{S as je}from"./separator.CazI6K64.js";import{g as U}from"./utils-vendor.B0NEtgzl.js";import{F as ge}from"./ShieldCheckIcon.7Wn9Ltzi.js";import{F as ve}from"./ClockIcon.B0z2Gpg3.js";import"./firebase-vendor.D8xw0AXf.js";import"./operator-wallet-service.BNyduHk2.js";const W=m.forwardRef(({className:c,...h},p)=>e.jsx("textarea",{className:oe("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",c),ref:p,...h}));W.displayName="Textarea";const fe=[{value:"cutting_error",label:"Cutting Error",nepali:"काट्ने गल्ती"},{value:"sewing_defect",label:"Sewing Defect",nepali:"सिलाई दोष"},{value:"fabric_tear",label:"Fabric Tear",nepali:"कपडा च्यातिने"},{value:"stain",label:"Stain/Mark",nepali:"दाग/निशान"},{value:"burn_mark",label:"Burn Mark",nepali:"जलेको निशान"},{value:"measurement_error",label:"Measurement Error",nepali:"नाप गल्ती"},{value:"thread_pull",label:"Thread Pull",nepali:"धागो तानिने"},{value:"hole_damage",label:"Hole/Puncture",nepali:"प्वाल"},{value:"color_fade",label:"Color Fade",nepali:"रंग फिक्का"},{value:"other",label:"Other",nepali:"अन्य"}],be=[{value:"minor",label:"Minor",description:"Repairable with minimal effort",color:"text-yellow-600"},{value:"major",label:"Major",description:"Requires significant rework",color:"text-orange-600"},{value:"critical",label:"Critical",description:"May result in rejection",color:"text-red-600"}],Ne=({bundleId:c,operatorId:h,onSuccess:p,onCancel:j})=>{const[l,t]=m.useState({damageType:"",damagedPieces:"",description:"",severity:"",estimatedCost:"",photos:[]}),[f,i]=m.useState(!1),[o,I]=m.useState([]),v=(r,n)=>{t(g=>({...g,[r]:n}))},A=r=>{const n=Array.from(r.target.files||[]);t(g=>({...g,photos:[...g.photos,...n]})),n.forEach(g=>{const s=URL.createObjectURL(g);I(L=>[...L,s])})},w=r=>{t(n=>({...n,photos:n.photos.filter((g,s)=>s!==r)})),I(n=>n.filter((g,s)=>s!==r))},R=()=>l.damageType?!l.damagedPieces||parseInt(l.damagedPieces)<=0?(x.error("Please enter a valid number of damaged pieces"),!1):l.description.trim()?l.severity?!0:(x.error("Please select the severity level"),!1):(x.error("Please provide a description of the damage"),!1):(x.error("Please select a damage type"),!1),T=async r=>{if(r.preventDefault(),!!R()){i(!0);try{const n={bundleId:c,operatorId:h,damageType:l.damageType,damagedPieces:parseInt(l.damagedPieces),description:l.description,severity:l.severity,photos:o,estimatedCost:parseFloat(l.estimatedCost)||0},g=await k.createDamageReport(n);x.success("Damage report submitted successfully"),p?.(g)}catch(n){console.error("Error submitting damage report:",n),x.error("Failed to submit damage report. Please try again.")}finally{i(!1)}}};return e.jsxs(u,{className:"w-full max-w-2xl mx-auto",children:[e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"h-5 w-5 text-amber-500"}),e.jsx(M,{children:"Report Damage"})]}),e.jsxs(G,{children:["Bundle ID: ",c," | Please provide detailed information about the damage"]})]}),e.jsx(y,{children:e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"damageType",children:"Damage Type *"}),e.jsxs(F,{value:l.damageType,onValueChange:r=>v("damageType",r),children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Select damage type"})}),e.jsx(E,{children:fe.map(r=>e.jsxs(d,{value:r.value,children:[r.label," - ",r.nepali]},r.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"damagedPieces",children:"Number of Damaged Pieces *"}),e.jsx(O,{id:"damagedPieces",type:"number",min:"1",value:l.damagedPieces,onChange:r=>v("damagedPieces",r.target.value),placeholder:"Enter number of damaged pieces"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"severity",children:"Severity Level *"}),e.jsxs(F,{value:l.severity,onValueChange:r=>v("severity",r),children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Select severity level"})}),e.jsx(E,{children:be.map(r=>e.jsxs(d,{value:r.value,children:[r.label," - ",r.description]},r.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"description",children:"Detailed Description *"}),e.jsx(W,{id:"description",value:l.description,onChange:r=>v("description",r.target.value),placeholder:"Describe the damage in detail, including how it occurred...",rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"estimatedCost",children:"Estimated Cost Impact (NPR)"}),e.jsx(O,{id:"estimatedCost",type:"number",min:"0",step:"0.01",value:l.estimatedCost,onChange:r=>v("estimatedCost",r.target.value),placeholder:"Estimated cost of damage"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{children:"Damage Photos"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{type:"button",variant:"outline",className:"flex items-center space-x-2",asChild:!0,children:e.jsxs("label",{children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:"Upload Photos"}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:A,className:"sr-only"})]})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[l.photos.length," photo(s) selected"]})]}),o.length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:o.map((r,n)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:r,alt:`Damage photo ${n+1}`,className:"w-full h-20 object-cover rounded border"}),e.jsx(N,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 rounded-full p-0",onClick:()=>w(n),children:"×"})]},n))})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx(N,{type:"submit",disabled:f,className:"flex-1",children:f?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-4 w-4 mr-2 animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Submit Report"]})}),e.jsx(N,{type:"button",variant:"outline",onClick:j,disabled:f,className:"flex-1",children:"Cancel"})]})]})})]})},X={low:{label:"Low",color:"bg-green-100 text-green-800",icon:"●"},medium:{label:"Medium",color:"bg-yellow-100 text-yellow-800",icon:"●●"},high:{label:"High",color:"bg-orange-100 text-orange-800",icon:"●●●"},urgent:{label:"Urgent",color:"bg-red-100 text-red-800",icon:"●●●●"}},B={pending:{label:"Pending Review",color:"bg-yellow-100 text-yellow-800",icon:ae},approved:{label:"Approved",color:"bg-blue-100 text-blue-800",icon:K},rejected:{label:"Rejected",color:"bg-red-100 text-red-800",icon:Y},in_progress:{label:"In Progress",color:"bg-purple-100 text-purple-800",icon:de},completed:{label:"Completed",color:"bg-green-100 text-green-800",icon:K}},ye=({supervisorId:c})=>{const[h,p]=m.useState([]),[j,l]=m.useState(!0),[t,f]=m.useState(null),[i,o]=m.useState({decision:"",instructions:"",assignedTo:"",priority:"",estimatedHours:"",reworkCost:""}),[I,v]=m.useState(!1);m.useEffect(()=>{A()},[]);const A=async()=>{try{l(!0);const s=await k.getReworkRequests();p(s)}catch(s){console.error("Error loading rework requests:",s),x.error("Failed to load rework requests")}finally{l(!1)}},w=s=>{f(s),o({decision:"",instructions:s.reworkInstructions||"",assignedTo:s.assignedTo||"",priority:s.priority,estimatedHours:s.estimatedHours?.toString()||"",reworkCost:s.reworkCost?.toString()||""})},R=(s,L)=>{o(V=>({...V,[s]:L}))},T=async()=>{if(!t||!i.decision){x.error("Please select a decision");return}if(i.decision==="approved"&&!i.instructions.trim()){x.error("Please provide rework instructions");return}v(!0);try{const s={decision:i.decision,instructions:i.instructions,assignedTo:i.assignedTo,priority:i.priority,estimatedHours:parseFloat(i.estimatedHours)||0,reworkCost:parseFloat(i.reworkCost)||0,reviewedBy:c,reviewedAt:new Date};await k.reviewReworkRequest(t.id,s),x.success(`Rework request ${i.decision}`),f(null),A()}catch(s){console.error("Error submitting review:",s),x.error("Failed to submit review")}finally{v(!1)}},r=h.filter(s=>s.status==="pending"),n=h.filter(s=>["approved","in_progress"].includes(s.status)),g=h.filter(s=>["completed","rejected"].includes(s.status));return j?e.jsx(u,{children:e.jsx(y,{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{children:e.jsxs(_,{children:[e.jsxs(M,{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"h-5 w-5"}),e.jsx("span",{children:"Rework Requests"})]}),e.jsx(G,{children:"Review and approve rework requests from damage reports"})]})}),r.length>0&&e.jsxs(u,{children:[e.jsx(_,{children:e.jsxs(M,{className:"text-lg text-amber-600",children:["Pending Review (",r.length,")"]})}),e.jsx(y,{className:"space-y-3",children:r.map(s=>e.jsx(q,{request:s,isSelected:t?.id===s.id,onClick:()=>w(s)},s.id))})]}),n.length>0&&e.jsxs(u,{children:[e.jsx(_,{children:e.jsxs(M,{className:"text-lg text-blue-600",children:["Active Rework (",n.length,")"]})}),e.jsx(y,{className:"space-y-3",children:n.map(s=>e.jsx(q,{request:s,isSelected:t?.id===s.id,onClick:()=>w(s)},s.id))})]}),g.length>0&&e.jsxs(u,{children:[e.jsx(_,{children:e.jsx(M,{className:"text-lg text-green-600",children:"Recently Completed"})}),e.jsx(y,{className:"space-y-3",children:g.slice(0,3).map(s=>e.jsx(q,{request:s,isSelected:t?.id===s.id,onClick:()=>w(s)},s.id))})]})]}),e.jsx("div",{children:t?e.jsxs(u,{className:"sticky top-4",children:[e.jsxs(_,{children:[e.jsxs(M,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Review Request"}),e.jsx(S,{className:B[t.status].color,children:B[t.status].label})]}),e.jsxs(G,{children:["Bundle: ",t.bundleId," | Operator: ",t.operatorName]})]}),e.jsxs(y,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground mb-2",children:"DAMAGE DETAILS"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Type:"}),e.jsx("p",{className:"font-medium",children:t.damageType.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Pieces:"}),e.jsx("p",{className:"font-bold text-red-600",children:t.damagedPieces})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Severity:"}),e.jsx("p",{className:"font-medium capitalize",children:t.severity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Cost Impact:"}),e.jsxs("p",{className:"flex items-center font-semibold",children:[e.jsx(Q,{className:"h-3 w-3 mr-1"}),t.estimatedCost.toFixed(2)]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"DESCRIPTION"}),e.jsx("p",{className:"text-sm p-2 bg-muted rounded",children:t.description})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Submitted ",U(new Date(t.submittedAt),{addSuffix:!0})]})]}),e.jsx(je,{}),t.status==="pending"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"Review Decision"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{children:"Decision *"}),e.jsxs(F,{value:i.decision,onValueChange:s=>R("decision",s),children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Select decision"})}),e.jsxs(E,{children:[e.jsx(d,{value:"approved",children:"Approve Rework"}),e.jsx(d,{value:"rejected",children:"Reject Request"})]})]})]}),i.decision==="approved"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{children:"Rework Instructions *"}),e.jsx(W,{value:i.instructions,onChange:s=>R("instructions",s.target.value),placeholder:"Provide detailed instructions for the rework...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{children:"Assign To"}),e.jsxs(F,{value:i.assignedTo,onValueChange:s=>R("assignedTo",s),children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Select operator"})}),e.jsxs(E,{children:[e.jsx(d,{value:"same_operator",children:"Same Operator"}),e.jsx(d,{value:"quality_team",children:"Quality Team"}),e.jsx(d,{value:"specialist",children:"Specialist"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{children:"Priority"}),e.jsxs(F,{value:i.priority,onValueChange:s=>R("priority",s),children:[e.jsx(D,{children:e.jsx(P,{})}),e.jsxs(E,{children:[e.jsx(d,{value:"low",children:"Low"}),e.jsx(d,{value:"medium",children:"Medium"}),e.jsx(d,{value:"high",children:"High"}),e.jsx(d,{value:"urgent",children:"Urgent"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{children:"Estimated Hours"}),e.jsx(O,{type:"number",min:"0",step:"0.5",value:i.estimatedHours,onChange:s=>R("estimatedHours",s.target.value),placeholder:"Hours needed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{children:"Rework Cost (NPR)"}),e.jsx(O,{type:"number",min:"0",step:"0.01",value:i.reworkCost,onChange:s=>R("reworkCost",s.target.value),placeholder:"Additional cost"})]})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx(N,{onClick:T,disabled:I||!i.decision,className:"flex-1",children:I?"Submitting...":"Submit Review"}),e.jsx(N,{variant:"outline",onClick:()=>f(null),className:"flex-1",children:"Cancel"})]})]}),t.status!=="pending"&&t.reviewedBy&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground",children:"REVIEW HISTORY"}),e.jsxs("div",{className:"p-3 bg-muted rounded text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Reviewed by:"})," ",t.reviewedBy]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Decision:"})," ",t.status.replace("_"," ").toUpperCase()]}),t.reviewedAt&&e.jsxs("p",{children:[e.jsx("strong",{children:"Reviewed:"})," ",U(new Date(t.reviewedAt),{addSuffix:!0})]}),t.reworkInstructions&&e.jsxs("p",{children:[e.jsx("strong",{children:"Instructions:"})," ",t.reworkInstructions]})]})]})]})]}):e.jsx(u,{children:e.jsxs(y,{className:"text-center py-8",children:[e.jsx(me,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Select a Request"}),e.jsx("p",{className:"text-muted-foreground",children:"Choose a rework request from the list to review and make decisions"})]})})})]})},q=({request:c,isSelected:h,onClick:p})=>{const j=B[c.status].icon;return e.jsxs("div",{className:`p-3 border rounded cursor-pointer transition-colors ${h?"border-primary bg-primary/5":"hover:bg-muted/50"}`,onClick:p,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{variant:"outline",className:"font-mono text-xs",children:c.bundleId}),e.jsx(S,{className:X[c.priority].color,children:X[c.priority].label})]}),e.jsxs(S,{className:B[c.status].color,children:[e.jsx(j,{className:"h-3 w-3 mr-1"}),B[c.status].label]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center text-muted-foreground",children:[e.jsx(xe,{className:"h-3 w-3 mr-1"}),c.operatorName]}),e.jsxs("p",{className:"font-medium",children:[c.damageType.replace("_"," ")," - ",c.damagedPieces," pieces"]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(re,{className:"h-3 w-3 mr-1"}),U(new Date(c.submittedAt),{addSuffix:!0})]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(Q,{className:"h-3 w-3 mr-1"}),c.estimatedCost.toFixed(0)]})]})]})]})},Z={cutting_error:{label:"Cutting Error",nepali:"काट्ने गल्ती"},sewing_defect:{label:"Sewing Defect",nepali:"सिलाई दोष"},fabric_tear:{label:"Fabric Tear",nepali:"कपडा च्यातिने"},stain:{label:"Stain/Mark",nepali:"दाग/निशान"},burn_mark:{label:"Burn Mark",nepali:"जलेको निशान"},measurement_error:{label:"Measurement Error",nepali:"नाप गल्ती"},thread_pull:{label:"Thread Pull",nepali:"धागो तानिने"},hole_damage:{label:"Hole/Puncture",nepali:"प्वाल"},color_fade:{label:"Color Fade",nepali:"रंग फिक्का"},other:{label:"Other",nepali:"अन्य"}},z={pending:{label:"Pending Review",color:"bg-yellow-100 text-yellow-800",icon:ae},approved:{label:"Approved",color:"bg-green-100 text-green-800",icon:te},rejected:{label:"Rejected",color:"bg-red-100 text-red-800",icon:Y},rework_required:{label:"Rework Required",color:"bg-orange-100 text-orange-800",icon:H}},ee={minor:{color:"bg-yellow-100 text-yellow-800",label:"Minor"},major:{color:"bg-orange-100 text-orange-800",label:"Major"},critical:{color:"bg-red-100 text-red-800",label:"Critical"}},we=({operatorId:c,bundleId:h,showActions:p=!1,onReportClick:j})=>{const[l,t]=m.useState([]),[f,i]=m.useState(!0),[o,I]=m.useState(""),[v,A]=m.useState("all"),[w,R]=m.useState("all"),[T,r]=m.useState("timestamp");m.useEffect(()=>{n()},[c,h]);const n=async()=>{try{i(!0);let a;c?a=await k.getOperatorReports(c):h?a=await k.getBundleReports(h):a=await k.getAllReports(),t(a)}catch(a){console.error("Error loading damage reports:",a),x.error("Failed to load damage reports")}finally{i(!1)}},g=async a=>{try{await k.approveReport(a),x.success("Damage report approved"),n()}catch{x.error("Failed to approve report")}},s=async a=>{try{await k.rejectReport(a),x.success("Damage report rejected"),n()}catch{x.error("Failed to reject report")}},L=async a=>{try{await k.assignRework(a),x.success("Rework assigned"),n()}catch{x.error("Failed to assign rework")}},V=l.filter(a=>{const C=a.bundleId.toLowerCase().includes(o.toLowerCase())||a.operatorName?.toLowerCase().includes(o.toLowerCase())||a.description.toLowerCase().includes(o.toLowerCase()),$=v==="all"||a.status===v,le=w==="all"||a.severity===w;return C&&$&&le}).sort((a,C)=>{if(T==="timestamp")return new Date(C.timestamp).getTime()-new Date(a.timestamp).getTime();if(T==="severity"){const $={critical:3,major:2,minor:1};return $[C.severity]-$[a.severity]}else if(T==="cost")return C.estimatedCost-a.estimatedCost;return 0});return f?e.jsx(u,{children:e.jsx(y,{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Damage Reports"}),e.jsxs("p",{className:"text-muted-foreground",children:[l.length," total reports",c&&" for this operator",h&&` for bundle ${h}`]})]})}),e.jsx(u,{children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(he,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(O,{placeholder:"Search reports...",value:o,onChange:a=>I(a.target.value),className:"pl-8"})]}),e.jsxs(F,{value:v,onValueChange:A,children:[e.jsxs(D,{children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),e.jsx(P,{placeholder:"Filter by status"})]}),e.jsxs(E,{children:[e.jsx(d,{value:"all",children:"All Status"}),e.jsx(d,{value:"pending",children:"Pending"}),e.jsx(d,{value:"approved",children:"Approved"}),e.jsx(d,{value:"rejected",children:"Rejected"}),e.jsx(d,{value:"rework_required",children:"Rework Required"})]})]}),e.jsxs(F,{value:w,onValueChange:R,children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Filter by severity"})}),e.jsxs(E,{children:[e.jsx(d,{value:"all",children:"All Severity"}),e.jsx(d,{value:"minor",children:"Minor"}),e.jsx(d,{value:"major",children:"Major"}),e.jsx(d,{value:"critical",children:"Critical"})]})]}),e.jsxs(F,{value:T,onValueChange:r,children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Sort by"})}),e.jsxs(E,{children:[e.jsx(d,{value:"timestamp",children:"Latest First"}),e.jsx(d,{value:"severity",children:"Severity"}),e.jsx(d,{value:"cost",children:"Cost Impact"})]})]})]})})}),V.length===0?e.jsx(u,{children:e.jsxs(y,{className:"text-center py-8",children:[e.jsx(H,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No damage reports found"}),e.jsx("p",{className:"text-muted-foreground",children:o||v!=="all"||w!=="all"?"No reports match your current filters":"No damage reports have been submitted yet"})]})}):e.jsx("div",{className:"space-y-4",children:V.map(a=>{const C=z[a.status].icon;return e.jsx(u,{className:"hover:shadow-md transition-shadow",children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(S,{variant:"outline",className:"font-mono",children:a.bundleId}),e.jsx(S,{className:ee[a.severity].color,children:ee[a.severity].label}),e.jsxs(S,{className:z[a.status].color,children:[e.jsx(C,{className:"h-3 w-3 mr-1"}),z[a.status].label]}),a.photos.length>0&&e.jsxs(S,{variant:"secondary",children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),a.photos.length," photos"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground",children:"DAMAGE TYPE"}),e.jsx("p",{className:"font-medium",children:Z[a.damageType]?.label||a.damageType}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Z[a.damageType]?.nepali})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground",children:"PIECES AFFECTED"}),e.jsx("p",{className:"text-lg font-bold text-red-600",children:a.damagedPieces})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground",children:"ESTIMATED COST"}),e.jsxs("p",{className:"flex items-center font-semibold",children:[e.jsx(Q,{className:"h-4 w-4 mr-1"}),a.estimatedCost.toFixed(2)]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"DESCRIPTION"}),e.jsx("p",{className:"text-sm",children:a.description})]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground space-x-4",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(re,{className:"h-4 w-4 mr-1"}),U(new Date(a.timestamp),{addSuffix:!0})]}),a.operatorName&&e.jsxs("span",{children:["Operator: ",a.operatorName]}),a.approvedBy&&e.jsxs("span",{children:["Approved by: ",a.approvedBy]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2 ml-4",children:[e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>j?.(a),children:[e.jsx(pe,{className:"h-4 w-4 mr-1"}),"View"]}),p&&a.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(N,{variant:"default",size:"sm",onClick:()=>g(a.id),children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),"Approve"]}),e.jsxs(N,{variant:"destructive",size:"sm",onClick:()=>s(a.id),children:[e.jsx(Y,{className:"h-4 w-4 mr-1"}),"Reject"]}),e.jsxs(N,{variant:"secondary",size:"sm",onClick:()=>L(a.id),children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),"Rework"]})]})]})]})})},a.id)})})]})},Oe=({userRole:c="supervisor",userData:h})=>{const[p,j]=m.useState("overview"),l={pendingReports:12,reworkItems:23,qualityRate:96.1},t=[{id:"DR001",bundleId:"BND-2024-001",operatorName:"Maya Sharma",damageType:"Fabric Tear",severity:"High",status:"Pending Review",timestamp:new Date("2024-12-07T10:30:00")},{id:"DR002",bundleId:"BND-2024-003",operatorName:"Rajesh Kumar",damageType:"Stitching Defect",severity:"Medium",status:"Approved for Rework",timestamp:new Date("2024-12-07T09:15:00")}],f=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(ie,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Quality Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[l.qualityRate,"%"]})]})]})}),e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:e.jsx(ne,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending Reports"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:l.pendingReports})]})]})}),e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:e.jsx(ve,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Rework Items"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:l.reworkItems})]})]})})]}),e.jsxs(u,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Damage Reports"}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>j("new-report"),children:"New Report"})]}),e.jsx("div",{className:"space-y-3",children:t.map(o=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:o.id}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Bundle: ",o.bundleId]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Operator: ",o.operatorName]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:o.damageType}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(S,{variant:o.severity==="High"?"destructive":"secondary",children:o.severity}),e.jsx(S,{variant:o.status==="Pending Review"?"secondary":"outline",children:o.status})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{variant:"ghost",size:"sm",children:e.jsx(ce,{className:"h-4 w-4"})}),e.jsx("span",{className:"text-sm text-gray-500",children:o.timestamp.toLocaleTimeString()})]})]},o.id))})]})]}),i=()=>{switch(p){case"overview":return f();case"reports":return e.jsx(we,{});case"approvals":return e.jsx(ye,{userRole:c});case"new-report":return e.jsx(Ne,{bundleId:"BND-2024-001",operatorId:h?.id||"unknown-operator",onCancel:()=>j("overview"),onSuccess:()=>j("overview")});default:return f()}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(ge,{className:"h-8 w-8 text-blue-600"}),e.jsx("span",{children:"Quality Management"})]}),e.jsx("p",{className:"text-gray-600",children:"Monitor quality control and damage reporting"})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>j("overview"),className:`py-2 px-1 border-b-2 font-medium text-sm ${p==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Overview"}),e.jsx("button",{onClick:()=>j("reports"),className:`py-2 px-1 border-b-2 font-medium text-sm ${p==="reports"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Damage Reports"}),e.jsx("button",{onClick:()=>j("approvals"),className:`py-2 px-1 border-b-2 font-medium text-sm ${p==="approvals"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Rework Approvals"}),e.jsx("button",{onClick:()=>j("new-report"),className:`py-2 px-1 border-b-2 font-medium text-sm ${p==="new-report"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"New Report"})]})}),i()]})};export{Oe as QualityManagementDashboard,Oe as default};
