const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.B3OoR7j1.js","assets/query-vendor.DpsghfSz.js","assets/react-vendor.CfKEcsXX.js","assets/ui-vendor.D5U9TC-3.js","assets/firebase-vendor.D8xw0AXf.js","assets/utils-vendor.B0NEtgzl.js","assets/index.CZ3Rcx0c.css"])))=>i.map(i=>d[i]);
import{j as e}from"./query-vendor.DpsghfSz.js";import{r as p}from"./react-vendor.CfKEcsXX.js";import{_ as k,C as i,b as c,B,c as o,d as x,e as S}from"./index.B3OoR7j1.js";import{S as Q}from"./select.BS0-IYhb.js";import{t as D}from"./index.LBReXyrD.js";import{x as W,R as $,D as U,P as K,m as M,d as V,C as T,l as F,U as E,k as G}from"./ui-vendor.D5U9TC-3.js";import{R as L,L as Y,C as H,X,Y as z,T as I,a as _,P as J,b as Z,c as ee}from"./chart-vendor.5EaSH9G6.js";import"./firebase-vendor.D8xw0AXf.js";import"./utils-vendor.B0NEtgzl.js";const A={getProductionMetrics:async u=>{try{const{collection:s,getDocs:h,query:b,where:R,orderBy:j}=await k(async()=>{const{collection:a,getDocs:d,query:g,where:v,orderBy:w}=await import("./firebase-vendor.D8xw0AXf.js").then(P=>P.al);return{collection:a,getDocs:d,query:g,where:v,orderBy:w}},[]),{db:N}=await k(async()=>{const{db:a}=await import("./index.B3OoR7j1.js").then(d=>d.O);return{db:a}},__vite__mapDeps([0,1,2,3,4,5,6])),m=s(N,"production_bundles"),f=s(N,"operators"),[n,y]=await Promise.all([h(b(m,j("createdAt","desc"))),h(f)]);if(!n.empty&&!y.empty){const a=n.docs.map(r=>r.data()),d=y.docs.map(r=>r.data()),g=a.reduce((r,t)=>r+(t.quantity||t.targetPieces||0),0),v=a.filter(r=>r.status==="completed"||r.status==="finished").length,w=d.reduce((r,t)=>r+(t.averageEfficiency||85),0)/d.length,P=d.filter(r=>r.isActive&&r.availabilityStatus==="available").length;return{success:!0,data:{totalProduction:g,dailyAverage:Math.floor(g/7),efficiency:Math.round(w),qualityScore:92,activeOperators:P,completedBundles:v,pendingWork:a.filter(r=>["created","in_progress","assigned"].includes(r.status)).length,damageRate:2.1,reworkPercentage:3.4,onTimeDelivery:94.5}}}else return{success:!0,data:{totalProduction:null,dailyAverage:null,efficiency:null,qualityScore:null,activeOperators:null,completedBundles:null,pendingWork:null,damageRate:null,reworkPercentage:null,onTimeDelivery:null},message:"No production data available. Add operators and bundles to see metrics here."}}catch(s){return console.error("Error loading production metrics:",s),{success:!1,data:{totalProduction:null,dailyAverage:null,efficiency:null,qualityScore:null,activeOperators:null,completedBundles:null,pendingWork:null,damageRate:null,reworkPercentage:null,onTimeDelivery:null},error:"Failed to load data from Firebase",message:"Connect to Firebase and add production data to see metrics here."}}},getProductionTrends:async u=>({success:!0,data:{trend:"upward",data:Array.from({length:30},(s,h)=>({date:new Date(Date.now()-(29-h)*24*60*60*1e3).toISOString().split("T")[0],production:Math.floor(Math.random()*100)+50,efficiency:Math.floor(Math.random()*30)+70,quality:Math.floor(Math.random()*20)+80}))}}),getOperatorPerformance:async u=>{try{const{collection:s,getDocs:h,query:b,where:R}=await k(async()=>{const{collection:f,getDocs:n,query:y,where:a}=await import("./firebase-vendor.D8xw0AXf.js").then(d=>d.al);return{collection:f,getDocs:n,query:y,where:a}},[]),{db:j}=await k(async()=>{const{db:f}=await import("./index.B3OoR7j1.js").then(n=>n.O);return{db:f}},__vite__mapDeps([0,1,2,3,4,5,6])),N=s(j,"operators"),m=await h(N);return m.empty?{success:!0,data:[],message:"No operator data available. Add operators to see performance metrics."}:{success:!0,data:m.docs.map(n=>({operatorId:n.id,name:n.data().name||"Unknown Operator",totalPieces:n.data().completedPieces||0,efficiency:n.data().averageEfficiency||0,qualityScore:n.data().qualityScore||0,earnings:n.data().totalEarnings||0}))}}catch{return{success:!1,data:[],error:"Failed to load operator data",message:"Connect to Firebase and add operator data to see performance here."}}},getWorkTypeAnalysis:async u=>({success:!0,data:[{type:"Cutting",count:25,efficiency:85,avgTime:120},{type:"Sewing",count:40,efficiency:78,avgTime:180},{type:"Finishing",count:30,efficiency:92,avgTime:90},{type:"Quality Check",count:15,efficiency:95,avgTime:60}]}),getBundleAnalytics:async u=>({success:!0,data:{completionRate:0,efficiency:0,timeSpent:0}}),getQualityMetrics:async()=>({success:!0,data:{defectRate:0,reworkRate:0,qualityScore:0}}),generateReport:async(u,s)=>({success:!0,data:{reportId:"report-123",type:u,generatedAt:new Date,downloadUrl:"/api/reports/report-123.pdf"}})},C=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"],se={"A+":{score:95,color:"#10B981"},A:{score:85,color:"#3B82F6"},B:{score:75,color:"#F59E0B"},C:{score:65,color:"#EF4444"},D:{score:50,color:"#DC2626"}},xe=({timeRange:u="month"})=>{const[s,h]=p.useState(null),[b,R]=p.useState([]),[j,N]=p.useState([]),[m,f]=p.useState([]),[n,y]=p.useState(!0),[a,d]=p.useState(u),[g,v]=p.useState(!1);p.useEffect(()=>{w()},[a]);const w=async()=>{try{y(!0);const[t,l,O,q]=await Promise.all([A.getProductionMetrics(a),A.getProductionTrends(a),A.getOperatorPerformance(a),A.getWorkTypeAnalysis(a)]);h(t),R(l),N(Array.isArray(O)?O:[]),f(Array.isArray(q)?q:[])}catch(t){console.error("Error loading dashboard data:",t),D.error("Failed to load dashboard data")}finally{y(!1)}},P=async()=>{v(!0),await w(),v(!1),D.success("Dashboard data refreshed")},r=async()=>{try{await A.exportProductionReport(a),D.success("Report exported successfully")}catch{D.error("Failed to export report")}};return n?e.jsx("div",{className:"space-y-6",children:[...Array(4)].map((t,l)=>e.jsx(i,{children:e.jsx(c,{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})},l))}):s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Production Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Comprehensive production analytics and performance metrics"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(Q,{value:a,onValueChange:d,className:"w-40",children:[e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"}),e.jsx("option",{value:"quarter",children:"This Quarter"}),e.jsx("option",{value:"year",children:"This Year"})]}),e.jsxs(B,{variant:"outline",onClick:P,disabled:g,children:[e.jsx($,{className:`h-4 w-4 mr-2 ${g?"animate-spin":""}`}),"Refresh"]}),e.jsxs(B,{onClick:r,children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Export Report"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[e.jsxs(i,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Total Production"}),e.jsx(K,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s?.totalProduction?.toLocaleString()||"0"}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[e.jsx(M,{className:"h-3 w-3 mr-1 text-green-500"}),s?.dailyAverage?.toFixed(0)||"0"," pieces/day avg"]})]})]}),e.jsxs(i,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Efficiency"}),e.jsx(V,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[s?.efficiency?.toFixed(1)||"0","%"]}),e.jsxs("div",{className:`flex items-center text-xs ${(s?.efficiency??0)>=80?"text-green-600":(s?.efficiency??0)>=60?"text-yellow-600":"text-red-600"}`,children:[(s?.efficiency??0)>=80?e.jsx(T,{className:"h-3 w-3 mr-1"}):e.jsx(F,{className:"h-3 w-3 mr-1"}),"Target: 80%"]})]})]}),e.jsxs(i,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Quality Score"}),e.jsx(T,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[s?.qualityScore?.toFixed(1)||"0","%"]}),e.jsxs("div",{className:`flex items-center text-xs ${(s?.qualityScore??0)>=90?"text-green-600":(s?.qualityScore??0)>=80?"text-yellow-600":"text-red-600"}`,children:["Damage Rate: ",s?.damageRate?.toFixed(1)||"0","%"]})]})]}),e.jsxs(i,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"Active Operators"}),e.jsx(E,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s?.activeOperators||"0"}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[s?.completedBundles||"0"," bundles completed"]})]})]}),e.jsxs(i,{children:[e.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(x,{className:"text-sm font-medium",children:"On-Time Delivery"}),e.jsx(G,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(c,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[s?.onTimeDelivery?.toFixed(1)||"0","%"]}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[s?.pendingWork||"0"," pending"]})]})]})]}),e.jsxs(i,{children:[e.jsxs(o,{children:[e.jsxs(x,{className:"flex items-center space-x-2",children:[e.jsx(M,{className:"h-5 w-5"}),e.jsx("span",{children:"Production Trends"})]}),e.jsx(S,{children:"Daily production, quality, and efficiency trends"})]}),e.jsx(c,{children:e.jsx("div",{className:"h-80 w-full",children:e.jsx(L,{width:"100%",height:"100%",children:e.jsxs(Y,{data:Array.isArray(b)?b:[],children:[e.jsx(H,{strokeDasharray:"3 3"}),e.jsx(X,{dataKey:"date"}),e.jsx(z,{}),e.jsx(I,{}),e.jsx(_,{type:"monotone",dataKey:"production",stroke:"#3B82F6",strokeWidth:2,name:"Production"}),e.jsx(_,{type:"monotone",dataKey:"quality",stroke:"#10B981",strokeWidth:2,name:"Quality %"}),e.jsx(_,{type:"monotone",dataKey:"efficiency",stroke:"#F59E0B",strokeWidth:2,name:"Efficiency %"})]})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{children:[e.jsxs(o,{children:[e.jsxs(x,{className:"flex items-center space-x-2",children:[e.jsx(E,{className:"h-5 w-5"}),e.jsx("span",{children:"Top Performers"})]}),e.jsxs(S,{children:["Highest performing operators this ",a]})]}),e.jsx(c,{children:e.jsx("div",{className:"space-y-4",children:Array.isArray(j)&&j.length>0?j.slice(0,5).map((t,l)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-white ${l===0?"bg-yellow-500":l===1?"bg-gray-400":l===2?"bg-amber-600":"bg-blue-500"}`,children:t.rank}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:t.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.totalPieces," pieces | ",t.qualityScore.toFixed(1),"% quality"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-bold",children:[t.efficiency.toFixed(1),"%"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["₹",t.earnings.toFixed(0)]})]})]},t.operatorId)):e.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[e.jsx(E,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No operator performance data available"})]})})})]}),e.jsxs(i,{children:[e.jsxs(o,{children:[e.jsxs(x,{className:"flex items-center space-x-2",children:[e.jsx(W,{className:"h-5 w-5"}),e.jsx("span",{children:"Work Type Analysis"})]}),e.jsx(S,{children:"Production breakdown by work type"})]}),e.jsxs(c,{children:[e.jsx("div",{className:"h-64 w-full mb-4",children:e.jsx(L,{width:"100%",height:"100%",children:e.jsxs(J,{children:[e.jsx(Z,{data:Array.isArray(m)?m:[],cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"count",children:(m||[]).map((t,l)=>e.jsx(ee,{fill:C[l%C.length]},`cell-${l}`))}),e.jsx(I,{})]})})}),e.jsx("div",{className:"space-y-2",children:(m||[]).map((t,l)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:C[l%C.length]}}),e.jsx("span",{children:t.workType})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-muted-foreground",children:[e.jsxs("span",{children:[t.count," pieces"]}),e.jsxs("span",{children:[t.qualityScore.toFixed(1),"%"]}),e.jsxs("span",{children:["₹",t.earnings.toFixed(0)]})]})]},t.workType))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(x,{className:"text-lg",children:"Quality Metrics"})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Overall Quality Score"}),e.jsxs("span",{className:"font-semibold",children:[s?.qualityScore?.toFixed(1)||"0","%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Damage Rate"}),e.jsxs("span",{className:`font-semibold ${(s?.damageRate??0)<=2?"text-green-600":(s?.damageRate??0)<=5?"text-yellow-600":"text-red-600"}`,children:[s?.damageRate?.toFixed(1)||"0","%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Rework Percentage"}),e.jsxs("span",{className:`font-semibold ${(s?.reworkPercentage??0)<=3?"text-green-600":(s?.reworkPercentage??0)<=7?"text-yellow-600":"text-red-600"}`,children:[s?.reworkPercentage?.toFixed(1)||"0","%"]})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:"Quality Grade Distribution"}),e.jsx("div",{className:"space-y-1",children:Object.entries(se).map(([t,l])=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:l.color}}),e.jsxs("span",{children:["Grade ",t]})]}),e.jsx("span",{children:"25%"})]},t))})]})]})]}),e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(x,{className:"text-lg",children:"Performance Metrics"})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Overall Efficiency"}),e.jsxs("span",{className:"font-semibold",children:[s?.efficiency?.toFixed(1)||"0","%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"On-Time Delivery"}),e.jsxs("span",{className:"font-semibold",children:[s?.onTimeDelivery?.toFixed(1)||"0","%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Average Daily Output"}),e.jsxs("span",{className:"font-semibold",children:[s?.dailyAverage?.toFixed(0)||"0"," pieces"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Completed Bundles"}),e.jsx("span",{className:"font-semibold",children:s?.completedBundles||"0"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Pending Work"}),e.jsx("span",{className:`font-semibold ${(s?.pendingWork??0)<=10?"text-green-600":(s?.pendingWork??0)<=25?"text-yellow-600":"text-red-600"}`,children:s?.pendingWork||"0"})]})]})]}),e.jsxs(i,{children:[e.jsx(o,{children:e.jsx(x,{className:"text-lg",children:"Alerts & Insights"})}),e.jsxs(c,{className:"space-y-3",children:[(s?.efficiency??0)<70&&e.jsxs("div",{className:"flex items-start space-x-2 p-3 bg-red-50 rounded-lg",children:[e.jsx(F,{className:"h-4 w-4 text-red-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Low Efficiency Alert"}),e.jsx("p",{className:"text-xs text-red-600",children:"Current efficiency is below target (70%)"})]})]}),(s?.damageRate??0)>5&&e.jsxs("div",{className:"flex items-start space-x-2 p-3 bg-yellow-50 rounded-lg",children:[e.jsx(F,{className:"h-4 w-4 text-yellow-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Quality Concern"}),e.jsx("p",{className:"text-xs text-yellow-600",children:"Damage rate is above acceptable threshold"})]})]}),(s?.onTimeDelivery??0)>=95&&e.jsxs("div",{className:"flex items-start space-x-2 p-3 bg-green-50 rounded-lg",children:[e.jsx(T,{className:"h-4 w-4 text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Excellent Delivery"}),e.jsx("p",{className:"text-xs text-green-600",children:"On-time delivery rate exceeds target"})]})]}),(s?.pendingWork??0)<=5&&e.jsxs("div",{className:"flex items-start space-x-2 p-3 bg-blue-50 rounded-lg",children:[e.jsx(T,{className:"h-4 w-4 text-blue-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-800",children:"Low Backlog"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Minimal pending work items"})]})]})]})]})]})]}):e.jsx(i,{children:e.jsxs(c,{className:"text-center py-8",children:[e.jsx(W,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Data Available"}),e.jsx("p",{className:"text-muted-foreground",children:"Production data is not available for the selected period."})]})})};export{xe as ProductionDashboard,xe as default};
