const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.B3OoR7j1.js","assets/query-vendor.DpsghfSz.js","assets/react-vendor.CfKEcsXX.js","assets/ui-vendor.D5U9TC-3.js","assets/firebase-vendor.D8xw0AXf.js","assets/utils-vendor.B0NEtgzl.js","assets/index.CZ3Rcx0c.css"])))=>i.map(i=>d[i]);
import{C as y,a as F,p as de,B as w,J as Y,A as me,n as D,I as M,D as Ee,_ as Ie}from"./index.B3OoR7j1.js";import{j as e,a as Oe,b as Le,u as xe}from"./query-vendor.DpsghfSz.js";import{r as n,u as Ae,d as Me}from"./react-vendor.CfKEcsXX.js";import{L as W}from"./LoadingSpinner.rP8tyFue.js";import{F as G,E as Fe}from"./empty-state.n-hYHaS-.js";import{S as K,M as H,a as he}from"./operator-types.IC8C56sJ.js";import{F as Q}from"./ClockIcon.B0z2Gpg3.js";import{F as se}from"./MagnifyingGlassIcon.BY4e_13K.js";import{F as Te}from"./FunnelIcon.CvqkinxJ.js";import{F as Pe}from"./PencilIcon.8W3cwjlG.js";import{F as re}from"./CalendarDaysIcon.DrGkQZXF.js";import{F as J}from"./StarIcon.WwJcLCr3.js";import{F as Ve}from"./CurrencyRupeeIcon.7xrTRvUQ.js";import{o as le,s as ie,p as $e,a as qe,$ as Be,b as ue,u as ze,c as _e,n as De,d as ne,e as A,_ as Re,l as Ue}from"./form-vendor.YPfcWTfe.js";import{IDGenerationService as U}from"./id-generation-service.DIFbM1n0.js";import{F as ce}from"./UserIcon.BzFG2rMW.js";import"./ui-vendor.D5U9TC-3.js";import"./firebase-vendor.D8xw0AXf.js";import"./utils-vendor.B0NEtgzl.js";function We({title:s,titleId:c,...l},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":c},l),s?n.createElement("title",{id:c},s):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const Qe=n.forwardRef(We);function Ze({title:s,titleId:c,...l},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":c},l),s?n.createElement("title",{id:c},s):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"}))}const pe=n.forwardRef(Ze);function Ge({title:s,titleId:c,...l},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":c},l),s?n.createElement("title",{id:c},s):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"}))}const Ke=n.forwardRef(Ge);function He({title:s,titleId:c,...l},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":c},l),s?n.createElement("title",{id:c},s):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.182 15.182a4.5 4.5 0 0 1-6.364 0M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0ZM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Z"}))}const Je=n.forwardRef(He);function Ye({title:s,titleId:c,...l},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":c},l),s?n.createElement("title",{id:c},s):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const Xe=n.forwardRef(Ye);function es({title:s,titleId:c,...l},r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":c},l),s?n.createElement("title",{id:c},s):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"}))}const ss=n.forwardRef(es),ge=({operator:s,onView:c,onEdit:l,onDelete:r,onStatusChange:o,showActions:d=!0,className:m=""})=>{const i=K[s.currentStatus]||K.offline,f=()=>{if(s.avatar)switch(s.avatar.type){case"emoji":return e.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-100 flex items-center justify-center text-2xl",children:s.avatar.value});case"photo":return e.jsx("img",{src:s.avatar.value,alt:s.name,className:"h-12 w-12 rounded-full object-cover"});case"initials":return e.jsx("div",{className:"h-12 w-12 rounded-full flex items-center justify-center text-white font-semibold",style:{backgroundColor:s.avatar.backgroundColor||"#3B82F6"},children:s.avatar.value})}const u=s.name.split(" ").map(v=>v.charAt(0)).join("").toUpperCase().slice(0,2);return e.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-400 flex items-center justify-center text-white font-semibold",children:u})};return e.jsxs(y,{className:`p-4 hover:shadow-md transition-shadow ${m}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[f(),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",s.employeeId]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(F,{variant:i.color,className:"flex items-center space-x-1",children:[e.jsx("span",{children:i.icon}),e.jsx("span",{className:"hidden sm:inline",children:i.label})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Machine"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.primaryMachine})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(de,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Efficiency"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Math.round(s.efficiency*100),"%"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(pe,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Quality"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[typeof s.qualityScore=="number"&&!isNaN(s.qualityScore)?Math.round(s.qualityScore):85,"%"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Current Work"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.currentWork||"None"})]})]})]}),d&&e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:c,className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:"View Details"}),l&&e.jsx(w,{variant:"ghost",size:"sm",onClick:l,className:"text-gray-600 hover:text-gray-700 hover:bg-gray-50",children:"Edit"}),r&&e.jsx(w,{variant:"ghost",size:"sm",onClick:r,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:"Delete"})]}),o&&e.jsx(w,{variant:"ghost",size:"sm",onClick:o,className:"text-green-600 hover:text-green-700 hover:bg-green-50",children:"Update Status"})]})]})},$={all:["operators"],lists:()=>[...$.all,"list"],list:s=>[...$.lists(),{filters:s}],details:()=>[...$.all,"detail"],detail:s=>[...$.details(),s],status:s=>[...$.all,"status",s]};function as(s){return xe({queryKey:$.lists(),queryFn:()=>Y.getOperatorsSummary(),staleTime:300*1e3,gcTime:600*1e3,...s})}function ts(s,c){return xe({queryKey:$.status(s),queryFn:()=>Y.getOperatorWithStatus(s),enabled:!!s,staleTime:30*1e3,refetchInterval:60*1e3,...c})}function rs(){const s=Oe();return Le({mutationFn:({operatorId:c,deletedBy:l})=>Y.deleteOperator(c,l),onSuccess:()=>{s.invalidateQueries({queryKey:$.all}),s.invalidateQueries({queryKey:["work-items"]}),s.invalidateQueries({queryKey:["available-work"]})},onError:c=>{console.error("Failed to delete operator:",c)}})}const ls=({onCreateNew:s,onViewOperator:c,onEditOperator:l,onDeleteOperator:r,userRole:o="operator",showActions:d=!0})=>{const[m,i]=n.useState(""),[f,u]=n.useState("all"),[v,p]=n.useState("all"),[C,b]=n.useState("all"),[I,q]=n.useState(!1),{data:T,isLoading:Z,error:E,refetch:B}=as({refetchInterval:60*1e3}),S=T?.success?T.data:[],k=n.useMemo(()=>S.filter(a=>{const x=m===""||a.name.toLowerCase().includes(m.toLowerCase())||a.employeeId.toLowerCase().includes(m.toLowerCase()),h=f==="all"||a.currentStatus===f,L=v==="all"||a.primaryMachine===v;return x&&h&&L}),[S,m,f,v]),P=n.useMemo(()=>{const a=S.length,x=S.filter(N=>N.currentStatus==="working").length,h=S.filter(N=>N.currentStatus==="idle").length,L=S.reduce((N,R)=>N+R.efficiency,0)/a||0;return{total:a,active:x,available:h,avgEfficiency:L}},[S]);return Z?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(W,{size:"lg"})}):E?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-red-600 mb-4",children:"Failed to load operators"}),e.jsx(w,{onClick:()=>B(),children:"Try Again"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Operators"}),e.jsx("p",{className:"text-gray-600",children:"Manage and monitor operator performance"})]}),s&&e.jsxs(w,{onClick:s,className:"flex items-center space-x-2",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Operator"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:P.total})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-2 w-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Working"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:P.active})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Available"})]}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:P.available})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-2 w-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Avg Efficiency"})]}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[Math.round(P.avgEfficiency*100),"%"]})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(M,{placeholder:"Search operators by name or ID...",value:m,onChange:a=>i(a.target.value),className:"pl-10"})]})}),e.jsxs(w,{variant:"ghost",onClick:()=>q(!I),className:"flex items-center space-x-2",children:[e.jsx(Te,{className:"h-4 w-4"}),e.jsx("span",{children:"Filters"}),(f!=="all"||v!=="all"||C!=="all")&&e.jsx(F,{variant:"primary",className:"ml-1",children:[f,v,C].filter(a=>a!=="all").length})]})]}),I&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:f,onChange:a=>u(a.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),Object.entries(K).map(([a,x])=>e.jsxs("option",{value:a,children:[x.icon," ",x.label]},a))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Machine Type"}),e.jsxs("select",{value:v,onChange:a=>p(a.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Machines"}),H.map(a=>e.jsxs("option",{value:a.machineType,children:[a.displayName," (",a.nepaliName,")"]},a.machineType))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Level"}),e.jsxs("select",{value:C,onChange:a=>b(a.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Levels"}),he.map(a=>e.jsxs("option",{value:a.value,children:[a.label," (",a.nepaliLabel,")"]},a.value))]})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>{u("all"),p("all"),b("all"),i("")},children:"Clear Filters"})})]})]}),e.jsx("div",{children:k.length===0?e.jsx(Fe,{icon:D,title:"No operators found",description:m||f!=="all"||v!=="all"?"Try adjusting your filters to see more operators":"Get started by adding your first operator",action:s?e.jsx(w,{onClick:s,children:"Add First Operator"}):void 0}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[k.length," of ",S.length," operators"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(a=>e.jsx(ge,{operator:a,onView:()=>c?.(a.id),onEdit:o==="supervisor"?()=>l?.(a.id):void 0,onDelete:o==="supervisor"?()=>r?.(a.id):void 0,showActions:d},a.id))})]})})]})},is=()=>{const{id:s}=Ae(),c=Me(),[l,r]=n.useState("overview"),{data:o,isLoading:d,error:m}=ts(s,{enabled:!!s});if(d)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(W,{size:"lg"})});if(m||!o?.success||!o.data)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-red-600 mb-4",children:"Operator not found"}),e.jsx(w,{onClick:()=>c("/operators"),children:"Back to Operators"})]});const i=o.data,f=i.realtimeStatus,u=K[f.status],v=()=>{if(i.avatar)switch(i.avatar.type){case"emoji":return e.jsx("div",{className:"h-20 w-20 rounded-full bg-gray-100 flex items-center justify-center text-4xl",children:i.avatar.value});case"photo":return e.jsx("img",{src:i.avatar.value,alt:i.name,className:"h-20 w-20 rounded-full object-cover"});case"initials":return e.jsx("div",{className:"h-20 w-20 rounded-full flex items-center justify-center text-white font-bold text-xl",style:{backgroundColor:i.avatar.backgroundColor||"#3B82F6"},children:i.avatar.value})}const p=i.name.split(" ").map(C=>C.charAt(0)).join("").toUpperCase().slice(0,2);return e.jsx("div",{className:"h-20 w-20 rounded-full bg-gray-400 flex items-center justify-center text-white font-bold text-xl",children:p})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(w,{variant:"ghost",onClick:()=>c("/operators"),className:"flex items-center space-x-2",children:[e.jsx(Qe,{className:"h-4 w-4"}),e.jsx("span",{children:"Back"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Operator Details"}),e.jsx("p",{className:"text-gray-600",children:"View and manage operator information"})]})]}),e.jsxs(w,{onClick:()=>c(`/operators/${s}/edit`),className:"flex items-center space-x-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx("span",{children:"Edit"})]})]}),e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-6",children:[v(),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:i.name}),e.jsxs(F,{variant:u?.color,className:"flex items-center space-x-1",children:[e.jsx("span",{children:u?.icon}),e.jsx("span",{children:u?.label})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Employee ID"}),e.jsx("p",{className:"font-medium text-gray-900",children:i.employeeId})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Username"}),e.jsx("p",{className:"font-medium text-gray-900",children:i.username})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Primary Machine"}),e.jsx("p",{className:"font-medium text-gray-900",children:i.primaryMachine})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Skill Level"}),e.jsx("p",{className:"font-medium text-gray-900 capitalize",children:i.skillLevel})]})]})]})]})}),e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Current Status"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`h-3 w-3 rounded-full ${u?.color==="green"?"bg-green-500":u?.color==="yellow"?"bg-yellow-500":u?.color==="blue"?"bg-blue-500":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Status"}),e.jsx("p",{className:"font-medium text-gray-900",children:u?.label})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Q,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Current Work"}),e.jsx("p",{className:"font-medium text-gray-900",children:f.currentWork||"None"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(G,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Machine Status"}),e.jsx("p",{className:"font-medium text-gray-900 capitalize",children:f.machineStatus})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(re,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Last Activity"}),e.jsx("p",{className:"font-medium text-gray-900",children:new Date(f.lastActivity).toLocaleTimeString()})]})]})]})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{key:"overview",label:"Overview"},{key:"performance",label:"Performance"},{key:"activity",label:"Activity"}].map(p=>e.jsx("button",{onClick:()=>r(p.key),className:`py-2 px-1 border-b-2 font-medium text-sm ${l===p.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:p.label},p.key))})}),l==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"space-y-4",children:[i.email&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ke,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Email"}),e.jsx("p",{className:"font-medium text-gray-900",children:i.email})]})]}),i.phone&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ss,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Phone"}),e.jsx("p",{className:"font-medium text-gray-900",children:i.phone})]})]}),i.address&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Xe,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Address"}),e.jsx("p",{className:"font-medium text-gray-900",children:i.address})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(re,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Hired Date"}),e.jsx("p",{className:"font-medium text-gray-900",children:new Date(i.hiredDate).toLocaleDateString()})]})]})]})]}),e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Work Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(G,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Machine Types"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:i.machineTypes?.map(p=>{const C=H.find(b=>b.machineType===p);return e.jsx(F,{variant:"secondary",children:C?.displayName||p},p)})})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(J,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Specializations"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:i.specializations?.map(p=>e.jsx(F,{variant:"outline",children:p},p))||e.jsx("p",{className:"text-gray-400 text-sm",children:"None specified"})})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Q,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Shift"}),e.jsx("p",{className:"font-medium text-gray-900 capitalize",children:i.shift})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-5 w-5 text-gray-400 flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold",children:"#"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Max Concurrent Work"}),e.jsx("p",{className:"font-medium text-gray-900",children:i.maxConcurrentWork})]})]})]})]})]}),l==="performance"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(y,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(de,{className:"h-6 w-6 text-yellow-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Efficiency"})]}),e.jsxs("p",{className:"text-3xl font-bold text-yellow-600",children:[Math.round(i.averageEfficiency*100),"%"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Average performance"})]}),e.jsxs(y,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(pe,{className:"h-6 w-6 text-green-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Quality"})]}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[Math.round(i.qualityScore*100),"%"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Quality score"})]}),e.jsxs(y,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("div",{className:"h-6 w-6 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-bold",children:"B"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Bundles"})]}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:i.completedBundles}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Completed"})]}),e.jsxs(y,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(Ve,{className:"h-6 w-6 text-purple-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Earnings"})]}),e.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:["₹",i.totalEarnings?.toLocaleString()||0]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Total earned"})]})]}),l==="activity"&&e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Q,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Activity log will be displayed here"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Feature coming soon"})]})]})]})};function oe(s,c){try{var l=s()}catch(r){return c(r)}return l&&l.then?l.then(void 0,c):l}function ns(s,c){for(var l={};s.length;){var r=s[0],o=r.code,d=r.message,m=r.path.join(".");if(!l[m])if("unionErrors"in r){var i=r.unionErrors[0].errors[0];l[m]={message:i.message,type:i.code}}else l[m]={message:d,type:o};if("unionErrors"in r&&r.unionErrors.forEach(function(v){return v.errors.forEach(function(p){return s.push(p)})}),c){var f=l[m].types,u=f&&f[r.code];l[m]=ue(m,c,l,o,u?[].concat(u,r.message):r.message)}s.shift()}return l}function cs(s,c){for(var l={};s.length;){var r=s[0],o=r.code,d=r.message,m=r.path.join(".");if(!l[m])if(r.code==="invalid_union"&&r.errors.length>0){var i=r.errors[0][0];l[m]={message:i.message,type:i.code}}else l[m]={message:d,type:o};if(r.code==="invalid_union"&&r.errors.forEach(function(v){return v.forEach(function(p){return s.push(p)})}),c){var f=l[m].types,u=f&&f[r.code];l[m]=ue(m,c,l,o,u?[].concat(u,r.message):r.message)}s.shift()}return l}function os(s,c,l){if(l===void 0&&(l={}),(function(r){return"_def"in r&&typeof r._def=="object"&&"typeName"in r._def})(s))return function(r,o,d){try{return Promise.resolve(oe(function(){return Promise.resolve(s[l.mode==="sync"?"parse":"parseAsync"](r,c)).then(function(m){return d.shouldUseNativeValidation&&le({},d),{errors:{},values:l.raw?Object.assign({},r):m}})},function(m){if((function(i){return Array.isArray(i?.issues)})(m))return{values:{},errors:ie(ns(m.errors,!d.shouldUseNativeValidation&&d.criteriaMode==="all"),d)};throw m}))}catch(m){return Promise.reject(m)}};if((function(r){return"_zod"in r&&typeof r._zod=="object"})(s))return function(r,o,d){try{return Promise.resolve(oe(function(){return Promise.resolve((l.mode==="sync"?$e:qe)(s,r,c)).then(function(m){return d.shouldUseNativeValidation&&le({},d),{errors:{},values:l.raw?Object.assign({},r):m}})},function(m){if((function(i){return i instanceof Be})(m))return{values:{},errors:ie(cs(m.issues,!d.shouldUseNativeValidation&&d.criteriaMode==="all"),d)};throw m}))}catch(m){return Promise.reject(m)}};throw new Error("Invalid input: not a Zod schema")}const ds=s=>_e({username:A().min(3,"Username must be at least 3 characters"),password:s==="create"?A().min(6,"Password must be at least 6 characters"):A().optional(),name:A().min(2,"Full Name must be at least 2 characters"),employeeId:A().min(1,"Employee ID is required"),email:A().email("Invalid email format").optional().or(Ue("")),phone:A().optional(),address:A().optional(),primaryMachine:A().min(1,"Primary machine selection is required"),machineTypes:ne(A()).min(1,"At least one machine type must be selected"),skillLevel:Re(["beginner","intermediate","advanced","expert"],{required_error:"Skill level selection is required"}),specializations:ne(A()).optional(),maxConcurrentWork:De().min(1,"Must be at least 1").max(10,"Cannot exceed 10")}),ms=["👨‍💼","👩‍💼","👨‍🔧","👩‍🔧","👨‍🏭","👩‍🏭","🧑‍💻","👨‍💻","👩‍💻","🥷","👤","🔧"],ee=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#F97316","#06B6D4","#84CC16"],xs=[{value:"stitching",label:"Stitching",nepaliLabel:"सिलाई"},{value:"hemming",label:"Hemming",nepaliLabel:"हेमिंग"},{value:"buttonhole_making",label:"Buttonhole Making",nepaliLabel:"बटनहोल बनाउने"},{value:"button_attaching",label:"Button Attaching",nepaliLabel:"बटन जोड्ने"},{value:"zipper_insertion",label:"Zipper Insertion",nepaliLabel:"जिपर लगाउने"},{value:"seam_finishing",label:"Seam Finishing",nepaliLabel:"सिम फिनिशिंग"},{value:"edge_stitching",label:"Edge Stitching",nepaliLabel:"किनारा सिलाई"},{value:"topstitching",label:"Topstitching",nepaliLabel:"टपस्टिचिंग"},{value:"blind_hemming",label:"Blind Hemming",nepaliLabel:"अन्धा हेमिंग"},{value:"overlock_stitching",label:"Overlock Stitching",nepaliLabel:"ओभरलक सिलाई"},{value:"flatlock_stitching",label:"Flatlock Stitching",nepaliLabel:"फ्ल्यालक सिलाई"},{value:"coverstitch",label:"Coverstitch",nepaliLabel:"कभरस्टिच"},{value:"binding",label:"Binding",nepaliLabel:"बाइन्डिंग"},{value:"piping",label:"Piping",nepaliLabel:"पाइपिंग"},{value:"pleating",label:"Pleating",nepaliLabel:"प्लिटिंग"},{value:"gathering",label:"Gathering",nepaliLabel:"ग्याद्रिंग"},{value:"smocking",label:"Smocking",nepaliLabel:"स्मकिंग"},{value:"applique",label:"Applique",nepaliLabel:"एप्लिक"},{value:"embroidery",label:"Embroidery",nepaliLabel:"कसिदाकारी"},{value:"quality_inspection",label:"Quality Inspection",nepaliLabel:"गुणस्तर जाँच"},{value:"pattern_matching",label:"Pattern Matching",nepaliLabel:"नमुना मिलान"},{value:"pressing",label:"Pressing",nepaliLabel:"प्रेसिंग"},{value:"cutting",label:"Cutting",nepaliLabel:"काट्ने"},{value:"marking",label:"Marking",nepaliLabel:"चिन्ह लगाउने"},{value:"packaging",label:"Packaging",nepaliLabel:"प्याकेजिंग"}],hs=({initialData:s,onSubmit:c,onCancel:l,isLoading:r=!1,mode:o})=>{const[d,m]=n.useState(null),[i,f]=n.useState(""),[u,v]=n.useState(!1),[p,C]=n.useState(""),[b,I]=n.useState(null),[q,T]=n.useState(!1),[Z,E]=n.useState(null),[B,S]=n.useState(!1),{register:k,handleSubmit:P,watch:a,setValue:x,formState:{errors:h,isValid:L}}=ze({resolver:os(ds(o)),defaultValues:{username:s?.username||"",password:"",name:s?.name||"",employeeId:s?.employeeId||"",email:s?.email||"",phone:s?.phone||"",address:s?.address||"",primaryMachine:s?.primaryMachine||"",machineTypes:s?.machineTypes||[],skillLevel:s?.skillLevel||"beginner",specializations:s?.specializations||[],maxConcurrentWork:s?.maxConcurrentWork||1}}),N=a(),R=a("machineTypes")||[],_=a("specializations")||[];n.useEffect(()=>{s?.avatar&&m({type:s.avatar.type,value:s.avatar.value,backgroundColor:s.avatar.backgroundColor||"#3B82F6",label:s.avatar.type==="emoji"||s.avatar.type==="initials"?s.avatar.value:"Photo"})},[s]);const fe=t=>{const g=t.split(" ").map(j=>j.charAt(0)).join("").toUpperCase().slice(0,2);return{type:"initials",value:g,backgroundColor:ee[Math.floor(Math.random()*ee.length)],label:g}};n.useEffect(()=>{N.name&&!d&&o==="create"&&m(fe(N.name))},[N.name,d,o]),n.useEffect(()=>{(async()=>{if(o==="create"&&!s?.employeeId)try{v(!0);const g=await U.generateUniqueEmployeeIdSuggestion();C(g),x("employeeId",g)}catch(g){console.error("Failed to generate Employee ID:",g);const O=`TSA-EMP-${Date.now().toString().slice(-4)}`;C(O),x("employeeId",O)}finally{v(!1)}})()},[o,s?.employeeId,x]);const je=async()=>{try{v(!0);const t=await U.generateUniqueEmployeeIdSuggestion();C(t),x("employeeId",t)}catch(t){console.error("Failed to regenerate Employee ID:",t);const j=`TSA-EMP-${Date.now().toString().slice(-4)}`;C(j),x("employeeId",j)}finally{v(!1)}},ve=async t=>{if(!t){I(null);return}try{T(!0);const g=U.validateEmployeeIdFormat(t);if(!g.valid){I({isValid:!1,message:g.message,suggestion:'Click "Generate Unique ID" for correct format'});return}if(o==="edit"&&s?.employeeId===t){I({isValid:!0,message:"Current Employee ID"});return}if(!await U.isEmployeeIdUnique(t)){const O=await U.generateUniqueEmployeeIdSuggestion();I({isValid:!1,message:"❌ This Employee ID already exists!",suggestion:`Suggested: ${O}`,suggestedId:O});return}I({isValid:!0,message:"✅ Employee ID is available"})}catch(g){console.error("Failed to validate Employee ID:",g),I({isValid:!1,message:"⚠️ Failed to validate ID - please try again",suggestion:"Check your network connection"})}finally{T(!1)}},ye=t=>{x("employeeId",t),C(t),I({isValid:!0,message:"✅ Using suggested unique ID"})};n.useEffect(()=>{if(o==="edit"&&N.employeeId){const t=setTimeout(()=>{ve(N.employeeId)},500);return()=>clearTimeout(t)}},[N.employeeId,o]),n.useEffect(()=>{o==="create"&&p&&I({isValid:!0,message:"Auto-generated ID"})},[p,o]);const be=t=>{const g=R,j=g.includes(t)?g.filter(O=>O!==t):[...g,t];x("machineTypes",j,{shouldValidate:!0})},ae=()=>{i.trim()&&(x("specializations",[..._,i.trim()]),f(""))},Ne=t=>{x("specializations",_.filter((j,O)=>O!==t))},we=async(t,g)=>{try{if(!L){g?.preventDefault();const V=Object.keys(h);if(V.length>0){const X=V[0],te=document.querySelector(`[name="${X}"]`)||document.querySelector(`input[name="${X}"]`)||document.querySelector(`select[name="${X}"]`);te&&te.scrollIntoView({behavior:"smooth",block:"center"});const Se=Object.entries(h).map(([z,Ce])=>`• ${z==="primaryMachine"?"Primary Machine":z==="machineTypes"?"Machine Types":z==="skillLevel"?"Skill Level":z==="maxConcurrentWork"?"Max Concurrent Work":z==="employeeId"?"Employee ID":z.charAt(0).toUpperCase()+z.slice(1)}: ${Ce?.message||"Required"}`).join(`
`);alert(`Please fix the following required fields:

${Se}`);return}}const j={...t,hiredDate:new Date,shift:"morning",specializations:t.specializations?.filter(V=>V.trim())||[]};if(t.email&&t.email.trim()&&(j.email=t.email.trim()),t.phone&&t.phone.trim()&&(j.phone=t.phone.trim()),t.address&&t.address.trim()&&(j.address=t.address.trim()),d)j.avatar={type:d.type,value:d.value,backgroundColor:d.backgroundColor||"#3B82F6"};else{const V=(t.name||t.username||"OP").slice(0,2).toUpperCase();j.avatar={type:"initials",value:V,backgroundColor:"#3B82F6"}}o==="create"&&p&&(j.employeeId=p),await c(j)}catch(j){console.error("Form submission error:",j),alert("Failed to create operator. Please check all required fields and try again.")}},ke=()=>{if(!d)return null;switch(d.type){case"emoji":return e.jsx("div",{className:"h-16 w-16 rounded-full bg-gray-100 flex items-center justify-center text-3xl",children:d.value});case"initials":return e.jsx("div",{className:"h-16 w-16 rounded-full flex items-center justify-center text-white font-bold text-xl",style:{backgroundColor:d.backgroundColor},children:d.value});case"photo":return e.jsx("img",{src:d.value,alt:"Avatar",className:"h-16 w-16 rounded-full object-cover"})}};return e.jsxs("form",{onSubmit:P(we),className:"space-y-6",children:[e.jsxs(y,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center space-x-2",children:[e.jsx(ce,{className:"h-5 w-5"}),e.jsx("span",{children:"Basic Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username *"}),e.jsx(M,{...k("username"),placeholder:"Enter username",className:h.username?"border-red-500":""}),h.username&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.username.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),e.jsx(M,{...k("password"),type:"password",placeholder:o==="edit"?"Enter new password (leave blank to keep current)":"Enter password",className:h.password?"border-red-500":""}),h.password&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.password.message}),o==="edit"&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to keep current password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),e.jsx(M,{...k("name"),placeholder:"Enter full name",className:h.name?"border-red-500":""}),h.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.name.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Employee ID *",o==="create"&&e.jsx("span",{className:"ml-2 text-xs text-blue-600",children:"(Auto-generated)"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(M,{...k("employeeId"),placeholder:o==="create"?"Auto-generating...":"Enter employee ID",className:`w-full ${h.employeeId||b?.isValid===!1?"border-red-500":b?.isValid===!0?"border-green-500":""} ${o==="create"?"bg-gray-50":""}`,readOnly:o==="create",value:o==="create"?p:void 0}),q&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(W,{size:"xs"})}),!q&&b?.isValid===!0&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-500",children:"✓"}),!q&&b?.isValid===!1&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-red-500",children:"✗"})]}),o==="create"&&e.jsx(w,{type:"button",variant:"outline",onClick:je,disabled:u,className:"px-3 py-2 min-w-[120px]",children:u?e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(W,{size:"xs"}),e.jsx("span",{children:"Generating..."})]}):"Generate Unique ID"})]}),h.employeeId&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.employeeId.message}),b?.message&&e.jsxs("div",{className:`text-sm mt-1 ${b.isValid?"text-green-600":"text-red-500"}`,children:[e.jsx("p",{children:b.message}),b.suggestion&&e.jsxs("div",{className:"mt-1 flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-600",children:b.suggestion}),b.suggestedId&&e.jsx(w,{type:"button",size:"sm",variant:"outline",onClick:()=>ye(b.suggestedId),className:"text-xs px-2 py-1 h-6",children:"Use This"})]})]}),o==="create"&&p&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["Next ID: ",e.jsx("span",{className:"font-mono font-medium",children:p})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx(M,{...k("email"),type:"email",placeholder:"Enter email address",className:h.email?"border-red-500":""}),h.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx(M,{...k("phone"),placeholder:"Enter phone number"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx(M,{...k("address"),placeholder:"Enter full address"})]})]}),e.jsxs(y,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center space-x-2",children:[e.jsx(Je,{className:"h-5 w-5"}),e.jsx("span",{children:"Avatar"})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"Preview"}),ke()||e.jsx("div",{className:"h-16 w-16 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx(ce,{className:"h-8 w-8 text-gray-400"})})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Choose Emoji"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ms.map((t,g)=>e.jsx("button",{type:"button",onClick:()=>m({type:"emoji",value:t,label:t}),className:`p-2 rounded-lg border text-2xl hover:bg-gray-50 ${d?.type==="emoji"&&d?.value===t?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:t},g))})]}),N.name&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Or Use Initials"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ee.map((t,g)=>{const j=N.name.split(" ").map(O=>O.charAt(0)).join("").toUpperCase().slice(0,2);return e.jsx("button",{type:"button",onClick:()=>m({type:"initials",value:j,backgroundColor:t,label:j}),className:`h-12 w-12 rounded-full flex items-center justify-center text-white font-semibold border-2 ${d?.type==="initials"&&d?.backgroundColor===t?"border-gray-800":"border-transparent"}`,style:{backgroundColor:t},children:j},g)})})]})]})})]})]}),e.jsxs(y,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center space-x-2",children:[e.jsx(G,{className:"h-5 w-5"}),e.jsx("span",{children:"Work Information"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Machine Types * (Select all applicable)"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:H.map(t=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:R.includes(t.machineType),onChange:()=>be(t.machineType),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[t.displayName,e.jsxs("span",{className:"text-gray-500 ml-1",children:["(",t.nepaliName,")"]})]})]},t.machineType))}),h.machineTypes&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.machineTypes.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Machine *"}),e.jsxs("select",{...k("primaryMachine"),className:`w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${h.primaryMachine?"border-red-500":""}`,children:[e.jsx("option",{value:"",children:"Select primary machine"}),H.filter(t=>R.includes(t.machineType)).map(t=>e.jsxs("option",{value:t.machineType,children:[t.displayName," (",t.nepaliName,")"]},t.machineType))]}),h.primaryMachine&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.primaryMachine.message})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Level *"}),e.jsx("select",{...k("skillLevel"),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:he.map(t=>e.jsxs("option",{value:t.value,children:[t.label," (",t.nepaliLabel,")"]},t.value))})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Concurrent Work *"}),e.jsx(M,{...k("maxConcurrentWork",{valueAsNumber:!0}),type:"number",min:"1",max:"10",placeholder:"Maximum concurrent work items",className:h.maxConcurrentWork?"border-red-500":""}),h.maxConcurrentWork&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.maxConcurrentWork.message})]})]})]}),e.jsxs(y,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center space-x-2",children:[e.jsx(J,{className:"h-5 w-5"}),e.jsx("span",{children:"Specializations"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Available Operations (Select multiple)"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-3",children:xs.map(t=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"checkbox",checked:_.includes(t.value),onChange:g=>{const j=_,O=g.target.checked?[...j,t.value]:j.filter(V=>V!==t.value);x("specializations",O)},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.label}),e.jsx("div",{className:"text-xs text-gray-500",children:t.nepaliLabel})]})]},t.value))})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(M,{value:i,onChange:t=>f(t.target.value),placeholder:"Add custom specialization...",onKeyPress:t=>t.key==="Enter"&&(t.preventDefault(),ae())}),e.jsx(w,{type:"button",onClick:ae,variant:"secondary",disabled:!i.trim(),children:"Add Custom"})]}),_.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:_.map((t,g)=>e.jsxs(F,{variant:"outline",className:"flex items-center space-x-2",children:[e.jsx("span",{children:t}),e.jsx("button",{type:"button",onClick:()=>Ne(g),className:"text-gray-400 hover:text-gray-600",children:"×"})]},g))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[e.jsx(w,{type:"button",variant:"ghost",onClick:l,disabled:r,children:"Cancel"}),e.jsxs(w,{type:"submit",disabled:r,className:"flex items-center space-x-2",children:[r&&e.jsx(W,{size:"sm"}),e.jsx("span",{children:o==="create"?"Create Operator":"Update Operator"})]})]})]})},Ts=({userRole:s="supervisor"})=>{const[c,l]=n.useState("overview"),[r,o]=n.useState(""),[d,m]=n.useState(""),[i,f]=n.useState(0),[u,v]=n.useState([]),[p,C]=n.useState(!0),[b,I]=n.useState(null),q=rs();n.useEffect(()=>{T()},[i]);const T=async()=>{try{C(!0),I(null);const a=await Y.getAllOperators();a.success?v(Ee(a.data)):(I(a.error||"Failed to load operators"),v([]))}catch(a){I("Error loading operators"),v([]),console.error("Error loading operators:",a)}finally{C(!1)}},Z=async a=>{if(s!=="supervisor"){alert("You do not have permission to delete operators.");return}if(window.confirm("Are you sure you want to delete this operator? This action cannot be undone."))try{await q.mutateAsync({operatorId:a,deletedBy:s}),alert("✅ Operator deleted successfully!"),f(h=>h+1),r===a&&(o(""),l("overview"))}catch(h){console.error("Error deleting operator:",h),alert("Failed to delete operator. Please try again.")}},E=u.filter(a=>a!=null).map(a=>({id:a.id||"",name:a.name||"Unknown",employeeId:a.employeeId||"N/A",skills:a.machineTypes||[],efficiency:typeof a.averageEfficiency=="number"?a.averageEfficiency:0,qualityScore:typeof a.qualityScore=="number"?a.qualityScore:85,activeAssignments:a.currentAssignments?.length||0,completedToday:Math.floor(Math.random()*5),status:a.isActive?a.availabilityStatus==="available"?"Active":a.availabilityStatus==="working"?"Working":a.availabilityStatus==="break"?"On Break":"Available":"Offline",avatar:a.avatar?a.avatar:null,joinDate:a.createdAt?.toDate?a.createdAt.toDate():new Date,machineType:a.primaryMachine||"Not Set"})),B=E.slice(0,5),S={totalOperators:u.length,activeOperators:E.filter(a=>["Active","Working","Available"].includes(a.status)).length,onBreakOperators:E.filter(a=>a.status==="On Break").length,offlineOperators:E.filter(a=>a.status==="Offline").length,averageEfficiency:u.length>0?Math.round(E.reduce((a,x)=>a+x.efficiency,0)/u.length):0,averageQuality:u.length>0?Math.round(E.reduce((a,x)=>a+x.qualityScore,0)/u.length):0,topPerformer:E.length>0?E.reduce((a,x)=>x.efficiency>a.efficiency?x:a,E[0]).name:"N/A",completedToday:E.reduce((a,x)=>a+x.completedToday,0),attendanceRate:Math.round((E.length-E.filter(a=>a.status==="Offline").length)/Math.max(E.length,1)*100)},k=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(D,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Operators"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:S.totalOperators})]})]})}),e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(Q,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Now"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:S.activeOperators})]})]})}),e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:e.jsx(J,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Avg Efficiency"}),e.jsxs("p",{className:"text-2xl font-bold text-yellow-600",children:[S.averageEfficiency,"%"]})]})]})}),e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(J,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Top Performer"}),e.jsx("p",{className:"text-lg font-bold text-purple-600",children:S.topPerformer})]})]})})]}),e.jsxs(y,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Operator Management"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(M,{placeholder:"Search operators...",value:d,onChange:a=>m(a.target.value),className:"pl-10 w-64"})]}),e.jsxs(w,{onClick:()=>l("form"),className:"flex items-center space-x-2",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Operator"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[B.filter(a=>a.name.toLowerCase().includes(d.toLowerCase())||a.employeeId.toLowerCase().includes(d.toLowerCase())||a.skills.some(x=>x.toLowerCase().includes(d.toLowerCase()))).map(a=>e.jsx(ge,{operator:a,onView:()=>{o(a.id),l("detail")},onEdit:()=>{o(a.id),l("form")},showActions:s==="supervisor"},a.id)),B.filter(a=>{if(!d)return!1;const x=d.toLowerCase();return!((a.name||"").toLowerCase().includes(x)||(a.employeeId||"").toLowerCase().includes(x)||(a.skills||[]).some(h=>(h||"").toLowerCase().includes(x)))}).length===B.length&&d&&B.length>0&&e.jsxs("div",{className:"col-span-full text-center py-8 text-gray-500",children:[e.jsx(se,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsxs("p",{children:['No operators found matching "',d,'"']})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Operator Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Active"})]}),e.jsx("span",{className:"text-sm font-medium",children:S.activeOperators})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"On Break"})]}),e.jsx("span",{className:"text-sm font-medium",children:S.onBreakOperators})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Offline"})]}),e.jsx("span",{className:"text-sm font-medium",children:S.offlineOperators})]})]})]}),e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Skills"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Sewing"}),e.jsx(F,{variant:"secondary",children:"45 operators"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Cutting"}),e.jsx(F,{variant:"secondary",children:"32 operators"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Finishing"}),e.jsx(F,{variant:"secondary",children:"28 operators"})]})]})]}),e.jsxs(y,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Metrics"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Avg Completion Rate"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:"92.4%"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Quality Score"}),e.jsx("span",{className:"text-sm font-medium text-blue-600",children:"89.7%"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Attendance Rate"}),e.jsx("span",{className:"text-sm font-medium text-purple-600",children:"96.1%"})]})]})]})]})]}),P=()=>{switch(c){case"overview":return k();case"list":return e.jsx(ls,{onViewOperator:x=>{o(x),l("detail")},onEditOperator:s==="supervisor"?x=>{o(x),l("form")}:void 0,onDeleteOperator:s==="supervisor"?Z:void 0,onCreateNew:s==="supervisor"?()=>{o(""),l("form")}:void 0,userRole:s,showActions:!0},i);case"detail":return r?e.jsx(is,{operatorId:r,onEdit:()=>l("form"),onBack:()=>l("overview")}):k();case"form":const a=r?u.find(x=>x.id===r):void 0;return e.jsx(hs,{mode:r?"edit":"create",initialData:a,onSubmit:async x=>{console.log("Operator data submitted:",x);try{const{operatorService:h}=await Ie(async()=>{const{operatorService:L}=await import("./index.B3OoR7j1.js").then(N=>N.P);return{operatorService:L}},__vite__mapDeps([0,1,2,3,4,5,6]));if(r){const L=await h.updateOperator(r,x);L.success?(alert("✅ Operator updated successfully!"),f(N=>N+1),l("overview"),o("")):alert(`❌ Failed to update operator: ${L.error}`)}else{const L=await h.createOperator(x);L.success?(alert("✅ Operator created successfully!"),f(N=>N+1),l("overview"),o("")):alert(`❌ Failed to create operator: ${L.error}`)}}catch(h){console.error("Error saving operator:",h),alert("❌ An unexpected error occurred. Please try again.")}},onCancel:()=>{l("overview"),o("")},isLoading:!1});default:return k()}};return p?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(D,{className:"h-8 w-8 text-blue-600"}),e.jsx("span",{children:"Operator Management"})]}),e.jsx("p",{className:"text-gray-600",children:"Loading operators..."})]})}),e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-600 border-t-transparent"})})]}):b?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(D,{className:"h-8 w-8 text-blue-600"}),e.jsx("span",{children:"Operator Management"})]}),e.jsxs("p",{className:"text-red-600",children:["Error: ",b]})]})}),e.jsxs(y,{className:"p-6 text-center",children:[e.jsx("p",{className:"text-red-600 mb-4",children:b}),e.jsx(w,{onClick:T,children:"Retry"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(D,{className:"h-8 w-8 text-blue-600"}),e.jsx("span",{children:"Operator Management"})]}),e.jsxs("p",{className:"text-gray-600",children:["Manage operators, skills, and performance (",u.length," total)"]})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>l("overview"),className:`py-2 px-1 border-b-2 font-medium text-sm ${c==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Overview"}),e.jsx("button",{onClick:()=>l("list"),className:`py-2 px-1 border-b-2 font-medium text-sm ${c==="list"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"All Operators"}),r&&e.jsx("button",{onClick:()=>l("detail"),className:`py-2 px-1 border-b-2 font-medium text-sm ${c==="detail"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Operator Details"}),s==="supervisor"&&e.jsx("button",{onClick:()=>l("form"),className:`py-2 px-1 border-b-2 font-medium text-sm ${c==="form"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:r?"Edit Operator":"Add Operator"})]})}),P()]})};export{Ts as OperatorManagementDashboard,Ts as default};
