import{j as e}from"./query-vendor.DpsghfSz.js";import{r as d}from"./react-vendor.CfKEcsXX.js";import{C as j,F as f,a as N,B as v,q as R}from"./index.CLAiwwTT.js";import{L as W}from"./LoadingSpinner.1kukr6Vo.js";import{F as y}from"./UserIcon.BzFG2rMW.js";import{F as w}from"./PlayIcon.C6pbtimh.js";import{F as B}from"./HashtagIcon.BDWlCnOX.js";import"./ui-vendor.EZF4ucWh.js";import"./firebase-vendor.D8xw0AXf.js";import"./utils-vendor.B0NEtgzl.js";function E({title:h,titleId:u,...p},x){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:x,"aria-labelledby":u},p),h?d.createElement("title",{id:u},h):null,d.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"}))}const P=d.forwardRef(E);function F({title:h,titleId:u,...p},x){return d.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:x,"aria-labelledby":u},p),h?d.createElement("title",{id:u},h):null,d.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const M=d.forwardRef(F),ee=({userRole:h})=>{const[u,p]=d.useState([]),[x,b]=d.useState([]),[k,_]=d.useState(!0),[z,H]=d.useState(null),[q,S]=d.useState({});d.useEffect(()=>{D()},[]);const D=async()=>{_(!0),await new Promise(i=>setTimeout(i,1e3));const t=[{id:"bundle_1",bundleNumber:"BND-3233-M-001",articleNumber:"3233",articleStyle:"Adult T-Shirt",priority:"high",totalPieces:25,currentStage:1,overallProgress:30,estimatedCompletionTime:new Date(Date.now()+480*60*1e3),actualStartTime:new Date(Date.now()-7200*1e3),operations:[{id:"op_1_cutting",name:"Pattern Cutting",nameNepali:"à¤¢à¤¾à¤à¤šà¤¾ à¤•à¤¾à¤Ÿà¥à¤¨à¥‡",sequenceOrder:1,machineType:"cutting",requiredSkill:"cutting",timePerPiece:2,pricePerPiece:1.5,status:"completed",prerequisites:[],dependents:["op_2_shoulder","op_3_side_seam"],assignedTo:"op_cutter_1",assignedOperatorName:"Cutting Operator",startedAt:new Date(Date.now()-7200*1e3),completedAt:new Date(Date.now()-5400*1e3),estimatedDuration:50,actualDuration:48},{id:"op_2_shoulder",name:"Shoulder Join",nameNepali:"à¤•à¤¾à¤à¤§ à¤œà¥‹à¤¡à¥à¤¨à¥‡",sequenceOrder:2,machineType:"overlock",requiredSkill:"shoulder_join",timePerPiece:4.5,pricePerPiece:2.8,status:"in_progress",prerequisites:["op_1_cutting"],dependents:["op_4_sleeve","op_5_collar"],assignedTo:"op_maya",assignedOperatorName:"Maya Patel",startedAt:new Date(Date.now()-3600*1e3),estimatedDuration:112},{id:"op_3_side_seam",name:"Side Seam",nameNepali:"à¤›à¥‡à¤‰ à¤¸à¤¿à¤²à¤¾à¤ˆ",sequenceOrder:3,machineType:"overlock",requiredSkill:"side_seam",timePerPiece:5,pricePerPiece:3.2,status:"available",prerequisites:["op_1_cutting"],dependents:["op_6_hem"],estimatedDuration:125},{id:"op_4_sleeve",name:"Sleeve Attach",nameNepali:"à¤†à¤¸à¥à¤¤à¥€à¤¨ à¤²à¤—à¤¾à¤‰à¤¨à¥‡",sequenceOrder:4,machineType:"singleNeedle",requiredSkill:"sleeve_attach",timePerPiece:7,pricePerPiece:4.5,status:"locked",prerequisites:["op_2_shoulder"],dependents:["op_7_quality"],estimatedDuration:175},{id:"op_5_collar",name:"Collar Attach",nameNepali:"à¤•à¤²à¤° à¤²à¤—à¤¾à¤‰à¤¨à¥‡",sequenceOrder:5,machineType:"singleNeedle",requiredSkill:"collar_attach",timePerPiece:6.2,pricePerPiece:4,status:"locked",prerequisites:["op_2_shoulder"],dependents:["op_7_quality"],estimatedDuration:155},{id:"op_6_hem",name:"Hem Finish",nameNepali:"à¤¹à¥‡à¤® à¤¸à¤®à¤¾à¤ªà¥à¤¤",sequenceOrder:6,machineType:"singleNeedle",requiredSkill:"hem_finish",timePerPiece:3.8,pricePerPiece:2.5,status:"locked",prerequisites:["op_3_side_seam"],dependents:["op_7_quality"],estimatedDuration:95},{id:"op_7_quality",name:"Quality Check",nameNepali:"à¤—à¥à¤£à¤¸à¥à¤¤à¤° à¤œà¤¾à¤à¤š",sequenceOrder:7,machineType:"manual",requiredSkill:"quality_check",timePerPiece:2.5,pricePerPiece:1.8,status:"locked",prerequisites:["op_4_sleeve","op_5_collar","op_6_hem"],dependents:[],estimatedDuration:62}]},{id:"bundle_2",bundleNumber:"BND-3265-L-002",articleNumber:"3265",articleStyle:"Ladies Blouse",priority:"normal",totalPieces:22,currentStage:0,overallProgress:100,estimatedCompletionTime:new Date(Date.now()+360*60*1e3),operations:[{id:"op2_1_cutting",name:"Pattern Cutting",nameNepali:"à¤¢à¤¾à¤à¤šà¤¾ à¤•à¤¾à¤Ÿà¥à¤¨à¥‡",sequenceOrder:1,machineType:"cutting",requiredSkill:"cutting",timePerPiece:2.2,pricePerPiece:1.5,status:"completed",prerequisites:[],dependents:["op2_2_shoulder","op2_3_dart"],completedAt:new Date(Date.now()-1800*1e3),estimatedDuration:48,actualDuration:45},{id:"op2_2_shoulder",name:"Shoulder Join",nameNepali:"à¤•à¤¾à¤à¤§ à¤œà¥‹à¤¡à¥à¤¨à¥‡",sequenceOrder:2,machineType:"overlock",requiredSkill:"shoulder_join",timePerPiece:4.2,pricePerPiece:2.6,status:"available",prerequisites:["op2_1_cutting"],dependents:["op2_4_sleeve"],estimatedDuration:92},{id:"op2_3_dart",name:"Dart Sewing",nameNepali:"à¤¡à¤¾à¤°à¥à¤Ÿ à¤¸à¤¿à¤²à¤¾à¤ˆ",sequenceOrder:3,machineType:"singleNeedle",requiredSkill:"dart_sewing",timePerPiece:3.5,pricePerPiece:2.2,status:"available",prerequisites:["op2_1_cutting"],dependents:["op2_4_sleeve"],estimatedDuration:77},{id:"op2_4_sleeve",name:"Sleeve Attach",nameNepali:"à¤†à¤¸à¥à¤¤à¥€à¤¨ à¤²à¤—à¤¾à¤‰à¤¨à¥‡",sequenceOrder:4,machineType:"singleNeedle",requiredSkill:"sleeve_attach",timePerPiece:6.8,pricePerPiece:4.2,status:"locked",prerequisites:["op2_2_shoulder","op2_3_dart"],dependents:[],estimatedDuration:149}]}],c=[{id:"op_maya",name:"Maya Patel",machineType:"overlock",skillLevel:"expert",status:"busy",currentWorkload:1,specialties:["shoulder_join","side_seam"],efficiency:94},{id:"op_rajesh",name:"Rajesh Kumar",machineType:"singleNeedle",skillLevel:"expert",status:"available",currentWorkload:0,specialties:["sleeve_attach","hem_finish","dart_sewing"],efficiency:91},{id:"op_sita",name:"Sita Sharma",machineType:"overlock",skillLevel:"intermediate",status:"available",currentWorkload:0,specialties:["side_seam","shoulder_join"],efficiency:87}];p(t),b(c),_(!1)},O=t=>{switch(t.status){case"locked":return{icon:P,color:"text-red-600 bg-red-100 border-red-200",label:"Locked - Prerequisites Required"};case"available":return{icon:f,color:"text-green-600 bg-green-100 border-green-200",label:"Available for Assignment"};case"assigned":return{icon:y,color:"text-blue-600 bg-blue-100 border-blue-200",label:"Assigned - Ready to Start"};case"in_progress":return{icon:w,color:"text-purple-600 bg-purple-100 border-purple-200",label:"In Progress"};case"completed":return{icon:f,color:"text-green-600 bg-green-100 border-green-200",label:"Completed"};default:return{icon:M,color:"text-gray-600 bg-gray-100 border-gray-200",label:"Unknown Status"}}},T=(t,c)=>{if(t.prerequisites.length===0)return null;const i=t.prerequisites.map(l=>c.operations.find(a=>a.id===l)).filter(Boolean),r=i.filter(l=>l?.status==="completed"),s=i.filter(l=>l?.status!=="completed");return{total:i.length,completed:r.length,pending:s,isReady:s.length===0}},A=async(t,c,i)=>{const r=u.find(a=>a.id===t),s=r?.operations.find(a=>a.id===c),l=x.find(a=>a.id===i);if(!(!r||!s||!l)){if(s.status!=="available"){alert(`âŒ Cannot assign ${s.name}!

Operation status: ${s.status}

Only operations with 'available' status can be assigned.`);return}if(l.machineType!==s.machineType){alert(`âŒ Machine Type Mismatch!

Operation "${s.name}" requires: ${s.machineType}
${l.name} operates: ${l.machineType}`);return}if(!l.specialties.includes(s.requiredSkill)){alert(`âŒ Skill Mismatch!

Operation "${s.name}" requires: ${s.requiredSkill}
${l.name} specializes in: ${l.specialties.join(", ")}`);return}p(a=>a.map(n=>n.id===t?{...n,operations:n.operations.map(o=>o.id===c?{...o,status:"assigned",assignedTo:i,assignedOperatorName:l.name}:o)}:n)),b(a=>a.map(n=>n.id===i?{...n,currentWorkload:n.currentWorkload+1,status:"busy"}:n)),alert(`âœ… Assignment Successful!

${s.name} â†’ ${l.name}
Bundle: ${r.bundleNumber}`)}},C=(t,c)=>{p(i=>i.map(r=>{if(r.id!==t)return r;const s=r.operations.map(a=>a.id===c&&a.status==="in_progress"?{...a,status:"completed",completedAt:new Date,actualDuration:a.estimatedDuration+Math.floor(Math.random()*20-10)}:a),l=s.find(a=>a.id===c);return l&&l.dependents.forEach(a=>{const n=s.find(o=>o.id===a);n&&n.status==="locked"&&n.prerequisites.every(g=>s.find(L=>L.id===g)?.status==="completed")&&(n.status="available")}),{...r,operations:s}}))},$=t=>{switch(t){case"urgent":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"normal":return"bg-blue-100 text-blue-800 border-blue-200";case"low":return"bg-gray-100 text-gray-800 border-gray-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return k?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(W,{text:"Loading sequential workflow..."})}):e.jsxs("div",{className:"p-4 space-y-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:"ðŸ”„ Sequential Workflow Assignment"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Operations are unlocked only when prerequisites are completed. Maintain proper production sequence."})]}),e.jsxs(j,{className:"p-4 bg-yellow-50 border-yellow-200",children:[e.jsx("h3",{className:"font-semibold text-yellow-900 mb-3",children:"ðŸ“‹ Workflow Status Guide:"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(P,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"text-red-800",children:"ðŸ”’ Locked - Prerequisites needed"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-green-800",children:"âœ… Available - Ready to assign"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-blue-800",children:"ðŸ‘¤ Assigned - Ready to start"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"text-purple-800",children:"â–¶ï¸ In Progress - Working"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-green-800",children:"âœ… Completed - Finished"})]})]})]})]}),e.jsx("div",{className:"space-y-6",children:u.map(t=>e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[e.jsx(B,{className:"h-5 w-5 mr-2 text-blue-600"}),t.bundleNumber]}),e.jsxs("p",{className:"text-gray-600",children:[t.articleStyle," - ",t.totalPieces," pieces"]})]}),e.jsx(N,{className:$(t.priority),children:t.priority.toUpperCase()})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Overall Progress"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:"bg-blue-600 h-3 rounded-full",style:{width:`${t.overallProgress}%`}})}),e.jsxs("span",{className:"text-sm font-medium",children:[t.overallProgress,"%"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Production Sequence:"}),e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>S(c=>({...c,[t.id]:!c[t.id]})),children:[e.jsx(R,{className:"h-4 w-4 mr-1"}),q[t.id]?"Hide Details":"Show Details"]})]}),e.jsx("div",{className:"space-y-4",children:(()=>{const c=t.operations.sort((i,r)=>i.sequenceOrder-r.sequenceOrder).reduce((i,r)=>{const s=r.prerequisites.join(",")||"initial";return i[s]||(i[s]=[]),i[s].push(r),i},{});return Object.entries(c).map(([i,r])=>e.jsxs("div",{className:"space-y-3",children:[r.length>1&&e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("div",{className:"h-px bg-blue-300 flex-1"}),e.jsxs("div",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:["âš¡ ",r.length," operations can be done in PARALLEL",i!=="initial"&&` (after ${i.split(",").length} prerequisite${i.split(",").length>1?"s":""})`]}),e.jsx("div",{className:"h-px bg-blue-300 flex-1"})]}),e.jsx("div",{className:r.length>1?"grid grid-cols-1 lg:grid-cols-2 gap-4 ml-4":"space-y-3",children:r.map((s,l)=>{const a=O(s),n=a.icon,o=T(s,t),g=x.filter(m=>m.machineType===s.machineType&&m.specialties.includes(s.requiredSkill)&&m.status==="available");return e.jsxs("div",{className:`p-4 border rounded-lg transition-all ${s.status==="available"?"border-green-300 bg-green-50 shadow-sm":s.status==="in_progress"?"border-purple-300 bg-purple-50 shadow-sm":s.status==="completed"?"border-green-400 bg-green-100 shadow-sm":"border-gray-200 bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-800 font-bold text-sm",children:s.sequenceOrder}),e.jsx(n,{className:`h-5 w-5 ${a.color.split(" ")[0]}`})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.nameNepali})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(N,{variant:"outline",className:"text-xs",children:s.machineType}),e.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium border ${a.color}`,children:a.label})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Time/piece:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[s.timePerPiece," min"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Price/piece:"}),e.jsxs("span",{className:"ml-2 font-medium text-green-600",children:["$",s.pricePerPiece]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Total earnings:"}),e.jsxs("span",{className:"ml-2 font-medium text-green-600",children:["$",(s.pricePerPiece*t.totalPieces).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Est. duration:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[s.estimatedDuration," min"]})]})]}),o&&e.jsxs("div",{className:"mb-3 p-3 bg-white rounded border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Prerequisites:"}),e.jsxs("span",{className:`text-xs px-2 py-1 rounded ${o.isReady?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[o.completed,"/",o.total," Complete"]})]}),!o.isReady&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"âš ï¸ Waiting for:"}),o.pending.map(m=>e.jsxs("div",{className:"text-xs text-red-600 ml-4",children:["â€¢ ",m.name," (Step ",m.sequenceOrder,")"]},m.id))]})]}),s.status==="available"&&e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"âœ… Ready for Assignment"}),e.jsxs("p",{className:"text-xs text-gray-600",children:[g.length," compatible operators available"]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:g.slice(0,3).map(m=>e.jsxs(v,{variant:"primary",size:"sm",onClick:()=>A(t.id,s.id,m.id),className:"text-xs",children:["Assign to ",m.name]},m.id))})]})}),s.assignedOperatorName&&e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"text-sm",children:["Assigned to: ",e.jsx("strong",{children:s.assignedOperatorName})]}),s.startedAt&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Started: ",s.startedAt.toLocaleTimeString()]})]}),s.status==="in_progress"&&e.jsx(v,{variant:"success",size:"sm",onClick:()=>C(t.id,s.id),children:"âœ… Mark Complete"})]})}),s.completedAt&&e.jsx("div",{className:"border-t pt-3 text-sm",children:e.jsxs("div",{className:"flex items-center justify-between text-green-800",children:[e.jsxs("span",{children:["âœ… Completed: ",s.completedAt.toLocaleString()]}),s.actualDuration&&e.jsxs("span",{children:["Duration: ",s.actualDuration," min"]})]})}),r.length>1&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded text-xs font-medium",children:"âš¡ Parallel OK"})})]},s.id)})})]},i))})()})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Stage ",t.currentStage+1," of ",t.operations.length," operations"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Est. completion: ",t.estimatedCompletionTime.toLocaleString()]})]})]},t.id))}),e.jsxs(j,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Available Operators"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:x.filter(t=>t.status==="available").map(t=>e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium",children:t.name}),e.jsx(N,{variant:t.skillLevel==="expert"?"success":"warning",size:"sm",children:t.skillLevel})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:["Machine: ",t.machineType]}),e.jsxs("p",{children:["Skills: ",t.specialties.join(", ")]}),e.jsxs("p",{children:["Efficiency: ",t.efficiency,"%"]}),e.jsxs("p",{children:["Workload: ",t.currentWorkload," active"]})]})]},t.id))})]})]})};export{ee as SequentialWorkflowAssignment,ee as default};
