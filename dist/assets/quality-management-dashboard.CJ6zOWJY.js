import{j as e}from"./query-vendor.BbCCZTU0.js";import{r as m}from"./react-vendor.BcnQP8kQ.js";import{C as u,e as _,f as M,g as G,d as y,B as b,a as S,b as ie,F as ne,i as ce}from"./index.BnZjV7b3.js";import{I as O}from"./Input.D8gd7mOf.js";import{L as f}from"./label.BNDYRuzi.js";import{S as F,a as D,b as P,c as E,d}from"./select.BqvOc8nJ.js";import{c as oe}from"./utils.k9sMftog.js";import{d as k}from"./damage-report-service.CZqmI8OF.js";import{t as h}from"./index.wyP5CHuk.js";import{T as H,l as se,m as K,C as X,W as de,n as Y,k as ae,I as Q,F as me,o as xe,g as re,p as he,q as ue,r as te,E as pe}from"./ui-vendor.B7YYMSVe.js";import{S as je}from"./separator.DoYDqNAe.js";import{g as $}from"./utils-vendor.B0NEtgzl.js";import{F as ge}from"./ClockIcon.DbOxfhcH.js";import"./base-service.9pve6B0A.js";import"./firebase-vendor.BZUNkHzc.js";import"./firebase.BVb4kvNg.js";import"./operator-wallet-service.CYKz_Xt9.js";function ve({title:i,titleId:c,...x},j){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:j,"aria-labelledby":c},x),i?m.createElement("title",{id:c},i):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const fe=m.forwardRef(ve),W=m.forwardRef(({className:i,...c},x)=>e.jsx("textarea",{className:oe("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",i),ref:x,...c}));W.displayName="Textarea";const be=[{value:"cutting_error",label:"Cutting Error",nepali:"काट्ने गल्ती"},{value:"sewing_defect",label:"Sewing Defect",nepali:"सिलाई दोष"},{value:"fabric_tear",label:"Fabric Tear",nepali:"कपडा च्यातिने"},{value:"stain",label:"Stain/Mark",nepali:"दाग/निशान"},{value:"burn_mark",label:"Burn Mark",nepali:"जलेको निशान"},{value:"measurement_error",label:"Measurement Error",nepali:"नाप गल्ती"},{value:"thread_pull",label:"Thread Pull",nepali:"धागो तानिने"},{value:"hole_damage",label:"Hole/Puncture",nepali:"प्वाल"},{value:"color_fade",label:"Color Fade",nepali:"रंग फिक्का"},{value:"other",label:"Other",nepali:"अन्य"}],Ne=[{value:"minor",label:"Minor",description:"Repairable with minimal effort",color:"text-yellow-600"},{value:"major",label:"Major",description:"Requires significant rework",color:"text-orange-600"},{value:"critical",label:"Critical",description:"May result in rejection",color:"text-red-600"}],ye=({bundleId:i,operatorId:c,onSuccess:x,onCancel:j})=>{const[o,l]=m.useState({damageType:"",damagedPieces:"",description:"",severity:"",estimatedCost:"",photos:[]}),[N,t]=m.useState(!1),[v,I]=m.useState([]),g=(r,n)=>{l(p=>({...p,[r]:n}))},A=r=>{const n=Array.from(r.target.files||[]);l(p=>({...p,photos:[...p.photos,...n]})),n.forEach(p=>{const s=URL.createObjectURL(p);I(L=>[...L,s])})},w=r=>{l(n=>({...n,photos:n.photos.filter((p,s)=>s!==r)})),I(n=>n.filter((p,s)=>s!==r))},R=()=>o.damageType?!o.damagedPieces||parseInt(o.damagedPieces)<=0?(h.error("Please enter a valid number of damaged pieces"),!1):o.description.trim()?o.severity?!0:(h.error("Please select the severity level"),!1):(h.error("Please provide a description of the damage"),!1):(h.error("Please select a damage type"),!1),T=async r=>{if(r.preventDefault(),!!R()){t(!0);try{const n={bundleId:i,operatorId:c,damageType:o.damageType,damagedPieces:parseInt(o.damagedPieces),description:o.description,severity:o.severity,photos:v,estimatedCost:parseFloat(o.estimatedCost)||0},p=await k.createDamageReport(n);h.success("Damage report submitted successfully"),x?.(p)}catch(n){console.error("Error submitting damage report:",n),h.error("Failed to submit damage report. Please try again.")}finally{t(!1)}}};return e.jsxs(u,{className:"w-full max-w-2xl mx-auto",children:[e.jsxs(_,{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"h-5 w-5 text-amber-500"}),e.jsx(M,{children:"Report Damage"})]}),e.jsxs(G,{children:["Bundle ID: ",i," | Please provide detailed information about the damage"]})]}),e.jsx(y,{children:e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"damageType",children:"Damage Type *"}),e.jsxs(F,{value:o.damageType,onValueChange:r=>g("damageType",r),children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Select damage type"})}),e.jsx(E,{children:be.map(r=>e.jsxs(d,{value:r.value,children:[r.label," - ",r.nepali]},r.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"damagedPieces",children:"Number of Damaged Pieces *"}),e.jsx(O,{id:"damagedPieces",type:"number",min:"1",value:o.damagedPieces,onChange:r=>g("damagedPieces",r.target.value),placeholder:"Enter number of damaged pieces"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"severity",children:"Severity Level *"}),e.jsxs(F,{value:o.severity,onValueChange:r=>g("severity",r),children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Select severity level"})}),e.jsx(E,{children:Ne.map(r=>e.jsxs(d,{value:r.value,children:[r.label," - ",r.description]},r.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"description",children:"Detailed Description *"}),e.jsx(W,{id:"description",value:o.description,onChange:r=>g("description",r.target.value),placeholder:"Describe the damage in detail, including how it occurred...",rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"estimatedCost",children:"Estimated Cost Impact (NPR)"}),e.jsx(O,{id:"estimatedCost",type:"number",min:"0",step:"0.01",value:o.estimatedCost,onChange:r=>g("estimatedCost",r.target.value),placeholder:"Estimated cost of damage"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Damage Photos"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{type:"button",variant:"outline",className:"flex items-center space-x-2",asChild:!0,children:e.jsxs("label",{children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:"Upload Photos"}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:A,className:"sr-only"})]})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[o.photos.length," photo(s) selected"]})]}),v.length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:v.map((r,n)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:r,alt:`Damage photo ${n+1}`,className:"w-full h-20 object-cover rounded border"}),e.jsx(b,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 rounded-full p-0",onClick:()=>w(n),children:"×"})]},n))})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx(b,{type:"submit",disabled:N,className:"flex-1",children:N?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-4 w-4 mr-2 animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Submit Report"]})}),e.jsx(b,{type:"button",variant:"outline",onClick:j,disabled:N,className:"flex-1",children:"Cancel"})]})]})})]})},Z={low:{label:"Low",color:"bg-green-100 text-green-800",icon:"●"},medium:{label:"Medium",color:"bg-yellow-100 text-yellow-800",icon:"●●"},high:{label:"High",color:"bg-orange-100 text-orange-800",icon:"●●●"},urgent:{label:"Urgent",color:"bg-red-100 text-red-800",icon:"●●●●"}},B={pending:{label:"Pending Review",color:"bg-yellow-100 text-yellow-800",icon:ae},approved:{label:"Approved",color:"bg-blue-100 text-blue-800",icon:X},rejected:{label:"Rejected",color:"bg-red-100 text-red-800",icon:Y},in_progress:{label:"In Progress",color:"bg-purple-100 text-purple-800",icon:de},completed:{label:"Completed",color:"bg-green-100 text-green-800",icon:X}},we=({supervisorId:i})=>{const[c,x]=m.useState([]),[j,o]=m.useState(!0),[l,N]=m.useState(null),[t,v]=m.useState({decision:"",instructions:"",assignedTo:"",priority:"",estimatedHours:"",reworkCost:""}),[I,g]=m.useState(!1);m.useEffect(()=>{A()},[]);const A=async()=>{try{o(!0);const s=await k.getReworkRequests();x(s)}catch(s){console.error("Error loading rework requests:",s),h.error("Failed to load rework requests")}finally{o(!1)}},w=s=>{N(s),v({decision:"",instructions:s.reworkInstructions||"",assignedTo:s.assignedTo||"",priority:s.priority,estimatedHours:s.estimatedHours?.toString()||"",reworkCost:s.reworkCost?.toString()||""})},R=(s,L)=>{v(V=>({...V,[s]:L}))},T=async()=>{if(!l||!t.decision){h.error("Please select a decision");return}if(t.decision==="approved"&&!t.instructions.trim()){h.error("Please provide rework instructions");return}g(!0);try{const s={decision:t.decision,instructions:t.instructions,assignedTo:t.assignedTo,priority:t.priority,estimatedHours:parseFloat(t.estimatedHours)||0,reworkCost:parseFloat(t.reworkCost)||0,reviewedBy:i,reviewedAt:new Date};await k.reviewReworkRequest(l.id,s),h.success(`Rework request ${t.decision}`),N(null),A()}catch(s){console.error("Error submitting review:",s),h.error("Failed to submit review")}finally{g(!1)}},r=c.filter(s=>s.status==="pending"),n=c.filter(s=>["approved","in_progress"].includes(s.status)),p=c.filter(s=>["completed","rejected"].includes(s.status));return j?e.jsx(u,{children:e.jsx(y,{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(u,{children:e.jsxs(_,{children:[e.jsxs(M,{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"h-5 w-5"}),e.jsx("span",{children:"Rework Requests"})]}),e.jsx(G,{children:"Review and approve rework requests from damage reports"})]})}),r.length>0&&e.jsxs(u,{children:[e.jsx(_,{children:e.jsxs(M,{className:"text-lg text-amber-600",children:["Pending Review (",r.length,")"]})}),e.jsx(y,{className:"space-y-3",children:r.map(s=>e.jsx(q,{request:s,isSelected:l?.id===s.id,onClick:()=>w(s)},s.id))})]}),n.length>0&&e.jsxs(u,{children:[e.jsx(_,{children:e.jsxs(M,{className:"text-lg text-blue-600",children:["Active Rework (",n.length,")"]})}),e.jsx(y,{className:"space-y-3",children:n.map(s=>e.jsx(q,{request:s,isSelected:l?.id===s.id,onClick:()=>w(s)},s.id))})]}),p.length>0&&e.jsxs(u,{children:[e.jsx(_,{children:e.jsx(M,{className:"text-lg text-green-600",children:"Recently Completed"})}),e.jsx(y,{className:"space-y-3",children:p.slice(0,3).map(s=>e.jsx(q,{request:s,isSelected:l?.id===s.id,onClick:()=>w(s)},s.id))})]})]}),e.jsx("div",{children:l?e.jsxs(u,{className:"sticky top-4",children:[e.jsxs(_,{children:[e.jsxs(M,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Review Request"}),e.jsx(S,{className:B[l.status].color,children:B[l.status].label})]}),e.jsxs(G,{children:["Bundle: ",l.bundleId," | Operator: ",l.operatorName]})]}),e.jsxs(y,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground mb-2",children:"DAMAGE DETAILS"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Type:"}),e.jsx("p",{className:"font-medium",children:l.damageType.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Pieces:"}),e.jsx("p",{className:"font-bold text-red-600",children:l.damagedPieces})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Severity:"}),e.jsx("p",{className:"font-medium capitalize",children:l.severity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Cost Impact:"}),e.jsxs("p",{className:"flex items-center font-semibold",children:[e.jsx(Q,{className:"h-3 w-3 mr-1"}),l.estimatedCost.toFixed(2)]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"DESCRIPTION"}),e.jsx("p",{className:"text-sm p-2 bg-muted rounded",children:l.description})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Submitted ",$(new Date(l.submittedAt),{addSuffix:!0})]})]}),e.jsx(je,{}),l.status==="pending"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"Review Decision"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Decision *"}),e.jsxs(F,{value:t.decision,onValueChange:s=>R("decision",s),children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Select decision"})}),e.jsxs(E,{children:[e.jsx(d,{value:"approved",children:"Approve Rework"}),e.jsx(d,{value:"rejected",children:"Reject Request"})]})]})]}),t.decision==="approved"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Rework Instructions *"}),e.jsx(W,{value:t.instructions,onChange:s=>R("instructions",s.target.value),placeholder:"Provide detailed instructions for the rework...",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Assign To"}),e.jsxs(F,{value:t.assignedTo,onValueChange:s=>R("assignedTo",s),children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Select operator"})}),e.jsxs(E,{children:[e.jsx(d,{value:"same_operator",children:"Same Operator"}),e.jsx(d,{value:"quality_team",children:"Quality Team"}),e.jsx(d,{value:"specialist",children:"Specialist"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Priority"}),e.jsxs(F,{value:t.priority,onValueChange:s=>R("priority",s),children:[e.jsx(D,{children:e.jsx(P,{})}),e.jsxs(E,{children:[e.jsx(d,{value:"low",children:"Low"}),e.jsx(d,{value:"medium",children:"Medium"}),e.jsx(d,{value:"high",children:"High"}),e.jsx(d,{value:"urgent",children:"Urgent"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Estimated Hours"}),e.jsx(O,{type:"number",min:"0",step:"0.5",value:t.estimatedHours,onChange:s=>R("estimatedHours",s.target.value),placeholder:"Hours needed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:"Rework Cost (NPR)"}),e.jsx(O,{type:"number",min:"0",step:"0.01",value:t.reworkCost,onChange:s=>R("reworkCost",s.target.value),placeholder:"Additional cost"})]})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx(b,{onClick:T,disabled:I||!t.decision,className:"flex-1",children:I?"Submitting...":"Submit Review"}),e.jsx(b,{variant:"outline",onClick:()=>N(null),className:"flex-1",children:"Cancel"})]})]}),l.status!=="pending"&&l.reviewedBy&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground",children:"REVIEW HISTORY"}),e.jsxs("div",{className:"p-3 bg-muted rounded text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Reviewed by:"})," ",l.reviewedBy]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Decision:"})," ",l.status.replace("_"," ").toUpperCase()]}),l.reviewedAt&&e.jsxs("p",{children:[e.jsx("strong",{children:"Reviewed:"})," ",$(new Date(l.reviewedAt),{addSuffix:!0})]}),l.reworkInstructions&&e.jsxs("p",{children:[e.jsx("strong",{children:"Instructions:"})," ",l.reworkInstructions]})]})]})]})]}):e.jsx(u,{children:e.jsxs(y,{className:"text-center py-8",children:[e.jsx(me,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Select a Request"}),e.jsx("p",{className:"text-muted-foreground",children:"Choose a rework request from the list to review and make decisions"})]})})})]})},q=({request:i,isSelected:c,onClick:x})=>{const j=B[i.status].icon;return e.jsxs("div",{className:`p-3 border rounded cursor-pointer transition-colors ${c?"border-primary bg-primary/5":"hover:bg-muted/50"}`,onClick:x,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{variant:"outline",className:"font-mono text-xs",children:i.bundleId}),e.jsx(S,{className:Z[i.priority].color,children:Z[i.priority].label})]}),e.jsxs(S,{className:B[i.status].color,children:[e.jsx(j,{className:"h-3 w-3 mr-1"}),B[i.status].label]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center text-muted-foreground",children:[e.jsx(xe,{className:"h-3 w-3 mr-1"}),i.operatorName]}),e.jsxs("p",{className:"font-medium",children:[i.damageType.replace("_"," ")," - ",i.damagedPieces," pieces"]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(re,{className:"h-3 w-3 mr-1"}),$(new Date(i.submittedAt),{addSuffix:!0})]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(Q,{className:"h-3 w-3 mr-1"}),i.estimatedCost.toFixed(0)]})]})]})]})},J={cutting_error:{label:"Cutting Error",nepali:"काट्ने गल्ती"},sewing_defect:{label:"Sewing Defect",nepali:"सिलाई दोष"},fabric_tear:{label:"Fabric Tear",nepali:"कपडा च्यातिने"},stain:{label:"Stain/Mark",nepali:"दाग/निशान"},burn_mark:{label:"Burn Mark",nepali:"जलेको निशान"},measurement_error:{label:"Measurement Error",nepali:"नाप गल्ती"},thread_pull:{label:"Thread Pull",nepali:"धागो तानिने"},hole_damage:{label:"Hole/Puncture",nepali:"प्वाल"},color_fade:{label:"Color Fade",nepali:"रंग फिक्का"},other:{label:"Other",nepali:"अन्य"}},z={pending:{label:"Pending Review",color:"bg-yellow-100 text-yellow-800",icon:ae},approved:{label:"Approved",color:"bg-green-100 text-green-800",icon:te},rejected:{label:"Rejected",color:"bg-red-100 text-red-800",icon:Y},rework_required:{label:"Rework Required",color:"bg-orange-100 text-orange-800",icon:H}},ee={minor:{color:"bg-yellow-100 text-yellow-800",label:"Minor"},major:{color:"bg-orange-100 text-orange-800",label:"Major"},critical:{color:"bg-red-100 text-red-800",label:"Critical"}},Re=({operatorId:i,bundleId:c,showActions:x=!1,onReportClick:j})=>{const[o,l]=m.useState([]),[N,t]=m.useState(!0),[v,I]=m.useState(""),[g,A]=m.useState("all"),[w,R]=m.useState("all"),[T,r]=m.useState("timestamp");m.useEffect(()=>{n()},[i,c]);const n=async()=>{try{t(!0);let a;i?a=await k.getOperatorReports(i):c?a=await k.getBundleReports(c):a=await k.getAllReports(),l(a)}catch(a){console.error("Error loading damage reports:",a),h.error("Failed to load damage reports")}finally{t(!1)}},p=async a=>{try{await k.approveReport(a),h.success("Damage report approved"),n()}catch{h.error("Failed to approve report")}},s=async a=>{try{await k.rejectReport(a),h.success("Damage report rejected"),n()}catch{h.error("Failed to reject report")}},L=async a=>{try{await k.assignRework(a),h.success("Rework assigned"),n()}catch{h.error("Failed to assign rework")}},V=o.filter(a=>{const C=a.bundleId.toLowerCase().includes(v.toLowerCase())||a.operatorName?.toLowerCase().includes(v.toLowerCase())||a.description.toLowerCase().includes(v.toLowerCase()),U=g==="all"||a.status===g,le=w==="all"||a.severity===w;return C&&U&&le}).sort((a,C)=>{if(T==="timestamp")return new Date(C.timestamp).getTime()-new Date(a.timestamp).getTime();if(T==="severity"){const U={critical:3,major:2,minor:1};return U[C.severity]-U[a.severity]}else if(T==="cost")return C.estimatedCost-a.estimatedCost;return 0});return N?e.jsx(u,{children:e.jsx(y,{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Damage Reports"}),e.jsxs("p",{className:"text-muted-foreground",children:[o.length," total reports",i&&" for this operator",c&&` for bundle ${c}`]})]})}),e.jsx(u,{children:e.jsx(y,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(he,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(O,{placeholder:"Search reports...",value:v,onChange:a=>I(a.target.value),className:"pl-8"})]}),e.jsxs(F,{value:g,onValueChange:A,children:[e.jsxs(D,{children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),e.jsx(P,{placeholder:"Filter by status"})]}),e.jsxs(E,{children:[e.jsx(d,{value:"all",children:"All Status"}),e.jsx(d,{value:"pending",children:"Pending"}),e.jsx(d,{value:"approved",children:"Approved"}),e.jsx(d,{value:"rejected",children:"Rejected"}),e.jsx(d,{value:"rework_required",children:"Rework Required"})]})]}),e.jsxs(F,{value:w,onValueChange:R,children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Filter by severity"})}),e.jsxs(E,{children:[e.jsx(d,{value:"all",children:"All Severity"}),e.jsx(d,{value:"minor",children:"Minor"}),e.jsx(d,{value:"major",children:"Major"}),e.jsx(d,{value:"critical",children:"Critical"})]})]}),e.jsxs(F,{value:T,onValueChange:r,children:[e.jsx(D,{children:e.jsx(P,{placeholder:"Sort by"})}),e.jsxs(E,{children:[e.jsx(d,{value:"timestamp",children:"Latest First"}),e.jsx(d,{value:"severity",children:"Severity"}),e.jsx(d,{value:"cost",children:"Cost Impact"})]})]})]})})}),V.length===0?e.jsx(u,{children:e.jsxs(y,{className:"text-center py-8",children:[e.jsx(H,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No damage reports found"}),e.jsx("p",{className:"text-muted-foreground",children:v||g!=="all"||w!=="all"?"No reports match your current filters":"No damage reports have been submitted yet"})]})}):e.jsx("div",{className:"space-y-4",children:V.map(a=>{const C=z[a.status].icon;return e.jsx(u,{className:"hover:shadow-md transition-shadow",children:e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(S,{variant:"outline",className:"font-mono",children:a.bundleId}),e.jsx(S,{className:ee[a.severity].color,children:ee[a.severity].label}),e.jsxs(S,{className:z[a.status].color,children:[e.jsx(C,{className:"h-3 w-3 mr-1"}),z[a.status].label]}),a.photos.length>0&&e.jsxs(S,{variant:"secondary",children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),a.photos.length," photos"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground",children:"DAMAGE TYPE"}),e.jsx("p",{className:"font-medium",children:J[a.damageType]?.label||a.damageType}),e.jsx("p",{className:"text-sm text-muted-foreground",children:J[a.damageType]?.nepali})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground",children:"PIECES AFFECTED"}),e.jsx("p",{className:"text-lg font-bold text-red-600",children:a.damagedPieces})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground",children:"ESTIMATED COST"}),e.jsxs("p",{className:"flex items-center font-semibold",children:[e.jsx(Q,{className:"h-4 w-4 mr-1"}),a.estimatedCost.toFixed(2)]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground mb-1",children:"DESCRIPTION"}),e.jsx("p",{className:"text-sm",children:a.description})]}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground space-x-4",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(re,{className:"h-4 w-4 mr-1"}),$(new Date(a.timestamp),{addSuffix:!0})]}),a.operatorName&&e.jsxs("span",{children:["Operator: ",a.operatorName]}),a.approvedBy&&e.jsxs("span",{children:["Approved by: ",a.approvedBy]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-2 ml-4",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>j?.(a),children:[e.jsx(pe,{className:"h-4 w-4 mr-1"}),"View"]}),x&&a.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(b,{variant:"default",size:"sm",onClick:()=>p(a.id),children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),"Approve"]}),e.jsxs(b,{variant:"destructive",size:"sm",onClick:()=>s(a.id),children:[e.jsx(Y,{className:"h-4 w-4 mr-1"}),"Reject"]}),e.jsxs(b,{variant:"secondary",size:"sm",onClick:()=>L(a.id),children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),"Rework"]})]})]})]})})},a.id)})})]})},Ue=({userRole:i="supervisor"})=>{const[c,x]=m.useState("overview"),j={pendingReports:12,reworkItems:23,qualityRate:96.1},o=[{id:"DR001",bundleId:"BND-2024-001",operatorName:"Maya Sharma",damageType:"Fabric Tear",severity:"High",status:"Pending Review",timestamp:new Date("2024-12-07T10:30:00")},{id:"DR002",bundleId:"BND-2024-003",operatorName:"Rajesh Kumar",damageType:"Stitching Defect",severity:"Medium",status:"Approved for Rework",timestamp:new Date("2024-12-07T09:15:00")}],l=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(ie,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Quality Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[j.qualityRate,"%"]})]})]})}),e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:e.jsx(ne,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending Reports"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:j.pendingReports})]})]})}),e.jsx(u,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:e.jsx(ge,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Rework Items"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:j.reworkItems})]})]})})]}),e.jsxs(u,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Damage Reports"}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>x("new-report"),children:"New Report"})]}),e.jsx("div",{className:"space-y-3",children:o.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.id}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Bundle: ",t.bundleId]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Operator: ",t.operatorName]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.damageType}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(S,{variant:t.severity==="High"?"destructive":"secondary",children:t.severity}),e.jsx(S,{variant:t.status==="Pending Review"?"secondary":"outline",children:t.status})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(b,{variant:"ghost",size:"sm",children:e.jsx(ce,{className:"h-4 w-4"})}),e.jsx("span",{className:"text-sm text-gray-500",children:t.timestamp.toLocaleTimeString()})]})]},t.id))})]})]}),N=()=>{switch(c){case"overview":return l();case"reports":return e.jsx(Re,{});case"approvals":return e.jsx(we,{userRole:i});case"new-report":return e.jsx(ye,{bundleId:"BND-2024-001",operatorId:"op-maya-001",onCancel:()=>x("overview"),onSuccess:()=>x("overview")});default:return l()}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(fe,{className:"h-8 w-8 text-blue-600"}),e.jsx("span",{children:"Quality Management"})]}),e.jsx("p",{className:"text-gray-600",children:"Monitor quality control and damage reporting"})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>x("overview"),className:`py-2 px-1 border-b-2 font-medium text-sm ${c==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Overview"}),e.jsx("button",{onClick:()=>x("reports"),className:`py-2 px-1 border-b-2 font-medium text-sm ${c==="reports"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Damage Reports"}),e.jsx("button",{onClick:()=>x("approvals"),className:`py-2 px-1 border-b-2 font-medium text-sm ${c==="approvals"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Rework Approvals"}),e.jsx("button",{onClick:()=>x("new-report"),className:`py-2 px-1 border-b-2 font-medium text-sm ${c==="new-report"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"New Report"})]})}),N()]})};export{Ue as QualityManagementDashboard};
