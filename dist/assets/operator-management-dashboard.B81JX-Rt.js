const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.CLAiwwTT.js","assets/query-vendor.DpsghfSz.js","assets/react-vendor.CfKEcsXX.js","assets/ui-vendor.EZF4ucWh.js","assets/firebase-vendor.D8xw0AXf.js","assets/utils-vendor.B0NEtgzl.js","assets/index.DXujQHlj.css"])))=>i.map(i=>d[i]);
import{C as b,a as P,p as de,B as w,J as Q,A as me,n as U,I as M,D as Ee,_ as Ie}from"./index.CLAiwwTT.js";import{j as e,u as xe}from"./query-vendor.DpsghfSz.js";import{r as c,u as Oe,d as Le}from"./react-vendor.CfKEcsXX.js";import{L as Z}from"./LoadingSpinner.1kukr6Vo.js";import{F as H,E as Ae}from"./empty-state.Cugu3L3L.js";import{S as K,M as J,a as he}from"./operator-types.IC8C56sJ.js";import{F as G}from"./ClockIcon.B0z2Gpg3.js";import{F as se}from"./MagnifyingGlassIcon.BY4e_13K.js";import{F as Fe}from"./FunnelIcon.CvqkinxJ.js";import{F as Me}from"./PencilIcon.8W3cwjlG.js";import{F as re}from"./CalendarDaysIcon.DrGkQZXF.js";import{F as Y}from"./StarIcon.WwJcLCr3.js";import{F as Te}from"./CurrencyRupeeIcon.7xrTRvUQ.js";import{o as le,s as ie,p as Pe,a as Ve,$ as $e,b as ue,u as Be,c as qe,n as ze,d as ne,e as F,_ as _e,l as Re}from"./form-vendor.YPfcWTfe.js";import{IDGenerationService as W}from"./id-generation-service._PtYBQ4s.js";import{F as ce}from"./UserIcon.BzFG2rMW.js";import"./ui-vendor.EZF4ucWh.js";import"./firebase-vendor.D8xw0AXf.js";import"./utils-vendor.B0NEtgzl.js";function Ue({title:s,titleId:d,...l},t){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},l),s?c.createElement("title",{id:d},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const De=c.forwardRef(Ue);function We({title:s,titleId:d,...l},t){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},l),s?c.createElement("title",{id:d},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.745 3.745 0 0 1-1.043 3.296 3.745 3.745 0 0 1-3.296 1.043A3.745 3.745 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.746 3.746 0 0 1-3.296-1.043 3.745 3.745 0 0 1-1.043-3.296A3.745 3.745 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.745 3.745 0 0 1 1.043-3.296 3.746 3.746 0 0 1 3.296-1.043A3.746 3.746 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.746 3.746 0 0 1 3.296 1.043 3.746 3.746 0 0 1 1.043 3.296A3.745 3.745 0 0 1 21 12Z"}))}const pe=c.forwardRef(We);function Ze({title:s,titleId:d,...l},t){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},l),s?c.createElement("title",{id:d},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"}))}const Ge=c.forwardRef(Ze);function Qe({title:s,titleId:d,...l},t){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},l),s?c.createElement("title",{id:d},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.182 15.182a4.5 4.5 0 0 1-6.364 0M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0ZM9.75 9.75c0 .414-.168.75-.375.75S9 10.164 9 9.75 9.168 9 9.375 9s.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Zm5.625 0c0 .414-.168.75-.375.75s-.375-.336-.375-.75.168-.75.375-.75.375.336.375.75Zm-.375 0h.008v.015h-.008V9.75Z"}))}const He=c.forwardRef(Qe);function Ke({title:s,titleId:d,...l},t){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},l),s?c.createElement("title",{id:d},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}),c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"}))}const Je=c.forwardRef(Ke);function Ye({title:s,titleId:d,...l},t){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":d},l),s?c.createElement("title",{id:d},s):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"}))}const Xe=c.forwardRef(Ye),ge=({operator:s,onView:d,onEdit:l,onDelete:t,onStatusChange:o,showActions:m=!0,className:x=""})=>{const n=K[s.currentStatus]||K.offline,j=()=>{if(s.avatar)switch(s.avatar.type){case"emoji":return e.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-100 flex items-center justify-center text-2xl",children:s.avatar.value});case"photo":return e.jsx("img",{src:s.avatar.value,alt:s.name,className:"h-12 w-12 rounded-full object-cover"});case"initials":return e.jsx("div",{className:"h-12 w-12 rounded-full flex items-center justify-center text-white font-semibold",style:{backgroundColor:s.avatar.backgroundColor||"#3B82F6"},children:s.avatar.value})}const u=s.name.split(" ").map(y=>y.charAt(0)).join("").toUpperCase().slice(0,2);return e.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-400 flex items-center justify-center text-white font-semibold",children:u})};return e.jsxs(b,{className:`p-4 hover:shadow-md transition-shadow ${x}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[j(),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",s.employeeId]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(P,{variant:n.color,className:"flex items-center space-x-1",children:[e.jsx("span",{children:n.icon}),e.jsx("span",{className:"hidden sm:inline",children:n.label})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Machine"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.primaryMachine})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(de,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Efficiency"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Math.round(s.efficiency*100),"%"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(pe,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Quality"}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[typeof s.qualityScore=="number"&&!isNaN(s.qualityScore)?Math.round(s.qualityScore):85,"%"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Current Work"}),e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.currentWork||"None"})]})]})]}),m&&e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:d,className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50",children:"View Details"}),l&&e.jsx(w,{variant:"ghost",size:"sm",onClick:l,className:"text-gray-600 hover:text-gray-700 hover:bg-gray-50",children:"Edit"}),t&&e.jsx(w,{variant:"ghost",size:"sm",onClick:t,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:"Delete"})]}),o&&e.jsx(w,{variant:"ghost",size:"sm",onClick:o,className:"text-green-600 hover:text-green-700 hover:bg-green-50",children:"Update Status"})]})]})},_={all:["operators"],lists:()=>[..._.all,"list"],list:s=>[..._.lists(),{filters:s}],details:()=>[..._.all,"detail"],detail:s=>[..._.details(),s],status:s=>[..._.all,"status",s]};function es(s){return xe({queryKey:_.lists(),queryFn:()=>Q.getOperatorsSummary(),staleTime:300*1e3,gcTime:600*1e3,...s})}function ss(s,d){return xe({queryKey:_.status(s),queryFn:()=>Q.getOperatorWithStatus(s),enabled:!!s,staleTime:30*1e3,refetchInterval:60*1e3,...d})}const as=({onCreateNew:s,onViewOperator:d,onEditOperator:l,onDeleteOperator:t,userRole:o="operator",showActions:m=!0})=>{const[x,n]=c.useState(""),[j,u]=c.useState("all"),[y,p]=c.useState("all"),[k,N]=c.useState("all"),[E,V]=c.useState(!1),{data:B,isLoading:S,error:q,refetch:T}=es({refetchInterval:60*1e3}),L=B?.success?B.data:[],C=c.useMemo(()=>L.filter(i=>{const g=x===""||i.name.toLowerCase().includes(x.toLowerCase())||i.employeeId.toLowerCase().includes(x.toLowerCase()),h=j==="all"||i.currentStatus===j,A=y==="all"||i.primaryMachine===y;return g&&h&&A}),[L,x,j,y]),r=c.useMemo(()=>{const i=L.length,g=L.filter(I=>I.currentStatus==="working").length,h=L.filter(I=>I.currentStatus==="idle").length,A=L.reduce((I,D)=>I+D.efficiency,0)/i||0;return{total:i,active:g,available:h,avgEfficiency:A}},[L]);return S?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(Z,{size:"lg"})}):q?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-red-600 mb-4",children:"Failed to load operators"}),e.jsx(w,{onClick:()=>T(),children:"Try Again"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Operators"}),e.jsx("p",{className:"text-gray-600",children:"Manage and monitor operator performance"})]}),s&&e.jsxs(w,{onClick:s,className:"flex items-center space-x-2",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Operator"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(U,{className:"h-5 w-5 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.total})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-2 w-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Working"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.active})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Available"})]}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:r.available})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-2 w-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Avg Efficiency"})]}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[Math.round(r.avgEfficiency*100),"%"]})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(M,{placeholder:"Search operators by name or ID...",value:x,onChange:i=>n(i.target.value),className:"pl-10"})]})}),e.jsxs(w,{variant:"ghost",onClick:()=>V(!E),className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{children:"Filters"}),(j!=="all"||y!=="all"||k!=="all")&&e.jsx(P,{variant:"primary",className:"ml-1",children:[j,y,k].filter(i=>i!=="all").length})]})]}),E&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:j,onChange:i=>u(i.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),Object.entries(K).map(([i,g])=>e.jsxs("option",{value:i,children:[g.icon," ",g.label]},i))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Machine Type"}),e.jsxs("select",{value:y,onChange:i=>p(i.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Machines"}),J.map(i=>e.jsxs("option",{value:i.machineType,children:[i.displayName," (",i.nepaliName,")"]},i.machineType))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Level"}),e.jsxs("select",{value:k,onChange:i=>N(i.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Levels"}),he.map(i=>e.jsxs("option",{value:i.value,children:[i.label," (",i.nepaliLabel,")"]},i.value))]})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>{u("all"),p("all"),N("all"),n("")},children:"Clear Filters"})})]})]}),e.jsx("div",{children:C.length===0?e.jsx(Ae,{icon:U,title:"No operators found",description:x||j!=="all"||y!=="all"?"Try adjusting your filters to see more operators":"Get started by adding your first operator",action:s?e.jsx(w,{onClick:s,children:"Add First Operator"}):void 0}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[C.length," of ",L.length," operators"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:C.map(i=>e.jsx(ge,{operator:i,onView:()=>d?.(i.id),onEdit:o==="supervisor"?()=>l?.(i.id):void 0,onDelete:o==="supervisor"?()=>t?.(i.id):void 0,showActions:m},i.id))})]})})]})},ts=()=>{const{id:s}=Oe(),d=Le(),[l,t]=c.useState("overview"),{data:o,isLoading:m,error:x}=ss(s,{enabled:!!s});if(m)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(Z,{size:"lg"})});if(x||!o?.success||!o.data)return e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-red-600 mb-4",children:"Operator not found"}),e.jsx(w,{onClick:()=>d("/operators"),children:"Back to Operators"})]});const n=o.data,j=n.realtimeStatus,u=K[j.status],y=()=>{if(n.avatar)switch(n.avatar.type){case"emoji":return e.jsx("div",{className:"h-20 w-20 rounded-full bg-gray-100 flex items-center justify-center text-4xl",children:n.avatar.value});case"photo":return e.jsx("img",{src:n.avatar.value,alt:n.name,className:"h-20 w-20 rounded-full object-cover"});case"initials":return e.jsx("div",{className:"h-20 w-20 rounded-full flex items-center justify-center text-white font-bold text-xl",style:{backgroundColor:n.avatar.backgroundColor||"#3B82F6"},children:n.avatar.value})}const p=n.name.split(" ").map(k=>k.charAt(0)).join("").toUpperCase().slice(0,2);return e.jsx("div",{className:"h-20 w-20 rounded-full bg-gray-400 flex items-center justify-center text-white font-bold text-xl",children:p})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(w,{variant:"ghost",onClick:()=>d("/operators"),className:"flex items-center space-x-2",children:[e.jsx(De,{className:"h-4 w-4"}),e.jsx("span",{children:"Back"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Operator Details"}),e.jsx("p",{className:"text-gray-600",children:"View and manage operator information"})]})]}),e.jsxs(w,{onClick:()=>d(`/operators/${s}/edit`),className:"flex items-center space-x-2",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{children:"Edit"})]})]}),e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-6",children:[y(),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:n.name}),e.jsxs(P,{variant:u?.color,className:"flex items-center space-x-1",children:[e.jsx("span",{children:u?.icon}),e.jsx("span",{children:u?.label})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Employee ID"}),e.jsx("p",{className:"font-medium text-gray-900",children:n.employeeId})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Username"}),e.jsx("p",{className:"font-medium text-gray-900",children:n.username})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Primary Machine"}),e.jsx("p",{className:"font-medium text-gray-900",children:n.primaryMachine})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:"Skill Level"}),e.jsx("p",{className:"font-medium text-gray-900 capitalize",children:n.skillLevel})]})]})]})]})}),e.jsxs(b,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Current Status"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`h-3 w-3 rounded-full ${u?.color==="green"?"bg-green-500":u?.color==="yellow"?"bg-yellow-500":u?.color==="blue"?"bg-blue-500":"bg-gray-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Status"}),e.jsx("p",{className:"font-medium text-gray-900",children:u?.label})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(G,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Current Work"}),e.jsx("p",{className:"font-medium text-gray-900",children:j.currentWork||"None"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(H,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Machine Status"}),e.jsx("p",{className:"font-medium text-gray-900 capitalize",children:j.machineStatus})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(re,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Last Activity"}),e.jsx("p",{className:"font-medium text-gray-900",children:new Date(j.lastActivity).toLocaleTimeString()})]})]})]})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{key:"overview",label:"Overview"},{key:"performance",label:"Performance"},{key:"activity",label:"Activity"}].map(p=>e.jsx("button",{onClick:()=>t(p.key),className:`py-2 px-1 border-b-2 font-medium text-sm ${l===p.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:p.label},p.key))})}),l==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(b,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Personal Information"}),e.jsxs("div",{className:"space-y-4",children:[n.email&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ge,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Email"}),e.jsx("p",{className:"font-medium text-gray-900",children:n.email})]})]}),n.phone&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Xe,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Phone"}),e.jsx("p",{className:"font-medium text-gray-900",children:n.phone})]})]}),n.address&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Je,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Address"}),e.jsx("p",{className:"font-medium text-gray-900",children:n.address})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(re,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Hired Date"}),e.jsx("p",{className:"font-medium text-gray-900",children:new Date(n.hiredDate).toLocaleDateString()})]})]})]})]}),e.jsxs(b,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Work Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(H,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Machine Types"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:n.machineTypes?.map(p=>{const k=J.find(N=>N.machineType===p);return e.jsx(P,{variant:"secondary",children:k?.displayName||p},p)})})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Y,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Specializations"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:n.specializations?.map(p=>e.jsx(P,{variant:"outline",children:p},p))||e.jsx("p",{className:"text-gray-400 text-sm",children:"None specified"})})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(G,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Shift"}),e.jsx("p",{className:"font-medium text-gray-900 capitalize",children:n.shift})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"h-5 w-5 text-gray-400 flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-bold",children:"#"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Max Concurrent Work"}),e.jsx("p",{className:"font-medium text-gray-900",children:n.maxConcurrentWork})]})]})]})]})]}),l==="performance"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(de,{className:"h-6 w-6 text-yellow-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Efficiency"})]}),e.jsxs("p",{className:"text-3xl font-bold text-yellow-600",children:[Math.round(n.averageEfficiency*100),"%"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Average performance"})]}),e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(pe,{className:"h-6 w-6 text-green-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Quality"})]}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[Math.round(n.qualityScore*100),"%"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Quality score"})]}),e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("div",{className:"h-6 w-6 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-bold",children:"B"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Bundles"})]}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:n.completedBundles}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Completed"})]}),e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(Te,{className:"h-6 w-6 text-purple-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Earnings"})]}),e.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:["₹",n.totalEarnings?.toLocaleString()||0]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Total earned"})]})]}),l==="activity"&&e.jsxs(b,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(G,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Activity log will be displayed here"}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Feature coming soon"})]})]})]})};function oe(s,d){try{var l=s()}catch(t){return d(t)}return l&&l.then?l.then(void 0,d):l}function rs(s,d){for(var l={};s.length;){var t=s[0],o=t.code,m=t.message,x=t.path.join(".");if(!l[x])if("unionErrors"in t){var n=t.unionErrors[0].errors[0];l[x]={message:n.message,type:n.code}}else l[x]={message:m,type:o};if("unionErrors"in t&&t.unionErrors.forEach(function(y){return y.errors.forEach(function(p){return s.push(p)})}),d){var j=l[x].types,u=j&&j[t.code];l[x]=ue(x,d,l,o,u?[].concat(u,t.message):t.message)}s.shift()}return l}function ls(s,d){for(var l={};s.length;){var t=s[0],o=t.code,m=t.message,x=t.path.join(".");if(!l[x])if(t.code==="invalid_union"&&t.errors.length>0){var n=t.errors[0][0];l[x]={message:n.message,type:n.code}}else l[x]={message:m,type:o};if(t.code==="invalid_union"&&t.errors.forEach(function(y){return y.forEach(function(p){return s.push(p)})}),d){var j=l[x].types,u=j&&j[t.code];l[x]=ue(x,d,l,o,u?[].concat(u,t.message):t.message)}s.shift()}return l}function is(s,d,l){if(l===void 0&&(l={}),(function(t){return"_def"in t&&typeof t._def=="object"&&"typeName"in t._def})(s))return function(t,o,m){try{return Promise.resolve(oe(function(){return Promise.resolve(s[l.mode==="sync"?"parse":"parseAsync"](t,d)).then(function(x){return m.shouldUseNativeValidation&&le({},m),{errors:{},values:l.raw?Object.assign({},t):x}})},function(x){if((function(n){return Array.isArray(n?.issues)})(x))return{values:{},errors:ie(rs(x.errors,!m.shouldUseNativeValidation&&m.criteriaMode==="all"),m)};throw x}))}catch(x){return Promise.reject(x)}};if((function(t){return"_zod"in t&&typeof t._zod=="object"})(s))return function(t,o,m){try{return Promise.resolve(oe(function(){return Promise.resolve((l.mode==="sync"?Pe:Ve)(s,t,d)).then(function(x){return m.shouldUseNativeValidation&&le({},m),{errors:{},values:l.raw?Object.assign({},t):x}})},function(x){if((function(n){return n instanceof $e})(x))return{values:{},errors:ie(ls(x.issues,!m.shouldUseNativeValidation&&m.criteriaMode==="all"),m)};throw x}))}catch(x){return Promise.reject(x)}};throw new Error("Invalid input: not a Zod schema")}const ns=s=>qe({username:F().min(3,"Username must be at least 3 characters"),password:s==="create"?F().min(6,"Password must be at least 6 characters"):F().optional(),name:F().min(2,"Full Name must be at least 2 characters"),employeeId:F().min(1,"Employee ID is required"),email:F().email("Invalid email format").optional().or(Re("")),phone:F().optional(),address:F().optional(),primaryMachine:F().min(1,"Primary machine selection is required"),machineTypes:ne(F()).min(1,"At least one machine type must be selected"),skillLevel:_e(["beginner","intermediate","advanced","expert"],{required_error:"Skill level selection is required"}),specializations:ne(F()).optional(),maxConcurrentWork:ze().min(1,"Must be at least 1").max(10,"Cannot exceed 10")}),cs=["👨‍💼","👩‍💼","👨‍🔧","👩‍🔧","👨‍🏭","👩‍🏭","🧑‍💻","👨‍💻","👩‍💻","🥷","👤","🔧"],ee=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#F97316","#06B6D4","#84CC16"],os=[{value:"stitching",label:"Stitching",nepaliLabel:"सिलाई"},{value:"hemming",label:"Hemming",nepaliLabel:"हेमिंग"},{value:"buttonhole_making",label:"Buttonhole Making",nepaliLabel:"बटनहोल बनाउने"},{value:"button_attaching",label:"Button Attaching",nepaliLabel:"बटन जोड्ने"},{value:"zipper_insertion",label:"Zipper Insertion",nepaliLabel:"जिपर लगाउने"},{value:"seam_finishing",label:"Seam Finishing",nepaliLabel:"सिम फिनिशिंग"},{value:"edge_stitching",label:"Edge Stitching",nepaliLabel:"किनारा सिलाई"},{value:"topstitching",label:"Topstitching",nepaliLabel:"टपस्टिचिंग"},{value:"blind_hemming",label:"Blind Hemming",nepaliLabel:"अन्धा हेमिंग"},{value:"overlock_stitching",label:"Overlock Stitching",nepaliLabel:"ओभरलक सिलाई"},{value:"flatlock_stitching",label:"Flatlock Stitching",nepaliLabel:"फ्ल्यालक सिलाई"},{value:"coverstitch",label:"Coverstitch",nepaliLabel:"कभरस्टिच"},{value:"binding",label:"Binding",nepaliLabel:"बाइन्डिंग"},{value:"piping",label:"Piping",nepaliLabel:"पाइपिंग"},{value:"pleating",label:"Pleating",nepaliLabel:"प्लिटिंग"},{value:"gathering",label:"Gathering",nepaliLabel:"ग्याद्रिंग"},{value:"smocking",label:"Smocking",nepaliLabel:"स्मकिंग"},{value:"applique",label:"Applique",nepaliLabel:"एप्लिक"},{value:"embroidery",label:"Embroidery",nepaliLabel:"कसिदाकारी"},{value:"quality_inspection",label:"Quality Inspection",nepaliLabel:"गुणस्तर जाँच"},{value:"pattern_matching",label:"Pattern Matching",nepaliLabel:"नमुना मिलान"},{value:"pressing",label:"Pressing",nepaliLabel:"प्रेसिंग"},{value:"cutting",label:"Cutting",nepaliLabel:"काट्ने"},{value:"marking",label:"Marking",nepaliLabel:"चिन्ह लगाउने"},{value:"packaging",label:"Packaging",nepaliLabel:"प्याकेजिंग"}],ds=({initialData:s,onSubmit:d,onCancel:l,isLoading:t=!1,mode:o})=>{const[m,x]=c.useState(null),[n,j]=c.useState(""),[u,y]=c.useState(!1),[p,k]=c.useState(""),[N,E]=c.useState(null),[V,B]=c.useState(!1),[S,q]=c.useState(null),[T,L]=c.useState(!1),{register:C,handleSubmit:r,watch:i,setValue:g,formState:{errors:h,isValid:A}}=Be({resolver:is(ns(o)),defaultValues:{username:s?.username||"",password:"",name:s?.name||"",employeeId:s?.employeeId||"",email:s?.email||"",phone:s?.phone||"",address:s?.address||"",primaryMachine:s?.primaryMachine||"",machineTypes:s?.machineTypes||[],skillLevel:s?.skillLevel||"beginner",specializations:s?.specializations||[],maxConcurrentWork:s?.maxConcurrentWork||1}}),I=i(),D=i("machineTypes")||[],R=i("specializations")||[];c.useEffect(()=>{s?.avatar&&x({type:s.avatar.type,value:s.avatar.value,backgroundColor:s.avatar.backgroundColor||"#3B82F6",label:s.avatar.type==="emoji"||s.avatar.type==="initials"?s.avatar.value:"Photo"})},[s]);const fe=a=>{const f=a.split(" ").map(v=>v.charAt(0)).join("").toUpperCase().slice(0,2);return{type:"initials",value:f,backgroundColor:ee[Math.floor(Math.random()*ee.length)],label:f}};c.useEffect(()=>{I.name&&!m&&o==="create"&&x(fe(I.name))},[I.name,m,o]),c.useEffect(()=>{(async()=>{if(o==="create"&&!s?.employeeId)try{y(!0);const f=await W.generateUniqueEmployeeIdSuggestion();k(f),g("employeeId",f)}catch(f){console.error("Failed to generate Employee ID:",f);const O=`TSA-EMP-${Date.now().toString().slice(-4)}`;k(O),g("employeeId",O)}finally{y(!1)}})()},[o,s?.employeeId,g]);const je=async()=>{try{y(!0);const a=await W.generateUniqueEmployeeIdSuggestion();k(a),g("employeeId",a)}catch(a){console.error("Failed to regenerate Employee ID:",a);const v=`TSA-EMP-${Date.now().toString().slice(-4)}`;k(v),g("employeeId",v)}finally{y(!1)}},ve=async a=>{if(!a){E(null);return}try{B(!0);const f=W.validateEmployeeIdFormat(a);if(!f.valid){E({isValid:!1,message:f.message,suggestion:'Click "Generate Unique ID" for correct format'});return}if(o==="edit"&&s?.employeeId===a){E({isValid:!0,message:"Current Employee ID"});return}if(!await W.isEmployeeIdUnique(a)){const O=await W.generateUniqueEmployeeIdSuggestion();E({isValid:!1,message:"❌ This Employee ID already exists!",suggestion:`Suggested: ${O}`,suggestedId:O});return}E({isValid:!0,message:"✅ Employee ID is available"})}catch(f){console.error("Failed to validate Employee ID:",f),E({isValid:!1,message:"⚠️ Failed to validate ID - please try again",suggestion:"Check your network connection"})}finally{B(!1)}},ye=a=>{g("employeeId",a),k(a),E({isValid:!0,message:"✅ Using suggested unique ID"})};c.useEffect(()=>{if(o==="edit"&&I.employeeId){const a=setTimeout(()=>{ve(I.employeeId)},500);return()=>clearTimeout(a)}},[I.employeeId,o]),c.useEffect(()=>{o==="create"&&p&&E({isValid:!0,message:"Auto-generated ID"})},[p,o]);const be=a=>{const f=D,v=f.includes(a)?f.filter(O=>O!==a):[...f,a];g("machineTypes",v,{shouldValidate:!0})},ae=()=>{n.trim()&&(g("specializations",[...R,n.trim()]),j(""))},Ne=a=>{g("specializations",R.filter((v,O)=>O!==a))},we=async(a,f)=>{try{if(!A){f?.preventDefault();const $=Object.keys(h);if($.length>0){const X=$[0],te=document.querySelector(`[name="${X}"]`)||document.querySelector(`input[name="${X}"]`)||document.querySelector(`select[name="${X}"]`);te&&te.scrollIntoView({behavior:"smooth",block:"center"});const Se=Object.entries(h).map(([z,Ce])=>`• ${z==="primaryMachine"?"Primary Machine":z==="machineTypes"?"Machine Types":z==="skillLevel"?"Skill Level":z==="maxConcurrentWork"?"Max Concurrent Work":z==="employeeId"?"Employee ID":z.charAt(0).toUpperCase()+z.slice(1)}: ${Ce?.message||"Required"}`).join(`
`);alert(`Please fix the following required fields:

${Se}`);return}}const v={...a,hiredDate:new Date,shift:"morning",specializations:a.specializations?.filter($=>$.trim())||[]};if(a.email&&a.email.trim()&&(v.email=a.email.trim()),a.phone&&a.phone.trim()&&(v.phone=a.phone.trim()),a.address&&a.address.trim()&&(v.address=a.address.trim()),m)v.avatar={type:m.type,value:m.value,backgroundColor:m.backgroundColor||"#3B82F6"};else{const $=(a.name||a.username||"OP").slice(0,2).toUpperCase();v.avatar={type:"initials",value:$,backgroundColor:"#3B82F6"}}o==="create"&&p&&(v.employeeId=p),await d(v)}catch(v){console.error("Form submission error:",v),alert("Failed to create operator. Please check all required fields and try again.")}},ke=()=>{if(!m)return null;switch(m.type){case"emoji":return e.jsx("div",{className:"h-16 w-16 rounded-full bg-gray-100 flex items-center justify-center text-3xl",children:m.value});case"initials":return e.jsx("div",{className:"h-16 w-16 rounded-full flex items-center justify-center text-white font-bold text-xl",style:{backgroundColor:m.backgroundColor},children:m.value});case"photo":return e.jsx("img",{src:m.value,alt:"Avatar",className:"h-16 w-16 rounded-full object-cover"})}};return e.jsxs("form",{onSubmit:r(we),className:"space-y-6",children:[e.jsxs(b,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center space-x-2",children:[e.jsx(ce,{className:"h-5 w-5"}),e.jsx("span",{children:"Basic Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username *"}),e.jsx(M,{...C("username"),placeholder:"Enter username",className:h.username?"border-red-500":""}),h.username&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.username.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),e.jsx(M,{...C("password"),type:"password",placeholder:o==="edit"?"Enter new password (leave blank to keep current)":"Enter password",className:h.password?"border-red-500":""}),h.password&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.password.message}),o==="edit"&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to keep current password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),e.jsx(M,{...C("name"),placeholder:"Enter full name",className:h.name?"border-red-500":""}),h.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.name.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Employee ID *",o==="create"&&e.jsx("span",{className:"ml-2 text-xs text-blue-600",children:"(Auto-generated)"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(M,{...C("employeeId"),placeholder:o==="create"?"Auto-generating...":"Enter employee ID",className:`w-full ${h.employeeId||N?.isValid===!1?"border-red-500":N?.isValid===!0?"border-green-500":""} ${o==="create"?"bg-gray-50":""}`,readOnly:o==="create",value:o==="create"?p:void 0}),V&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(Z,{size:"xs"})}),!V&&N?.isValid===!0&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-green-500",children:"✓"}),!V&&N?.isValid===!1&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-red-500",children:"✗"})]}),o==="create"&&e.jsx(w,{type:"button",variant:"outline",onClick:je,disabled:u,className:"px-3 py-2 min-w-[120px]",children:u?e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Z,{size:"xs"}),e.jsx("span",{children:"Generating..."})]}):"Generate Unique ID"})]}),h.employeeId&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.employeeId.message}),N?.message&&e.jsxs("div",{className:`text-sm mt-1 ${N.isValid?"text-green-600":"text-red-500"}`,children:[e.jsx("p",{children:N.message}),N.suggestion&&e.jsxs("div",{className:"mt-1 flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-600",children:N.suggestion}),N.suggestedId&&e.jsx(w,{type:"button",size:"sm",variant:"outline",onClick:()=>ye(N.suggestedId),className:"text-xs px-2 py-1 h-6",children:"Use This"})]})]}),o==="create"&&p&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["Next ID: ",e.jsx("span",{className:"font-mono font-medium",children:p})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx(M,{...C("email"),type:"email",placeholder:"Enter email address",className:h.email?"border-red-500":""}),h.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx(M,{...C("phone"),placeholder:"Enter phone number"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx(M,{...C("address"),placeholder:"Enter full address"})]})]}),e.jsxs(b,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center space-x-2",children:[e.jsx(He,{className:"h-5 w-5"}),e.jsx("span",{children:"Avatar"})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"Preview"}),ke()||e.jsx("div",{className:"h-16 w-16 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx(ce,{className:"h-8 w-8 text-gray-400"})})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Choose Emoji"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:cs.map((a,f)=>e.jsx("button",{type:"button",onClick:()=>x({type:"emoji",value:a,label:a}),className:`p-2 rounded-lg border text-2xl hover:bg-gray-50 ${m?.type==="emoji"&&m?.value===a?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:a},f))})]}),I.name&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Or Use Initials"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ee.map((a,f)=>{const v=I.name.split(" ").map(O=>O.charAt(0)).join("").toUpperCase().slice(0,2);return e.jsx("button",{type:"button",onClick:()=>x({type:"initials",value:v,backgroundColor:a,label:v}),className:`h-12 w-12 rounded-full flex items-center justify-center text-white font-semibold border-2 ${m?.type==="initials"&&m?.backgroundColor===a?"border-gray-800":"border-transparent"}`,style:{backgroundColor:a},children:v},f)})})]})]})})]})]}),e.jsxs(b,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center space-x-2",children:[e.jsx(H,{className:"h-5 w-5"}),e.jsx("span",{children:"Work Information"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Machine Types * (Select all applicable)"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:J.map(a=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:D.includes(a.machineType),onChange:()=>be(a.machineType),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[a.displayName,e.jsxs("span",{className:"text-gray-500 ml-1",children:["(",a.nepaliName,")"]})]})]},a.machineType))}),h.machineTypes&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.machineTypes.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Primary Machine *"}),e.jsxs("select",{...C("primaryMachine"),className:`w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${h.primaryMachine?"border-red-500":""}`,children:[e.jsx("option",{value:"",children:"Select primary machine"}),J.filter(a=>D.includes(a.machineType)).map(a=>e.jsxs("option",{value:a.machineType,children:[a.displayName," (",a.nepaliName,")"]},a.machineType))]}),h.primaryMachine&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.primaryMachine.message})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Level *"}),e.jsx("select",{...C("skillLevel"),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:he.map(a=>e.jsxs("option",{value:a.value,children:[a.label," (",a.nepaliLabel,")"]},a.value))})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Concurrent Work *"}),e.jsx(M,{...C("maxConcurrentWork",{valueAsNumber:!0}),type:"number",min:"1",max:"10",placeholder:"Maximum concurrent work items",className:h.maxConcurrentWork?"border-red-500":""}),h.maxConcurrentWork&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.maxConcurrentWork.message})]})]})]}),e.jsxs(b,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center space-x-2",children:[e.jsx(Y,{className:"h-5 w-5"}),e.jsx("span",{children:"Specializations"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Available Operations (Select multiple)"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-3",children:os.map(a=>e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"checkbox",checked:R.includes(a.value),onChange:f=>{const v=R,O=f.target.checked?[...v,a.value]:v.filter($=>$!==a.value);g("specializations",O)},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.label}),e.jsx("div",{className:"text-xs text-gray-500",children:a.nepaliLabel})]})]},a.value))})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(M,{value:n,onChange:a=>j(a.target.value),placeholder:"Add custom specialization...",onKeyPress:a=>a.key==="Enter"&&(a.preventDefault(),ae())}),e.jsx(w,{type:"button",onClick:ae,variant:"secondary",disabled:!n.trim(),children:"Add Custom"})]}),R.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:R.map((a,f)=>e.jsxs(P,{variant:"outline",className:"flex items-center space-x-2",children:[e.jsx("span",{children:a}),e.jsx("button",{type:"button",onClick:()=>Ne(f),className:"text-gray-400 hover:text-gray-600",children:"×"})]},f))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[e.jsx(w,{type:"button",variant:"ghost",onClick:l,disabled:t,children:"Cancel"}),e.jsxs(w,{type:"submit",disabled:t,className:"flex items-center space-x-2",children:[t&&e.jsx(Z,{size:"sm"}),e.jsx("span",{children:o==="create"?"Create Operator":"Update Operator"})]})]})]})},As=({userRole:s="supervisor"})=>{const[d,l]=c.useState("overview"),[t,o]=c.useState(""),[m,x]=c.useState(""),[n,j]=c.useState(0),[u,y]=c.useState([]),[p,k]=c.useState(!0),[N,E]=c.useState(null);c.useEffect(()=>{V()},[n]);const V=async()=>{try{k(!0),E(null);const r=await Q.getAllOperators();r.success?y(Ee(r.data)):(E(r.error||"Failed to load operators"),y([]))}catch(r){E("Error loading operators"),y([]),console.error("Error loading operators:",r)}finally{k(!1)}},B=async r=>{if(s!=="supervisor"){alert("You do not have permission to delete operators.");return}if(window.confirm("Are you sure you want to delete this operator? This action cannot be undone."))try{const g=await Q.delete(r);g.success?(alert("✅ Operator deleted successfully!"),j(h=>h+1)):alert(`❌ Failed to delete operator: ${g.error}`),t===r&&(o(""),l("overview"))}catch(g){console.error("Error deleting operator:",g),alert("Failed to delete operator. Please try again.")}},S=u.filter(r=>r!=null).map(r=>({id:r.id||"",name:r.name||"Unknown",employeeId:r.employeeId||"N/A",skills:r.machineTypes||[],efficiency:typeof r.averageEfficiency=="number"?r.averageEfficiency:0,qualityScore:typeof r.qualityScore=="number"?r.qualityScore:85,activeAssignments:r.currentAssignments?.length||0,completedToday:Math.floor(Math.random()*5),status:r.isActive?r.availabilityStatus==="available"?"Active":r.availabilityStatus==="working"?"Working":r.availabilityStatus==="break"?"On Break":"Available":"Offline",avatar:r.avatar?r.avatar:null,joinDate:r.createdAt?.toDate?r.createdAt.toDate():new Date,machineType:r.primaryMachine||"Not Set"})),q=S.slice(0,5),T={totalOperators:u.length,activeOperators:S.filter(r=>["Active","Working","Available"].includes(r.status)).length,onBreakOperators:S.filter(r=>r.status==="On Break").length,offlineOperators:S.filter(r=>r.status==="Offline").length,averageEfficiency:u.length>0?Math.round(S.reduce((r,i)=>r+i.efficiency,0)/u.length):0,averageQuality:u.length>0?Math.round(S.reduce((r,i)=>r+i.qualityScore,0)/u.length):0,topPerformer:S.length>0?S.reduce((r,i)=>i.efficiency>r.efficiency?i:r,S[0]).name:"N/A",completedToday:S.reduce((r,i)=>r+i.completedToday,0),attendanceRate:Math.round((S.length-S.filter(r=>r.status==="Offline").length)/Math.max(S.length,1)*100)},L=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(U,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Operators"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:T.totalOperators})]})]})}),e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(G,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Now"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:T.activeOperators})]})]})}),e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:e.jsx(Y,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Avg Efficiency"}),e.jsxs("p",{className:"text-2xl font-bold text-yellow-600",children:[T.averageEfficiency,"%"]})]})]})}),e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(Y,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Top Performer"}),e.jsx("p",{className:"text-lg font-bold text-purple-600",children:T.topPerformer})]})]})})]}),e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Operator Management"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(se,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(M,{placeholder:"Search operators...",value:m,onChange:r=>x(r.target.value),className:"pl-10 w-64"})]}),e.jsxs(w,{onClick:()=>l("form"),className:"flex items-center space-x-2",children:[e.jsx(me,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Operator"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[q.filter(r=>r.name.toLowerCase().includes(m.toLowerCase())||r.employeeId.toLowerCase().includes(m.toLowerCase())||r.skills.some(i=>i.toLowerCase().includes(m.toLowerCase()))).map(r=>e.jsx(ge,{operator:r,onView:()=>{o(r.id),l("detail")},onEdit:()=>{o(r.id),l("form")},showActions:s==="supervisor"},r.id)),q.filter(r=>{if(!m)return!1;const i=m.toLowerCase();return!((r.name||"").toLowerCase().includes(i)||(r.employeeId||"").toLowerCase().includes(i)||(r.skills||[]).some(g=>(g||"").toLowerCase().includes(i)))}).length===q.length&&m&&q.length>0&&e.jsxs("div",{className:"col-span-full text-center py-8 text-gray-500",children:[e.jsx(se,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsxs("p",{children:['No operators found matching "',m,'"']})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(b,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Operator Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Active"})]}),e.jsx("span",{className:"text-sm font-medium",children:T.activeOperators})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"On Break"})]}),e.jsx("span",{className:"text-sm font-medium",children:T.onBreakOperators})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-gray-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Offline"})]}),e.jsx("span",{className:"text-sm font-medium",children:T.offlineOperators})]})]})]}),e.jsxs(b,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Skills"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Sewing"}),e.jsx(P,{variant:"secondary",children:"45 operators"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Cutting"}),e.jsx(P,{variant:"secondary",children:"32 operators"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Finishing"}),e.jsx(P,{variant:"secondary",children:"28 operators"})]})]})]}),e.jsxs(b,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance Metrics"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Avg Completion Rate"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:"92.4%"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Quality Score"}),e.jsx("span",{className:"text-sm font-medium text-blue-600",children:"89.7%"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Attendance Rate"}),e.jsx("span",{className:"text-sm font-medium text-purple-600",children:"96.1%"})]})]})]})]})]}),C=()=>{switch(d){case"overview":return L();case"list":return e.jsx(as,{onViewOperator:i=>{o(i),l("detail")},onEditOperator:s==="supervisor"?i=>{o(i),l("form")}:void 0,onDeleteOperator:s==="supervisor"?B:void 0,onCreateNew:s==="supervisor"?()=>{o(""),l("form")}:void 0,userRole:s,showActions:!0},n);case"detail":return t?e.jsx(ts,{operatorId:t,onEdit:()=>l("form"),onBack:()=>l("overview")}):L();case"form":const r=t?u.find(i=>i.id===t):void 0;return e.jsx(ds,{mode:t?"edit":"create",initialData:r,onSubmit:async i=>{console.log("Operator data submitted:",i);try{const{operatorService:g}=await Ie(async()=>{const{operatorService:h}=await import("./index.CLAiwwTT.js").then(A=>A.P);return{operatorService:h}},__vite__mapDeps([0,1,2,3,4,5,6]));if(t){const h=await g.updateOperator(t,i);h.success?(alert("✅ Operator updated successfully!"),j(A=>A+1),l("overview"),o("")):alert(`❌ Failed to update operator: ${h.error}`)}else{const h=await g.createOperator(i);h.success?(alert("✅ Operator created successfully!"),j(A=>A+1),l("overview"),o("")):alert(`❌ Failed to create operator: ${h.error}`)}}catch(g){console.error("Error saving operator:",g),alert("❌ An unexpected error occurred. Please try again.")}},onCancel:()=>{l("overview"),o("")},isLoading:!1});default:return L()}};return p?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(U,{className:"h-8 w-8 text-blue-600"}),e.jsx("span",{children:"Operator Management"})]}),e.jsx("p",{className:"text-gray-600",children:"Loading operators..."})]})}),e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-600 border-t-transparent"})})]}):N?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(U,{className:"h-8 w-8 text-blue-600"}),e.jsx("span",{children:"Operator Management"})]}),e.jsxs("p",{className:"text-red-600",children:["Error: ",N]})]})}),e.jsxs(b,{className:"p-6 text-center",children:[e.jsx("p",{className:"text-red-600 mb-4",children:N}),e.jsx(w,{onClick:V,children:"Retry"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(U,{className:"h-8 w-8 text-blue-600"}),e.jsx("span",{children:"Operator Management"})]}),e.jsxs("p",{className:"text-gray-600",children:["Manage operators, skills, and performance (",u.length," total)"]})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsx("button",{onClick:()=>l("overview"),className:`py-2 px-1 border-b-2 font-medium text-sm ${d==="overview"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Overview"}),e.jsx("button",{onClick:()=>l("list"),className:`py-2 px-1 border-b-2 font-medium text-sm ${d==="list"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"All Operators"}),t&&e.jsx("button",{onClick:()=>l("detail"),className:`py-2 px-1 border-b-2 font-medium text-sm ${d==="detail"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Operator Details"}),s==="supervisor"&&e.jsx("button",{onClick:()=>l("form"),className:`py-2 px-1 border-b-2 font-medium text-sm ${d==="form"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:t?"Edit Operator":"Add Operator"})]})}),C()]})};export{As as OperatorManagementDashboard,As as default};
